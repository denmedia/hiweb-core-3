var hw_input_file={init:function(){jQuery("body").on("click",'.hiweb-field-file [data-click="select"], .hiweb-field-image [data-click="select"]',function(b){var a=jQuery(b.currentTarget).closest("[data-file-mime]");hw_input_file.event_click_select(a)});jQuery("body").on("click",'.hiweb-field-file [data-click="edit"], .hiweb-field-image [data-click="edit"]',function(b){b.preventDefault();var a=jQuery(b.currentTarget).closest("[data-file-mime]");hw_input_file.edit_file(a)});jQuery("body").on("click",'.hiweb-field-file [data-click="deselect"], .hiweb-field-image [data-click="deselect"]',function(b){b.preventDefault();var a=jQuery(b.currentTarget).closest("[data-file-mime]");hw_input_file.deselect_file(a)});jQuery("body").on("change",".hiweb-field-file input[name]",function(){})},event_click_select:function(c){var b={title:"Выбор файла",multiple:false,button:{text:"Выбрать файл"}};if(c.is(".hiweb-field-image")){b.library={type:"image"}}var a=wp.media(b);a.on("select",function(){hw_input_file.select_file(c,a.state().get("selection").first().toJSON())});a.open()},select_file:function(d,c){var a=d.find("input");var b=c.id;a.val(b);d.find("[data-file-name]").html(c.filename);d.attr("data-has-file","1");d.attr("data-file-mime",c.mime);d.attr("data-file-image",c.mime.indexOf("image")===0?"image":"file");if(c.mime.indexOf("image")===0){d.find(".thumbnail").css("background-image","url("+c.url+")")}},edit_file:function(d){var a=d.find("input");var c={title:"Обновление файла",multiple:false,button:{text:"Обновить файл"}};if(d.is(".hiweb-field-image")){c.library={type:"image"}}var b=wp.media(c);b.on("open",function(){var e=b.state().get("selection");ids=[a.val()];ids.forEach(function(f){attachment=wp.media.attachment(f);attachment.fetch();e.add(attachment?[attachment]:[])})});b.on("select",function(){hw_input_file.select_file(d,b.state().get("selection").first().toJSON())});b.open()},deselect_file:function(c){var a=c.find("input").val("");var b=c.find(".thumbnail");b.css("background-file","none");c.attr("data-has-file","0");c.attr("data-file-mime","");c.attr("data-file-image","");c.find("[data-file-name]").html("")}};jQuery(document).ready(hw_input_file.init);