(function(n,k){function j(){for(var a=1;a<arguments.length;a++){for(var b in arguments[a]){if(arguments[a].hasOwnProperty(b)){arguments[0][b]=arguments[a][b]}}}return arguments[0]}var m="tinycolorpicker",l={backgroundUrl:null};function h(E,C){this.options=j({},l,C);this._defaults=l;this._name=m;var D=this,A=E.querySelectorAll(".track")[0],y=E.querySelectorAll(".color")[0],F=E.querySelectorAll(".colorInner")[0],a=null,c=E.querySelectorAll(".colorInput")[0],B=null,f=false,z=!!document.createElement("canvas").getContext,d="ontouchstart" in document.documentElement,H=document.createEvent("HTMLEvents");H.initEvent("change",true,true);this.colorHex="";this.colorRGB="";function g(){if(z){a=document.createElement("canvas");A.appendChild(a);B=a.getContext("2d");G()}b();return D}function G(){var q=new Image(),p=A.currentStyle||n.getComputedStyle(A,false),o=p.backgroundImage.replace(/"/g,"").replace(/url\(|\)$/ig,"");q.crossOrigin="Anonymous";A.style.backgroundImage="none";q.onload=function(){a.width=this.width;a.height=this.height;B.drawImage(q,0,0,this.width,this.height)};q.src=D.options.backgroundUrl||o}function b(){var o=d?"touchstart":"mousedown";if(z){y["on"+o]=function(p){p.preventDefault();p.stopPropagation();A.style.display="block";document.onmousedown=function(q){document.onmousedown=null;D.close()}};if(!d){a.onmousedown=function(p){p.preventDefault();p.stopPropagation();f=true;e(p);document.onmouseup=function(q){document.onmouseup=null;D.close();return false}};a.onmousemove=e}else{a.ontouchstart=function(p){f=true;e(p.touches[0]);return false};a.ontouchmove=function(p){e(p.touches[0]);return false};a.ontouchend=function(p){D.close();return false}}}}function e(p){if(f){var o=p.target.getBoundingClientRect(),q=B.getImageData(p.clientX-o.left,p.clientY-o.top,1,1).data;D.setColor("rgb("+q[0]+","+q[1]+","+q[2]+")");E.dispatchEvent(H,[D.colorHex,D.colorRGB])}}this.setColor=function(o){if(o.indexOf("#")>=0){D.colorHex=o;D.colorRGB=D.hexToRgb(D.colorHex)}else{D.colorRGB=o;D.colorHex=D.rgbToHex(D.colorRGB)}F.style.backgroundColor=D.colorHex;c.value=D.colorHex};this.close=function(){f=false;A.style.display="none"};this.hexToRgb=function(o){var p=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return"rgb("+parseInt(p[1],16)+","+parseInt(p[2],16)+","+parseInt(p[3],16)+")"};this.rgbToHex=function(p){var q=p.match(/\d+/g);function o(s){var r=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");return isNaN(s)?"00":r[(s-s%16)/16]+r[s%16]}return"#"+o(q[0])+o(q[1])+o(q[2])};return g()}var i=function(a,b){return new h(a,b)};if(typeof define=="function"&&define.amd){define(function(){return i})}else{if(typeof module==="object"&&module.exports){module.exports=i}else{n.tinycolorpicker=i}}})(window);