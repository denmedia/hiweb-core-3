!function(){var l1,mk,lR,lW,l0,l9,lQ=tinymce.util.Tools.resolve("tinymce.PluginManager"),mx=function(a){return function(){return a}},mq=mx(!1),l5=mx(!0),lM={noop:function(){for(var b=[],a=0;a<arguments.length;a++){b[a]=arguments[a]}},noarg:function(a){return function(){for(var c=[],b=0;b<arguments.length;b++){c[b]=arguments[b]}return a()}},compose:function(a,b){return function(){for(var d=[],c=0;c<arguments.length;c++){d[c]=arguments[c]}return a(b.apply(null,arguments))}},constant:mx,identity:function(a){return a},tripleEquals:function(b,a){return b===a},curry:function(c){for(var f=[],d=1;d<arguments.length;d++){f[d-1]=arguments[d]}for(var a=new Array(arguments.length-1),b=1;b<arguments.length;b++){a[b-1]=arguments[b]}return function(){for(var k=[],i=0;i<arguments.length;i++){k[i]=arguments[i]}for(var g=new Array(arguments.length),h=0;h<g.length;h++){g[h]=arguments[h]}var j=a.concat(g);return c.apply(null,j)}},not:function(a){return function(){for(var c=[],b=0;b<arguments.length;b++){c[b]=arguments[b]}return !a.apply(null,arguments)}},die:function(a){return function(){throw new Error(a)}},apply:function(a){return a()},call:function(a){a()},never:mq,always:l5},lT=lM.never,mh=lM.always,mm=function(){return l3},l3=(lW={fold:function(b,a){return b()},is:lT,isSome:lT,isNone:mh,getOr:lR=function(a){return a},getOrThunk:mk=function(a){return a()},getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},or:lR,orThunk:mk,map:mm,ap:mm,each:function(){},bind:mm,flatten:mm,exists:lT,forall:mh,filter:mm,equals:l1=function(a){return a.isNone()},equals_:l1,toArray:function(){return[]},toString:lM.constant("none()")},Object.freeze&&Object.freeze(lW),lW),mg=function(a){var f=function(){return a},c=function(){return d},b=function(e){return e(a)},d={fold:function(h,g){return g(a)},is:function(e){return a===e},isSome:mh,isNone:lT,getOr:f,getOrThunk:f,getOrDie:f,or:c,orThunk:c,map:function(e){return mg(e(a))},ap:function(e){return e.fold(mm,function(g){return mg(g(a))})},each:function(e){e(a)},bind:b,flatten:f,exists:b,forall:b,filter:function(e){return e(a)?d:l3},equals:function(e){return e.is(a)},equals_:function(h,g){return h.fold(lT,function(e){return g(a,e)})},toArray:function(){return[a]},toString:function(){return"some("+a+")"}};return d},lN={some:mg,none:mm,from:function(a){return null===a||a===undefined?l3:mg(a)}},mb=function(a){return function(b){return function(d){if(null===d){return"null"}var c=typeof d;return"object"===c&&Array.prototype.isPrototypeOf(d)?"array":"object"===c&&String.prototype.isPrototypeOf(d)?"string":c}(b)===a}},lZ={isString:mb("string"),isObject:mb("object"),isArray:mb("array"),isNull:mb("null"),isBoolean:mb("boolean"),isUndefined:mb("undefined"),isFunction:mb("function"),isNumber:mb("number")},lP=(l0=Array.prototype.indexOf)===undefined?function(b,a){return m6(b,a)}:function(b,a){return l0.call(b,a)},mv=function(b,a){return -1<lP(b,a)},lO=function(g,d){for(var b=g.length,c=new Array(b),f=0;f<b;f++){var a=g[f];c[f]=d(a,f,g)}return c},m7=function(d,c){for(var a=0,b=d.length;a<b;a++){c(d[a],a,d)}},mL=function(c,b){for(var a=c.length-1;0<=a;a--){b(c[a],a,c)}},mK=function(g,d){for(var b=[],c=0,f=g.length;c<f;c++){var a=g[c];d(a,c,g)&&b.push(a)}return b},mH=function(d,c){for(var a=0,b=d.length;a<b;a++){if(c(d[a],a,d)){return lN.some(a)}}return lN.none()},m6=function(d,c){for(var a=0,b=d.length;a<b;++a){if(d[a]===c){return a}}return -1},l6=Array.prototype.push,nb=function(d){for(var c=[],a=0,b=d.length;a<b;++a){if(!Array.prototype.isPrototypeOf(d[a])){throw new Error("Arr.flatten item "+a+" was not an array, input: "+d)}l6.apply(c,d[a])}return c},mP=function(d,c){for(var a=0,b=d.length;a<b;++a){if(!0!==c(d[a],a,d)){return !1}}return !0},mR=Array.prototype.slice,m4=lZ.isFunction(Array.from)?Array.from:function(a){return mR.call(a)},mO={map:lO,each:m7,eachr:mL,partition:function(h,f){for(var c=[],d=[],g=0,b=h.length;g<b;g++){var a=h[g];(f(a,g,h)?c:d).push(a)}return{pass:c,fail:d}},filter:mK,groupBy:function(f,h){if(0===f.length){return[]}for(var m=h(f[0]),b=[],d=[],g=0,l=f.length;g<l;g++){var k=f[g],j=h(k);j!==m&&(b.push(d),d=[]),m=j,d.push(k)}return 0!==d.length&&b.push(d),b},indexOf:function(c,b){var a=lP(c,b);return -1===a?lN.none():lN.some(a)},foldr:function(c,b,a){return mL(c,function(d){a=b(a,d)}),a},foldl:function(c,b,a){return m7(c,function(d){a=b(a,d)}),a},find:function(f,c){for(var a=0,b=f.length;a<b;a++){var d=f[a];if(c(d,a,f)){return lN.some(d)}}return lN.none()},findIndex:mH,flatten:nb,bind:function(c,b){var a=lO(c,b);return nb(a)},forall:mP,exists:function(b,a){return mH(b,a).isSome()},contains:mv,equal:function(b,a){return b.length===a.length&&mP(b,function(d,c){return d===a[c]})},reverse:function(b){var a=mR.call(b,0);return a.reverse(),a},chunk:function(f,c){for(var a=[],b=0;b<f.length;b+=c){var d=f.slice(b,b+c);a.push(d)}return a},difference:function(b,a){return mK(b,function(c){return !mv(a,c)})},mapToObject:function(g,d){for(var b={},c=0,f=g.length;c<f;c++){var a=g[c];b[String(a)]=d(a,c)}return b},pure:function(a){return[a]},sort:function(c,b){var a=mR.call(c,0);return a.sort(b),a},range:function(d,c){for(var a=[],b=0;b<d;b++){a.push(c(b))}return a},head:function(a){return 0===a.length?lN.none():lN.some(a[0])},last:function(a){return 0===a.length?lN.none():lN.some(a[a.length-1])},from:m4},m9=(l9=Object.keys)===undefined?function(c){var b=[];for(var a in c){c.hasOwnProperty(a)&&b.push(a)}return b}:l9,mY=function(g,d){for(var b=m9(g),c=0,f=b.length;c<f;c++){var a=b[c];d(g[a],a,g)}},mD=function(b,c){var a={};return mY(b,function(g,f){var d=c(g,f,b);a[d.k]=d.v}),a},mT=function(c,a){var b=[];return mY(c,function(f,d){b.push(a(f,d))}),b},mU=function(a){return mT(a,function(b){return b})},lX={bifilter:function(d,a){var b={},c={};return mY(d,function(g,f){(a(g,f)?b:c)[f]=g}),{t:b,f:c}},each:mY,map:function(b,a){return mD(b,function(f,d,c){return{k:d,v:a(f,d,c)}})},mapToArray:mT,tupleMap:mD,find:function(h,f){for(var c=m9(h),d=0,g=c.length;d<g;d++){var b=c[d],a=h[b];if(f(a,b,h)){return lN.some(a)}}return lN.none()},keys:m9,values:mU,size:function(a){return mU(a).length}},l8=function(a){return a.slice(0).sort()},mz=function(b,a){throw new Error("All required keys ("+l8(b).join(", ")+") were not specified. Specified keys were: "+l8(a).join(", ")+".")},lL=function(a){throw new Error("Unsupported keys for object: "+l8(a).join(", "))},m0=function(a,b){if(!lZ.isArray(b)){throw new Error("The "+a+" fields must be an array. Was: "+b+".")}mO.each(b,function(c){if(!lZ.isString(c)){throw new Error("The value "+c+" in the "+a+" fields was not a string.")}})},m3=function(b,a){throw new Error("All values need to be of type: "+a+". Keys ("+l8(b).join(", ")+") were not.")},mF=function(b){var a=l8(b);mO.find(a,function(d,c){return c<a.length-1&&d===a[c+1]}).each(function(c){throw new Error("The field: "+c+" occurs more than once in the combined fields: ["+a.join(", ")+"].")})},mE={immutable:function(){for(var a=[],b=0;b<arguments.length;b++){a[b]=arguments[b]}return function(){for(var c=[],e=0;e<arguments.length;e++){c[e]=arguments[e]}if(a.length!==c.length){throw new Error('Wrong number of arguments to struct. Expected "['+a.length+']", got '+c.length+" arguments")}var d={};return mO.each(a,function(g,f){d[g]=lM.constant(c[f])}),d}},immutableBag:function(c,b){var a=c.concat(b);if(0===a.length){throw new Error("You must specify at least one required or optional field.")}return m0("required",c),m0("optional",b),mF(a),function(g){var d=lX.keys(g);mO.forall(c,function(e){return mO.contains(d,e)})||mz(c,d);var h=mO.filter(d,function(e){return !mO.contains(a,e)});0<h.length&&lL(h);var f={};return mO.each(c,function(e){f[e]=lM.constant(g[e])}),mO.each(b,function(e){f[e]=lM.constant(Object.prototype.hasOwnProperty.call(g,e)?lN.some(g[e]):lN.none())}),f}}},m1=mE.immutable("width","height"),mC=mE.immutable("rows","columns"),mB=mE.immutable("row","column"),mW=mE.immutable("x","y"),ny=mE.immutable("element","rowspan","colspan"),mX=mE.immutable("element","rowspan","colspan","isNew"),mN={dimensions:m1,grid:mC,address:mB,coords:mW,extended:mE.immutable("element","rowspan","colspan","row","column"),detail:ny,detailnew:mX,rowdata:mE.immutable("element","cells","section"),elementnew:mE.immutable("element","isNew"),rowdatanew:mE.immutable("element","cells","section","isNew"),rowcells:mE.immutable("cells","section"),rowdetails:mE.immutable("details","section"),bounds:mE.immutable("startRow","startCol","finishRow","finishCol")},mA=function(a){if(null===a||a===undefined){throw new Error("Node cannot be null or undefined")}return{dom:lM.constant(a)}},jj={fromHtml:function(c,b){var a=(b||document).createElement("div");if(a.innerHTML=c,!a.hasChildNodes()||1<a.childNodes.length){throw console.error("HTML does not have a single root node",c),"HTML must have a single root node"}return mA(a.childNodes[0])},fromTag:function(c,b){var a=(b||document).createElement(c);return mA(a)},fromText:function(c,b){var a=(b||document).createTextNode(c);return mA(a)},fromDom:mA,fromPoint:function(c,b,a){return lN.from(c.dom().elementFromPoint(b,a)).map(mA)}},lp=8,hy=9,iq=1,i3=3,gZ=iq,np=hy,l4=function(a){return a.nodeType!==gZ&&a.nodeType!==np||0===a.childElementCount},jO={all:function(c,b){var a=b===undefined?document:b.dom();return l4(a)?[]:mO.map(a.querySelectorAll(c),jj.fromDom)},is:function(c,b){var a=c.dom();if(a.nodeType!==gZ){return !1}if(a.matches!==undefined){return a.matches(b)}if(a.msMatchesSelector!==undefined){return a.msMatchesSelector(b)}if(a.webkitMatchesSelector!==undefined){return a.webkitMatchesSelector(b)}if(a.mozMatchesSelector!==undefined){return a.mozMatchesSelector(b)}throw new Error("Browser lacks native selectors")},one:function(c,b){var a=b===undefined?document:b.dom();return l4(a)?lN.none():lN.from(a.querySelector(c)).map(jj.fromDom)}},hV=function(f,c){for(var a=[],b=function(e){return a.push(e),c(e)},d=c(f);(d=d.bind(b)).isSome();){}return a},k5="undefined"!=typeof window?window:Function("return this;")(),lE=function(d,c){for(var a=c!==undefined&&null!==c?c:k5,b=0;b<d.length&&a!==undefined&&null!==a;++b){a=a[d[b]]}return a},jC=function(c,b){var a=c.split(".");return lE(a,b)},kT=function(c,b){var a=jC(c,b);if(a===undefined||null===a){throw c+" not available on this browser"}return a},kH=function(){return kT("Node")},iR=function(c,b,a){return 0!=(c.compareDocumentPosition(b)&a)},gC=function(b,a){return iR(b,a,kH().DOCUMENT_POSITION_CONTAINED_BY)},mS=function(c){var b,a=!1;return function(){return a||(a=!0,b=c.apply(null,arguments)),b}},f3=function(d,c){var a=function(i,h){for(var f=0;f<i.length;f++){var g=i[f];if(g.test(h)){return g}}return undefined}(d,c);if(!a){return{major:0,minor:0}}var b=function(e){return Number(c.replace(a,"$"+e))};return fG(b(1),b(2))},e7=function(){return fG(0,0)},fG=function(b,a){return{major:b,minor:a}},hd={nu:fG,detect:function(c,b){var a=String(b).toLowerCase();return 0===c.length?e7():f3(c,a)},unknown:e7},cB="Firefox",cj=function(b,a){return function(){return a===b}},b3=function(b){var a=b.current;return{current:a,version:b.version,isEdge:cj("Edge",a),isChrome:cj("Chrome",a),isIE:cj("IE",a),isOpera:cj("Opera",a),isFirefox:cj(cB,a),isSafari:cj("Safari",a)}},gO={unknown:function(){return b3({current:undefined,version:hd.unknown()})},nu:b3,edge:lM.constant("Edge"),chrome:lM.constant("Chrome"),ie:lM.constant("IE"),opera:lM.constant("Opera"),firefox:lM.constant(cB),safari:lM.constant("Safari")},j0="Windows",h7="Android",c8="Solaris",dv="FreeBSD",gk=function(b,a){return function(){return a===b}},cX=function(b){var a=b.current;return{current:a,version:b.version,isWindows:gk(j0,a),isiOS:gk("iOS",a),isAndroid:gk(h7,a),isOSX:gk("OSX",a),isLinux:gk("Linux",a),isSolaris:gk(c8,a),isFreeBSD:gk(dv,a)}},hK={unknown:function(){return cX({current:undefined,version:hd.unknown()})},nu:cX,windows:lM.constant(j0),ios:lM.constant("iOS"),android:lM.constant(h7),linux:lM.constant("Linux"),osx:lM.constant("OSX"),solaris:lM.constant(c8),freebsd:lM.constant(dv)},eA=function(c,b){var a=String(b).toLowerCase();return mO.find(c,function(d){return d.search(a)})},a9=function(b,a){return eA(b,a).map(function(d){var c=hd.detect(d.versionRegexes,a);return{current:d.name,version:c}})},dG=function(b,a){return eA(b,a).map(function(d){var c=hd.detect(d.versionRegexes,a);return{current:d.name,version:c}})},dR=function(b,a){return a+b},iG=function(b,a){return b+a},kd=function(b,a){return b.substring(a)},ak=function(b,a){return b.substring(0,b.length-a)},eL=function(a){return""===a?lN.none():lN.some(a.substr(0,1))},eW=function(a){return""===a?lN.none():lN.some(a.substring(1))},fS=function(c,b,a){return""===b||!(c.length<b.length)&&c.substr(a,a+b.length)===b},bS=function(b,a){return fS(b,a,0)},bw=function(b,a){return fS(b,a,b.length-a.length)},fv={supplant:function(b,a){return b.replace(/\${([^{}]*)}/g,function(g,f){var c,d=a[f];return"string"==(c=typeof d)||"number"===c?d:g})},startsWith:bS,removeLeading:function(b,a){return bS(b,a)?kd(b,a.length):b},removeTrailing:function(b,a){return bw(b,a)?ak(b,a.length):b},ensureLeading:function(b,a){return bS(b,a)?b:dR(b,a)},ensureTrailing:function(b,a){return bw(b,a)?b:iG(b,a)},endsWith:bw,contains:function(b,a){return -1!==b.indexOf(a)},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},lTrim:function(a){return a.replace(/^\s+/g,"")},rTrim:function(a){return a.replace(/\s+$/g,"")},capitalize:function(a){return eL(a).bind(function(b){return eW(a).map(function(c){return b.toUpperCase()+c})}).getOr(a)}},aY=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,aN=function(a){return function(b){return fv.contains(b,a)}},d2=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return fv.contains(a,"edge/")&&fv.contains(a,"chrome")&&fv.contains(a,"safari")&&fv.contains(a,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,aY],search:function(a){return fv.contains(a,"chrome")&&!fv.contains(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){return fv.contains(a,"msie")||fv.contains(a,"trident")}},{name:"Opera",versionRegexes:[aY,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:aN("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:aN("firefox")},{name:"Safari",versionRegexes:[aY,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(fv.contains(a,"safari")||fv.contains(a,"mobile/"))&&fv.contains(a,"applewebkit")}}],bH=[{name:"Windows",search:aN("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return fv.contains(a,"iphone")||fv.contains(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:aN("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:aN("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:aN("linux"),versionRegexes:[]},{name:"Solaris",search:aN("sunos"),versionRegexes:[]},{name:"FreeBSD",search:aN("freebsd"),versionRegexes:[]}],eh={browsers:lM.constant(d2),oses:lM.constant(bH)},cM=function(k){var z,E,b,j,v,D,C,B,q,F,y,A=eh.browsers(),p=eh.oses(),x=a9(A,k).fold(gO.unknown,gO.nu),w=dG(p,k).fold(hK.unknown,hK.nu);return{browser:x,os:w,deviceType:(E=x,b=k,j=(z=w).isiOS()&&!0===/ipad/i.test(b),v=z.isiOS()&&!j,D=z.isAndroid()&&3===z.version.major,C=z.isAndroid()&&4===z.version.major,B=j||D||C&&!0===/mobile/i.test(b),q=z.isiOS()||z.isAndroid(),F=q&&!B,y=E.isSafari()&&z.isiOS()&&!1===/safari/i.test(b),{isiPad:lM.constant(j),isiPhone:lM.constant(v),isTablet:lM.constant(B),isPhone:lM.constant(F),isTouch:lM.constant(q),isAndroid:z.isAndroid,isiOS:z.isiOS,isWebView:lM.constant(y)})}},aC={detect:mS(function(){var a=navigator.userAgent;return cM(a)})},jq=function(b,a){return b.dom()===a.dom()},lx=aC.detect().browser.isIE()?function(b,a){return gC(b.dom(),a.dom())}:function(d,c){var a=d.dom(),b=c.dom();return a!==b&&a.contains(b)},hE={eq:jq,isEqualNode:function(b,a){return b.dom().isEqualNode(a.dom())},member:function(b,a){return mO.exists(a,lM.curry(jq,b))},contains:lx,is:jO.is},iy=function(a){return jj.fromDom(a.dom().ownerDocument)},i7=function(b){var a=b.dom();return lN.from(a.parentNode).map(jj.fromDom)},kz=function(b){var a=b.dom();return lN.from(a.previousSibling).map(jj.fromDom)},g5=function(b){var a=b.dom();return lN.from(a.nextSibling).map(jj.fromDom)},nx=function(b){var a=b.dom();return mO.map(a.childNodes,jj.fromDom)},mp=function(c,b){var a=c.dom().childNodes;return lN.from(a[b]).map(jj.fromDom)},jS=mE.immutable("element","offset"),h1={owner:iy,defaultView:function(b){var a=b.dom().ownerDocument.defaultView;return jj.fromDom(a)},documentElement:function(b){var a=iy(b);return jj.fromDom(a.dom().documentElement)},parent:i7,findIndex:function(a){return i7(a).bind(function(c){var b=nx(c);return mO.findIndex(b,function(d){return hE.eq(a,d)})})},parents:function(h,f){for(var c=lZ.isFunction(f)?f:lM.constant(!1),d=h.dom(),g=[];null!==d.parentNode&&d.parentNode!==undefined;){var b=d.parentNode,a=jj.fromDom(b);if(g.push(a),!0===c(a)){break}d=b}return g},siblings:function(a){return i7(a).map(nx).map(function(b){return mO.filter(b,function(c){return !hE.eq(a,c)})}).getOr([])},prevSibling:kz,offsetParent:function(b){var a=b.dom();return lN.from(a.offsetParent).map(jj.fromDom)},prevSiblings:function(a){return mO.reverse(hV(a,kz))},nextSibling:g5,nextSiblings:function(a){return hV(a,g5)},children:nx,child:mp,firstChild:function(a){return mp(a,0)},lastChild:function(a){return mp(a,a.dom().childNodes.length-1)},childNodesCount:function(a){return a.dom().childNodes.length},hasChildNodes:function(a){return a.dom().hasChildNodes()},leaf:function(c,b){var a=nx(c);return 0<a.length&&b<a.length?jS(a[b],0):jS(c,b)}},k9=function(c,b,a){return mO.bind(h1.children(c),function(d){return jO.is(d,b)?a(d)?[d]:[]:k9(d,b,a)})},lI={firstLayer:function(b,a){return k9(b,a,lM.constant(!0))},filterFirstLayer:k9},jG=function(a){return a.dom().nodeName.toLowerCase()},kX=function(a){return a.dom().nodeType},kL=function(a){return function(b){return kX(b)===a}},iV=kL(iq),gI=kL(i3),m5=kL(hy),f9={name:jG,type:kX,value:function(a){return a.dom().nodeValue},isElement:iV,isText:gI,isDocument:m5,isComment:function(a){return kX(a)===lp||"#comment"===jG(a)}},fh=function(c,b,a){if(!(lZ.isString(a)||lZ.isBoolean(a)||lZ.isNumber(a))){throw console.error("Invalid call to Attr.set. Key ",b,":: Value ",a,":: Element ",c),new Error("Attribute value was not simple")}c.setAttribute(b,a+"")},fM=function(c,b,a){fh(c.dom(),b,a)},hj=function(c,b){var a=c.dom().getAttribute(b);return null===a?undefined:a},cE=function(c,b){var a=c.dom();return !(!a||!a.hasAttribute)&&a.hasAttribute(b)},cp={clone:function(a){return mO.foldl(a.dom().attributes,function(c,b){return c[b.name]=b.value,c},{})},set:fM,setAll:function(c,b){var a=c.dom();lX.each(b,function(f,d){fh(a,d,f)})},get:hj,has:cE,remove:function(b,a){b.dom().removeAttribute(a)},hasNone:function(b){var a=b.dom().attributes;return a===undefined||null===a||0===a.length},transfer:function(b,a,c){f9.isElement(b)&&f9.isElement(a)&&mO.each(c,function(h){var g,d,f;d=a,cE(g=b,f=h)&&!cE(d,f)&&fM(d,f,hj(g,f))})}},b6=mS(function(){return gR(jj.fromDom(document))}),gR=function(b){var a=b.dom().body;if(null===a||a===undefined){throw"Body is not available yet"}return jj.fromDom(a)},j3={body:b6,getBody:gR,inBody:function(b){var a=f9.isText(b)?b.dom().parentNode:b.dom();return a!==undefined&&null!==a&&a.ownerDocument.body.contains(a)}},ib=function(c,b){var a=[];return mO.each(h1.children(c),function(d){b(d)&&(a=a.concat([d])),a=a.concat(ib(d,b))}),a},dd={all:function(a){return ib(j3.body(),a)},ancestors:function(c,b,a){return mO.filter(h1.parents(c,a),b)},siblings:function(b,a){return mO.filter(h1.siblings(b),a)},children:function(b,a){return mO.filter(h1.children(b),a)},descendants:ib},dy={all:function(a){return jO.all(a)},ancestors:function(c,b,a){return dd.ancestors(c,function(d){return jO.is(d,b)},a)},siblings:function(b,a){return dd.siblings(b,function(c){return jO.is(c,a)})},children:function(b,a){return dd.children(b,function(c){return jO.is(c,a)})},descendants:function(b,a){return jO.all(a,b)}};function gq(f,c,a,b,d){return f(a,b)?lN.some(a):lZ.isFunction(d)&&d(a)?lN.none():c(a,b,d)}var c0,hN,eD,bg,dJ,dU=function(g,d,b){for(var c=g.dom(),f=lZ.isFunction(b)?b:lM.constant(!1);c.parentNode;){c=c.parentNode;var a=jj.fromDom(c);if(d(a)){return lN.some(a)}if(f(a)){break}}return lN.none()},iJ=function(b,a){return mO.find(b.dom().childNodes,lM.compose(a,jj.fromDom)).map(jj.fromDom)},kh=function(c,a){var b=function(g){for(var f=0;f<g.childNodes.length;f++){if(a(jj.fromDom(g.childNodes[f]))){return lN.some(jj.fromDom(g.childNodes[f]))}var d=b(g.childNodes[f]);if(d.isSome()){return d}}return lN.none()};return b(c.dom())},aq={first:function(a){return kh(j3.body(),a)},ancestor:dU,closest:function(c,b,a){return gq(function(d){return b(d)},dU,c,b,a)},sibling:function(b,a){var c=b.dom();return c.parentNode?iJ(jj.fromDom(c.parentNode),function(d){return !hE.eq(b,d)&&a(d)}):lN.none()},child:iJ,descendant:kh},eQ=function(c,b,a){return aq.ancestor(c,function(d){return jO.is(d,b)},a)},eZ={first:function(a){return jO.one(a)},ancestor:eQ,sibling:function(b,a){return aq.sibling(b,function(c){return jO.is(c,a)})},child:function(b,a){return aq.child(b,function(c){return jO.is(c,a)})},descendant:function(b,a){return jO.one(a,b)},closest:function(c,b,a){return gq(jO.is,eQ,c,b,a)}},fV=function(d,c,a){var b=a!==undefined?a:lM.constant(!1);return b(c)?lN.none():mO.contains(d,f9.name(c))?lN.some(c):eZ.ancestor(c,d.join(","),function(e){return jO.is(e,"table")||b(e)})},bV=function(a,b){return h1.parent(b).map(function(c){return dy.children(c,a)})},bB=lM.curry(bV,"th,td"),fy=lM.curry(bV,"tr"),a1=function(b,a){return parseInt(cp.get(b,a),10)},aQ={cell:function(b,a){return fV(["td","th"],b,a)},firstCell:function(a){return eZ.descendant(a,"th,td")},cells:function(a){return lI.firstLayer(a,"th,td")},neighbourCells:bB,table:function(b,a){return eZ.closest(b,"table",a)},row:function(b,a){return fV(["tr"],b,a)},rows:function(a){return lI.firstLayer(a,"tr")},notCell:function(b,a){return fV(["caption","tr","tbody","tfoot","thead"],b,a)},neighbourRows:fy,attr:a1,grid:function(f,c,a){var b=a1(f,c),d=a1(f,a);return mN.grid(b,d)}},d5=function(b){var a=aQ.rows(b);return mO.map(a,function(g){var f=g,c=h1.parent(f).bind(function(i){var h=f9.name(i);return"tfoot"===h||"thead"===h||"tbody"===h?h:"tbody"}),d=mO.map(aQ.cells(g),function(j){var i=cp.has(j,"rowspan")?parseInt(cp.get(j,"rowspan"),10):1,h=cp.has(j,"colspan")?parseInt(cp.get(j,"colspan"),10):1;return mN.detail(j,i,h)});return mN.rowdata(f,d,c)})},bK=function(b,a){return mO.map(b,function(d){var c=mO.map(aQ.cells(d),function(h){var g=cp.has(h,"rowspan")?parseInt(cp.get(h,"rowspan"),10):1,f=cp.has(h,"colspan")?parseInt(cp.get(h,"colspan"),10):1;return mN.detail(h,g,f)});return mN.rowdata(d,c,a.section())})},em=function(b,a){return b+","+a},cP=function(c,b){var a=mO.bind(c.all(),function(d){return d.cells()});return mO.filter(a,b)},aF={generate:function(h){var b={},g=[],a=h.length,d=0;mO.each(h,function(i,f){var e=[];mO.each(i.cells(),function(v,q){for(var m=0;b[em(f,m)]!==undefined;){m++}for(var p=mN.extended(v.element(),v.rowspan(),v.colspan(),f,m),s=0;s<v.colspan();s++){for(var l=0;l<v.rowspan();l++){var k=m+s,j=em(f+l,k);b[j]=p,d=Math.max(d,k+1)}}e.push(p)}),g.push(mN.rowdata(i.element(),e,i.section()))});var c=mN.grid(a,d);return{grid:lM.constant(c),access:lM.constant(b),all:lM.constant(g)}},getAt:function(d,c,a){var b=d.access()[em(c,a)];return b!==undefined?lN.some(b):lN.none()},findItem:function(d,c,a){var b=cP(d,function(e){return a(c,e.element())});return 0<b.length?lN.some(b[0]):lN.none()},filterItems:cP,justCells:function(b){var a=mO.map(b.all(),function(c){return c.cells()});return mO.flatten(a)}},jd=function(a){return a.style!==undefined},lh=function(c,b,a){if(!lZ.isString(a)){throw console.error("Invalid call to CSS.set. Property ",b,":: Value ",a,":: Element ",c),new Error("CSS value must be a string: "+a)}jd(c)&&c.style.setProperty(b,a)},hm=function(b,a){jd(b)&&b.style.removeProperty(a)},ig=function(d,c,a){var b=d.dom();lh(b,c,a)},iZ=function(b,a){return jd(b)?b.style.getPropertyValue(a):""},kp=function(d,c){var a=d.dom(),b=iZ(a,c);return lN.from(b).filter(function(e){return 0<e.length})},gT={copy:function(d,c){var a=d.dom(),b=c.dom();jd(a)&&jd(b)&&(b.style.cssText=a.style.cssText)},set:ig,preserve:function(d,c){var a=cp.get(d,"style"),b=c(d);return(a===undefined?cp.remove:cp.set)(d,"style",a),b},setAll:function(c,b){var a=c.dom();lX.each(b,function(f,d){lh(a,d,f)})},setOptions:function(c,b){var a=c.dom();lX.each(b,function(f,d){f.fold(function(){hm(a,d)},function(e){lh(a,d,e)})})},remove:function(c,b){var a=c.dom();hm(a,b),cp.has(c,"style")&&""===fv.trim(cp.get(c,"style"))&&cp.remove(c,"style")},get:function(f,c){var a=f.dom(),b=window.getComputedStyle(a).getPropertyValue(c),d=""!==b||j3.inBody(f)?b:iZ(a,c);return null===d?undefined:d},getRaw:kp,getAllRaw:function(f){var c={},a=f.dom();if(jd(a)){for(var b=0;b<a.style.length;b++){var d=a.style.item(b);c[d]=a.style[d]}}return c},isValidValue:function(d,c,a){var b=jj.fromTag(d);return ig(b,c,a),kp(b,c).isSome()},reflow:function(a){return a.dom().offsetWidth},transfer:function(a,b,c){f9.isElement(a)&&f9.isElement(b)&&mO.each(c,function(g){var f,d;f=b,kp(a,d=g).each(function(e){kp(f,d).isNone()&&ig(f,d,e)})})}},nh=function(b,a){h1.parent(b).each(function(c){c.dom().insertBefore(a.dom(),b.dom())})},lU=function(b,a){b.dom().appendChild(a.dom())},jK={before:nh,after:function(b,a){h1.nextSibling(b).fold(function(){h1.parent(b).each(function(c){lU(c,a)})},function(c){nh(c,a)})},prepend:function(b,a){h1.firstChild(b).fold(function(){lU(b,a)},function(c){b.dom().insertBefore(a.dom(),c.dom())})},append:lU,appendAt:function(c,b,a){h1.child(c,a).fold(function(){lU(c,b)},function(d){nh(d,b)})},wrap:function(b,a){nh(b,a),lU(a,b)}},hP={before:function(a,b){mO.each(b,function(c){jK.before(a,c)})},after:function(a,b){mO.each(b,function(f,d){var c=0===d?a:b[d-1];jK.after(c,f)})},prepend:function(a,b){mO.each(b.slice().reverse(),function(c){jK.prepend(a,c)})},append:function(a,b){mO.each(b,function(c){jK.append(a,c)})}},k1=function(b){var a=b.dom();null!==a.parentNode&&a.parentNode.removeChild(a)},lB={empty:function(a){a.dom().textContent="",mO.each(h1.children(a),function(b){k1(b)})},remove:k1,unwrap:function(b){var a=h1.children(b);0<a.length&&hP.before(b,a),k1(b)}},jy=mE.immutable("minRow","minCol","maxRow","maxCol"),kP=function(z,G){var k,C,w,j,J,I,B,y,q,F,H=function(a){return jO.is(a.element(),G)},A=d5(z),E=aF.generate(A),D=(C=H,w=(k=E).grid().columns(),j=k.grid().rows(),J=w,B=I=0,lX.each(k.access(),function(g){if(C(g)){var d=g.row(),a=d+g.rowspan()-1,c=g.column(),f=c+g.colspan()-1;d<j?j=d:I<a&&(I=a),c<J?J=c:B<f&&(B=f)}}),jy(j,J,I,B)),x="th:not("+G+"),td:not("+G+")",b=lI.filterFirstLayer(z,"th,td",function(a){return jO.is(a,x)});return mO.each(b,lB.remove),function(h,K,O,d){for(var g,p,N,M=K.grid().columns(),L=K.grid().rows(),m=0;m<L;m++){for(var P=!1,v=0;v<M;v++){m<O.minRow()||m>O.maxRow()||v<O.minCol()||v>O.maxCol()||(aF.getAt(K,m,v).filter(d).isNone()?(g=P,p=h[m].element(),N=jj.fromTag("td"),jK.append(N,jj.fromTag("br")),(g?jK.append:jK.prepend)(p,N)):P=!0)}}}(A,E,D,H),y=z,q=D,F=mO.filter(lI.firstLayer(y,"tr"),function(a){return 0===a.dom().childElementCount}),mO.each(F,lB.remove),q.minCol()!==q.maxCol()&&q.minRow()!==q.maxRow()||mO.each(lI.firstLayer(y,"th,td"),function(a){cp.remove(a,"rowspan"),cp.remove(a,"colspan")}),cp.remove(y,"width"),cp.remove(y,"height"),gT.remove(y,"width"),gT.remove(y,"height"),z},kD=function(b,a){return jj.fromDom(b.dom().cloneNode(a))},iN=function(a){return kD(a,!0)},gw=function(d,c){var a=jj.fromTag(c),b=cp.clone(d);return cp.setAll(a,b),a},mI=function(a){return kD(a,!1)},fX=iN,e1=function(d,c){var a=gw(d,c),b=h1.children(iN(d));return hP.append(a,b),a},fA=(c0=f9.isText,hN="text",eD=function(a){return c0(a)?lN.from(a.dom().nodeValue):lN.none()},bg=aC.detect().browser,{get:function(a){if(!c0(a)){throw new Error("Can only get "+hN+" value of a "+hN+" node")}return dJ(a).getOr("")},getOption:dJ=bg.isIE()&&10===bg.version.major?function(b){try{return eD(b)}catch(a){return lN.none()}}:eD,set:function(b,a){if(!c0(b)){throw new Error("Can only set raw "+hN+" value of a "+hN+" node")}b.dom().nodeValue=a}}),g4={get:function(a){return fA.get(a)},getOption:function(a){return fA.getOption(a)},set:function(b,a){fA.set(b,a)}},cx=function(a){return"img"===f9.name(a)?1:g4.getOption(a).fold(function(){return h1.children(a).length},function(b){return b.length})},cb=["img","br"],bZ=cx,gH=function(a){return g4.getOption(a).filter(function(b){return 0!==b.trim().length||-1<b.indexOf("\xa0")}).isSome()||mO.contains(cb,f9.name(a))},jW=function(c,b){var a=function(i){for(var g=h1.children(i),d=g.length-1;0<=d;d--){var f=g[d];if(b(f)){return lN.some(f)}var h=a(f);if(h.isSome()){return h}}return lN.none()};return a(c)},h0={first:function(a){return aq.descendant(a,gH)},last:function(a){return jW(a,gH)}},c4=function(){var a=jj.fromTag("td");return jK.append(a,jj.fromTag("br")),a},dk=function(d,c,a){var b=e1(d,c);return lX.each(a,function(g,f){null===g?cp.remove(b,f):cp.set(b,f,g)}),b},f8=function(a){return a},cT=function(a){return function(){return jj.fromTag("tr",a.dom())}},hD=function(d,b,a){return{row:cT(b),cell:function(m){var j,l,h,k=h1.owner(m.element()),g=jj.fromTag(f9.name(m.element()),k.dom()),f=a.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),c=0<f.length?(j=m.element(),l=g,h=f,h0.first(j).map(function(p){var o=h.join(","),i=dy.ancestors(p,o,function(e){return hE.eq(e,j)});return mO.foldr(i,function(s,r){var q=mI(r);return jK.append(s,q),q},l)}).getOr(l)):g;return jK.append(c,jj.fromTag("br")),gT.copy(m.element(),g),gT.remove(g,"height"),1!==m.colspan()&&gT.remove(m.element(),"width"),d(m.element(),g),g},replace:dk,gap:c4}},ew=function(a){return{row:cT(a),cell:c4,replace:f8,gap:c4}},a5=function(c,b){var a=(b||document).createElement("div");return a.innerHTML=c,h1.children(jj.fromDom(a))},dC=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function dN(){return{up:lM.constant({selector:eZ.ancestor,closest:eZ.closest,predicate:aq.ancestor,all:h1.parents}),down:lM.constant({selector:dy.descendants,predicate:dd.descendants}),styles:lM.constant({get:gT.get,getRaw:gT.getRaw,set:gT.set,remove:gT.remove}),attrs:lM.constant({get:cp.get,set:cp.set,remove:cp.remove,copyTo:function(c,b){var a=cp.clone(c);cp.setAll(b,a)}}),insert:lM.constant({before:jK.before,after:jK.after,afterAll:hP.after,append:jK.append,appendAll:hP.append,prepend:jK.prepend,wrap:jK.wrap}),remove:lM.constant({unwrap:lB.unwrap,remove:lB.remove}),create:lM.constant({nu:jj.fromTag,clone:function(a){return jj.fromDom(a.dom().cloneNode(!1))},text:jj.fromText}),query:lM.constant({comparePosition:function(b,a){return b.dom().compareDocumentPosition(a.dom())},prevSibling:h1.prevSibling,nextSibling:h1.nextSibling}),property:lM.constant({children:h1.children,name:f9.name,parent:h1.parent,isText:f9.isText,isComment:f9.isComment,isElement:f9.isElement,getText:g4.get,setText:g4.set,isBoundary:function(a){return !!f9.isElement(a)&&("body"===f9.name(a)||mO.contains(dC,f9.name(a)))},isEmptyTag:function(a){return !!f9.isElement(a)&&mO.contains(["br","img","hr","input"],f9.name(a))}}),eq:hE.eq,is:hE.is}}var iC=mE.immutable("left","right"),j7=function(d,c,a){var b=d.property().children(c);return mO.findIndex(b,lM.curry(d.eq,a)).map(function(e){return{before:lM.constant(b.slice(0,e)),after:lM.constant(b.slice(e+1))}})},ad=function(a,b,c){return j7(a,b,c).map(function(f){var d=a.create().clone(b);return a.insert().appendAll(d,f.before().concat([c])),a.insert().appendAll(b,f.after()),a.insert().before(b,d),iC(d,b)})},eF=function(a,b,c){return j7(a,b,c).map(function(f){var d=a.create().clone(b);return a.insert().appendAll(d,f.after()),a.insert().after(b,d),iC(b,d)})},eP=function(e,h,d,b){var f=mE.immutable("first","second","splits"),g=function(j,c,i){var a=f(j,lN.none(),i);return d(j)?f(j,c,i):e.property().parent(j).bind(function(k){return b(e,k,j).map(function(o){var m=[{first:o.left,second:o.right}],l=d(k)?k:o.left();return g(l,lN.some(o.right()),i.concat(m))}).getOr(a)})};return g(h,lN.none(),[])},fL=function(b,d,f,c){var a=d(b,f);return mO.foldr(c,function(i,h){var g=d(b,h);return bM(b,i,g)},a)},bM=function(b,c,a){return c.bind(function(d){return a.filter(lM.curry(b.eq,d))})},bm=function(d,c,a){return 0<a.length?fL(d,c,(b=a)[0],b.slice(1)):lN.none();var b},fg=function(b,a){return lM.curry(b.eq,a)},aU=function(j,f,q,b){var d=b!==undefined?b:lM.constant(!1),h=[f].concat(j.up().all(f)),p=[q].concat(j.up().all(q)),m=function(a){return mO.findIndex(a,d).fold(function(){return a},function(c){return a.slice(0,c+1)})},k=m(h),g=m(p),v=mO.find(k,function(a){return mO.exists(g,fg(j,a))});return{firstpath:lM.constant(k),secondpath:lM.constant(g),shared:lM.constant(v)}},aJ=function(c,d,a){var b=aU(c,d,a);return b.shared().bind(function(e){return function(m,j,p,l){var g=m.property().children(j);if(m.eq(j,p[0])){return lN.some([p[0]])}if(m.eq(j,l[0])){return lN.some([l[0]])}var h=function(s){var q=mO.reverse(s),i=mO.findIndex(q,fg(m,j)).getOr(-1),o=i<q.length-1?q[i+1]:q[i];return mO.findIndex(g,fg(m,o))},k=h(p),f=h(l);return k.bind(function(i){return f.map(function(r){var q=Math.min(i,r),o=Math.max(i,r);return g.slice(q,o+1)})})}(c,e,b.firstpath(),b.secondpath())})},dY=aU,bA=function(c,b,a){return bm(c,b,a)},d9=function(c,b,a){return aJ(c,b,a)},cI=function(d,c,a,b){return dY(d,c,a,b)},ay=function(c,b,a){return ad(c,b,a)},jg=function(c,b,a){return eF(c,b,a)},lk=function(d,c,a,b){return eP(d,c,a,b)},hv=dN(),ik={sharedOne:function(a,b){return bA(hv,function(d,c){return a(c)},b)},subset:function(b,a){return d9(hv,b,a)},ancestors:function(c,b,a){return cI(hv,c,b,a)},breakToLeft:function(b,a){return ay(hv,b,a)},breakToRight:function(b,a){return jg(hv,b,a)},breakPath:function(c,b,a){return lk(hv,c,b,function(g,f,d){return a(f,d)})}},i1=function(b,a){return a.column()>=b.startCol()&&a.column()+a.colspan()-1<=b.finishCol()&&a.row()>=b.startRow()&&a.row()+a.rowspan()-1<=b.finishRow()},kv=function(g,d){var b=d.column(),c=d.column()+d.colspan()-1,f=d.row(),a=d.row()+d.rowspan()-1;return b<=g.finishCol()&&c>=g.startCol()&&f<=g.finishRow()&&a>=g.startRow()},gW=function(g,d){for(var b=!0,c=lM.curry(i1,d),f=d.startRow();f<=d.finishRow();f++){for(var a=d.startCol();a<=d.finishCol();a++){b=b&&aF.getAt(g,f,a).exists(c)}}return b?lN.some(d):lN.none()},nk=function(f,c,a){var b=aF.findItem(f,c,hE.eq),d=aF.findItem(f,a,hE.eq);return b.bind(function(e){return d.map(function(i){return h=e,g=i,mN.bounds(Math.min(h.row(),g.row()),Math.min(h.column(),g.column()),Math.max(h.row()+h.rowspan()-1,g.row()+g.rowspan()-1),Math.max(h.column()+h.colspan()-1,g.column()+g.colspan()-1));var h,g})})},lY=nk,jM=function(b,c,a){return nk(b,c,a).bind(function(d){return gW(b,d)})},hS=function(b,d,c,a){return aF.findItem(b,d,hE.eq).bind(function(h){var g=0<c?h.row()+h.rowspan()-1:h.row(),f=0<a?h.column()+h.colspan()-1:h.column();return aF.getAt(b,g+c,f+a).map(function(e){return e.element()})})},k3=function(a,c,b){return lY(a,c,b).map(function(f){var d=aF.filterItems(a,lM.curry(kv,f));return mO.map(d,function(e){return e.element()})})},lD=function(b,a){return aF.findItem(b,a,function(d,c){return hE.contains(c,d)}).bind(function(c){return c.element()})},jA=function(b){var a=d5(b);return aF.generate(a)},kR=function(a,b,c){return aQ.table(a).bind(function(f){var d=jA(f);return hS(d,a,b,c)})},kF=function(d,c,a){var b=jA(d);return k3(b,c,a)},iP=function(k,h,f,g,j){var d=jA(k),c=hE.eq(k,f)?h:lD(d,h),b=hE.eq(k,j)?g:lD(d,g);return k3(d,c,b)},gz=function(d,c,a){var b=jA(d);return jM(b,c,a)},mM=function(b,a){return eZ.ancestor(b,"table")},f0=mE.immutableBag(["boxes","start","finish"],[]),e4=function(d,f,e){var b=function(a){return function(c){return e(c)||hE.eq(c,a)}};return hE.eq(d,f)?lN.some(f0({boxes:lN.some([d]),start:d,finish:f})):mM(d).bind(function(a){return mM(f).bind(function(g){if(hE.eq(a,g)){return lN.some(f0({boxes:kF(a,d,f),start:d,finish:f}))}if(hE.contains(a,g)){var j=0<(h=dy.ancestors(f,"td,th",b(a))).length?h[h.length-1]:f;return lN.some(f0({boxes:iP(a,d,a,f,g),start:d,finish:j}))}if(hE.contains(g,a)){var h,c=0<(h=dy.ancestors(d,"td,th",b(g))).length?h[h.length-1]:d;return lN.some(f0({boxes:iP(g,d,a,f,g),start:d,finish:c}))}return ik.ancestors(d,f).shared().bind(function(i){return eZ.closest(i,"table",e).bind(function(q){var m=dy.ancestors(f,"td,th",b(q)),k=0<m.length?m[m.length-1]:f,l=dy.ancestors(d,"td,th",b(q)),p=0<l.length?l[l.length-1]:d;return lN.some(f0({boxes:iP(q,d,a,f,g),start:p,finish:k}))})})})})},fD=e4,g7=function(c,b){var a=dy.descendants(c,b);return 0<a.length?lN.some(a):lN.none()},cz=function(h,f,c,d,g){return(b=h,a=g,mO.find(b,function(e){return jO.is(e,a)})).bind(function(e){return kR(e,f,c).bind(function(k){return j=k,i=d,eZ.ancestor(j,"table").bind(function(l){return eZ.descendant(l,i).bind(function(m){return e4(m,j).bind(function(n){return n.boxes().map(function(o){return{boxes:lM.constant(o),start:lM.constant(n.start()),finish:lM.constant(n.finish())}})})})});var j,i})});var b,a},cg=function(c,b,a){return eZ.descendant(c,b).bind(function(d){return eZ.descendant(c,a).bind(function(f){return ik.sharedOne(mM,[d,f]).map(function(e){return{first:lM.constant(d),last:lM.constant(f),table:lM.constant(e)}})})})},b1=function(b,a){return g7(b,a)},gK=function(b,c,a){return cg(b,c,a).bind(function(d){var h=function(e){return hE.eq(b,e)},g=eZ.ancestor(d.first(),"thead,tfoot,tbody,table",h),f=eZ.ancestor(d.last(),"thead,tfoot,tbody,table",h);return g.bind(function(i){return f.bind(function(e){return hE.eq(i,e)?gz(d.table(),d.first(),d.last()):lN.none()})})})},jY="data-mce-selected",h3="data-mce-first-selected",c6="data-mce-last-selected",dp={selected:lM.constant(jY),selectedSelector:lM.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:lM.constant("[data-mce-selected]"),firstSelected:lM.constant(h3),firstSelectedSelector:lM.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:lM.constant(c6),lastSelectedSelector:lM.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},gd=function(c){if(!lZ.isArray(c)){throw new Error("cases must be an array")}if(0===c.length){throw new Error("there must be at least one case")}var b=[],d={};return mO.each(c,function(j,f){var g=lX.keys(j);if(1!==g.length){throw new Error("one and only one name per case")}var h=g[0],a=j[h];if(d[h]!==undefined){throw new Error("duplicate key detected:"+h)}if("cata"===h){throw new Error("cannot have a case named cata (sorry)")}if(!lZ.isArray(a)){throw new Error("case arguments must be an array")}b.push(h),d[h]=function(){var l=arguments.length;if(l!==a.length){throw new Error("Wrong number of arguments to case "+h+". Expected "+a.length+" ("+a+"), got "+l)}for(var i=new Array(l),k=0;k<i.length;k++){i[k]=arguments[k]}return{fold:function(){if(arguments.length!==c.length){throw new Error("Wrong number of arguments to fold. Expected "+c.length+", got "+arguments.length)}return arguments[f].apply(null,i)},match:function(o){var m=lX.keys(o);if(b.length!==m.length){throw new Error("Wrong number of arguments to match. Expected: "+b.join(",")+"\nActual: "+m.join(","))}if(!mO.forall(b,function(e){return mO.contains(m,e)})){throw new Error("Not all branches were specified when using match. Specified: "+m.join(", ")+"\nRequired: "+b.join(", "))}return o[h].apply(null,i)},log:function(e){console.log(e,{constructors:b,constructor:h,params:i})}}}}),d},cV=gd([{none:[]},{multiple:["elements"]},{single:["selection"]}]),hG={cata:function(d,c,a,b){return d.fold(c,a,b)},none:cV.none,multiple:cV.multiple,single:cV.single},ey=function(b,a){return hG.cata(a.get(),lM.constant([]),lM.identity,lM.constant([b]))},a7=function(a,b){return hG.cata(b.get(),lN.none,function(c,d){return 0===c.length?lN.none():gK(a,dp.firstSelectedSelector(),dp.lastSelectedSelector()).bind(function(e){return 1<c.length?lN.some({bounds:lM.constant(e),cells:lM.constant(c)}):lN.none()})},lN.none)},dE=function(c,b){var a=ey(c,b);return 0<a.length&&mO.forall(a,function(d){return cp.has(d,"rowspan")&&1<parseInt(cp.get(d,"rowspan"),10)||cp.has(d,"colspan")&&1<parseInt(cp.get(d,"colspan"),10)})?lN.some(a):lN.none()},dP=ey,iE=function(a){return{element:lM.constant(a),mergable:lN.none,unmergable:lN.none,selection:lM.constant([a])}},j9=mE.immutable("element","clipboard","generators"),ah={noMenu:iE,forMenu:function(c,b,a){return{element:lM.constant(a),mergable:lM.constant(a7(b,c)),unmergable:lM.constant(dE(a,c)),selection:lM.constant(dP(a,c))}},notCell:function(a){return iE(a)},paste:j9,pasteRows:function(f,c,a,b,d){return{element:lM.constant(a),mergable:lN.none,unmergable:lN.none,selection:lM.constant(dP(a,f)),clipboard:lM.constant(b),generators:lM.constant(d)}}},eI=function(d,f,e,b){d.on("BeforeGetContent",function(a){!0===a.selection&&hG.cata(f.get(),lM.noop,function(g){var c;a.preventDefault(),(c=g,aQ.table(c[0]).map(fX).map(function(h){return[kP(h,dp.attributeSelector())]})).each(function(h){a.content=mO.map(h,function(j){return i=j,d.selection.serializer.serialize(i.dom(),{});var i}).join("")})},lM.noop)}),d.on("BeforeSetContent",function(a){!0===a.selection&&!0===a.paste&&lN.from(d.dom.getParent(d.selection.getStart(),"th,td")).each(function(g){var c=jj.fromDom(g);aQ.table(c).bind(function(j){var l=mO.filter(a5(a.content),function(m){return"meta"!==f9.name(m)});if(1===l.length&&"table"===f9.name(l[0])){a.preventDefault();var h=jj.fromDom(d.getDoc()),i=ew(h),k=ah.paste(c,l[0],i);e.pasteCells(j,k).each(function(m){d.selection.setRng(m),d.focus(),b.clear(j)})}})})})};function eS(b,c){var d=function(h){var g=c(h);if(g<=0||null===g){var f=gT.get(h,b);return parseFloat(f)||0}return g},a=function(e,f){return mO.foldl(f,function(j,i){var g=gT.get(e,i),h=g===undefined?0:parseInt(g,10);return isNaN(h)?j:j+h},0)};return{set:function(h,g){if(!lZ.isNumber(g)&&!g.match(/^[0-9]+$/)){throw b+".set accepts only positive integer values. Value was "+g}var f=h.dom();jd(f)&&(f.style[b]=g+"px")},get:d,getOuter:d,aggregate:a,max:function(i,h,f){var g=a(i,f);return g<h?h-g:0}}}var fO=eS("height",function(a){return j3.inBody(a)?a.dom().getBoundingClientRect().height:a.dom().offsetHeight}),bP=function(a){return fO.get(a)},bq=function(a){return fO.getOuter(a)},fk=eS("width",function(a){return a.dom().offsetWidth}),aW=function(a){return fk.get(a)},aL=function(a){return fk.getOuter(a)},d0=aC.detect(),bD=function(g,d,b){return c=gT.get(g,d),f=b,a=parseFloat(c),isNaN(a)?f:a;var c,f,a},ed=function(h){return d0.browser.isIE()||d0.browser.isEdge()?(c=bD(f=h,"padding-top",0),d=bD(f,"padding-bottom",0),g=bD(f,"border-top-width",0),b=bD(f,"border-bottom-width",0),a=f.dom().getBoundingClientRect().height,"border-box"===gT.get(f,"box-sizing")?a:a-c-d-(g+b)):bD(h,"height",bP(h));var f,c,d,g,b,a},cK=/(\d+(\.\d+)?)(\w|%)*/,aA=/(\d+(\.\d+)?)%/,jh=/(\d+(\.\d+)?)px|em/,lm=function(b,a){gT.set(b,"height",a+"px")},hx=function(f,j,q,b){var d,h,p,m,k,g=parseInt(f,10);return fv.endsWith(f,"%")&&"table"!==f9.name(j)?(d=j,h=g,p=q,m=b,k=aQ.table(d).map(function(c){var a=p(c);return Math.floor(h/100*a)}).getOr(h),m(d,k),k):g},ip=function(c){var b,a=(b=c,gT.getRaw(b,"height").getOrThunk(function(){return ed(b)+"px"}));return a?hx(a,c,bP,lm):bP(c)},i2=function(b,a){return cp.has(b,a)?parseInt(cp.get(b,a),10):1},kw=function(a){return gT.getRaw(a,"width").fold(function(){return lN.from(cp.get(a,"width"))},function(b){return lN.some(b)})},gY=function(b,a){return b/a.pixelWidth()*100},nm={percentageBasedSizeRegex:lM.constant(aA),pixelBasedSizeRegex:lM.constant(jh),setPixelWidth:function(b,a){gT.set(b,"width",a+"px")},setPercentageWidth:function(b,a){gT.set(b,"width",a+"%")},setHeight:lm,getPixelWidth:function(b,a){return kw(b).fold(function(){var c=aW(b);return parseInt(c,10)},function(c){return function(l,j,g){if(jh.test(j)){var h=jh.exec(j);return parseInt(h[1],10)}if(aA.test(j)){var k=aA.exec(j),f=parseFloat(k[1]);return f/100*g.pixelWidth()}var d=aW(l);return parseInt(d,10)}(b,c,a)})},getPercentageWidth:function(a,b){return kw(a).fold(function(){var d=aW(a),c=parseInt(d,10);return gY(c,b)},function(c){return function(k,h,f){if(aA.test(h)){var g=aA.exec(h);return parseFloat(g[1])}var j=aW(k),d=parseInt(j,10);return gY(d,f)}(a,c,b)})},getGenericWidth:function(a){return kw(a).bind(function(c){if(cK.test(c)){var b=cK.exec(c);return lN.some({width:lM.constant(b[1]),unit:lM.constant(b[3])})}return lN.none()})},setGenericWidth:function(c,b,a){gT.set(c,"width",b+a)},getHeight:function(c){return a="rowspan",ip(b=c)/i2(b,a);var b,a},getRawWidth:kw},l2=function(a,b){nm.getGenericWidth(a).each(function(d){var c=d.width()/2;nm.setGenericWidth(a,c,d.unit()),nm.setGenericWidth(b,c,d.unit())})},jN=function(c,b){var a=b||jj.fromDom(document.documentElement);return aq.ancestor(c,lM.curry(hE.eq,a)).isSome()},hU=function(b){var a=b.dom();return a===a.window?b:f9.isDocument(b)?a.defaultView||a.parentWindow:null},k4=function(a,b){return{left:lM.constant(a),top:lM.constant(b),translate:function(d,c){return k4(a+d,b+c)}}},jB=function(b,a){return b!==undefined?b:a!==undefined?a:0},kS=function(g){var d,b=g.dom(),c=b.ownerDocument,f=c.body,a=jj.fromDom(c.documentElement);return f===b?k4(f.offsetLeft,f.offsetTop):jN(g,a)?(d=b.getBoundingClientRect(),k4(d.left,d.top)):k4(0,0)},kG=function(f){var h=f.dom().ownerDocument,m=h.body,b=hU(jj.fromDom(h)),d=h.documentElement,g=jB(b.pageYOffset,d.scrollTop),l=jB(b.pageXOffset,d.scrollLeft),k=jB(d.clientTop,m.clientTop),j=jB(d.clientLeft,m.clientLeft);return kS(f).translate(l-j,g-k)},iQ=mE.immutable("row","y"),gB=mE.immutable("col","x"),mQ=function(a){return kG(a).left()+aL(a)},f2=function(a){return kG(a).left()},e6=function(b,a){return gB(b,f2(a))},fF=function(b,a){return gB(b,mQ(a))},hb=function(a){return kG(a).top()},cA=function(a,c,b){if(0===b.length){return[]}var f=mO.map(b.slice(1),function(h,g){return h.map(function(e){return a(g,e)})}),d=b[b.length-1].map(function(e){return c(b.length-1,e)});return f.concat([d])},ch={delta:lM.identity,positions:lM.curry(cA,function(b,a){return iQ(b,hb(a))},function(b,a){return iQ(b,hb(a)+bq(a))}),edge:hb},b2={delta:lM.identity,edge:f2,positions:lM.curry(cA,e6,fF)},gN={height:ch,rtl:{delta:function(b,a){return -b},edge:mQ,positions:lM.curry(cA,fF,e6)},ltr:b2},jZ={ltr:gN.ltr,rtl:gN.rtl};function h6(b){var a=function(c){return b(c).isRtl()?jZ.rtl:jZ.ltr};return{delta:function(d,c){return a(c).delta(d,c)},edge:function(c){return a(c).edge(c)},positions:function(d,c){return a(c).positions(d,c)}}}var c7=function(b){var a=d5(b);return aF.generate(a).grid()},dq=function(c){var b=c,a=function(){return b};return{get:a,set:function(d){b=d},clone:function(){return dq(a())}}},gj=function(b,a){return cW(b,a,{validate:lZ.isFunction,label:"function"})},cW=function(b,c,a){if(0===c.length){throw new Error("You must specify at least one required field.")}return m0("required",c),mF(c),function(f){var d=lX.keys(f);mO.forall(c,function(e){return mO.contains(d,e)})||mz(c,d),b(c,d);var g=mO.filter(c,function(e){return !a.validate(f[e],e)});return 0<g.length&&m3(g,a.label),f}},hJ=lM.noop,ez={exactly:lM.curry(gj,function(b,c){var a=mO.filter(c,function(d){return !mO.contains(b,d)});0<a.length&&lL(a)}),ensure:lM.curry(gj,hJ),ensureWith:lM.curry(cW,hJ)},a8=function(c){var b=cp.has(c,"colspan")?parseInt(cp.get(c,"colspan"),10):1,a=cp.has(c,"rowspan")?parseInt(cp.get(c,"rowspan"),10):1;return{element:lM.constant(c),colspan:lM.constant(b),rowspan:lM.constant(a)}},dF=ez.exactly(["cell","row","replace","gap"]),dQ=function(f,h){dF(f);var e=dq(lN.none()),g=h!==undefined?h:a8,d=function(j){var i,a=g(j);return i=a,f.cell(i)},c=function(i){var a=d(i);return e.get().isNone()&&e.set(lN.some(a)),b=lN.some({item:i,replacement:a}),a},b=lN.none();return{getOrInit:function(i,a){return b.fold(function(){return c(i)},function(j){return a(i,j.item)?j.replacement:c(i)})},cursor:e.get}},iF=function(c,b){return function(e){var f=dq(lN.none());dF(e);var d=[],a=function(h){var g=e.replace(h,b,{scope:c});return d.push({item:h,sub:g}),f.get().isNone()&&f.set(lN.some(g)),g};return{replaceOrInit:function(i,g){return(h=i,j=g,mO.find(d,function(k){return j(k.item,h)})).fold(function(){return a(i)},function(k){return g(i,k.item)?k.sub:a(i)});var h,j},cursor:f.get}}},kb=function(a){dF(a);var b=dq(lN.none());return{combine:function(c){return b.get().isNone()&&b.set(lN.some(c)),function(){var d=a.cell({element:lM.constant(c),colspan:lM.constant(1),rowspan:lM.constant(1)});return gT.remove(d,"width"),gT.remove(c,"width"),d}},cursor:b.get}},aj=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],eK=function(c,b){var a=c.property().name(b);return mO.contains(aj,a)},eV=function(b,a){return mO.contains(["br","img","hr","input"],b.property().name(a))},fR=eK,bR=function(c,b){var a=c.property().name(b);return mO.contains(["ol","ul"],a)},bv=eV,fq=dN(),aX=function(a){return fR(fq,a)},aM=function(a){return bR(fq,a)},d1=function(a){return bv(fq,a)},bG=function(f){var d,b=function(e){return"br"===f9.name(e)},c=function(e){return h0.last(e).bind(function(g){var i,h=(i=g,h1.nextSibling(i).map(function(j){return !!aX(j)||(d1(j)?"img"!==f9.name(j):void 0)}).getOr(!1));return h1.parent(g).map(function(k){return !0===h||(j=k,"li"===f9.name(j)||aq.ancestor(j,aM).isSome())||b(g)||aX(k)&&!hE.eq(e,k)?[]:[jj.fromTag("br")];var j})}).getOr([])},a=0===(d=mO.bind(f,function(i){var h,g=h1.children(i);return h=g,mO.forall(h,function(e){return b(e)||f9.isText(e)&&0===g4.get(e).trim().length})?[]:g.concat(c(i))})).length?[jj.fromTag("br")]:d;lB.empty(f[0]),hP.append(f[0],a)},eg=function(a){return function(){for(var h=new Array(arguments.length),f=0;f<h.length;f++){h[f]=arguments[f]}if(0===h.length){throw new Error("Can't merge zero objects")}for(var c={},d=0;d<h.length;d++){var g=h[d];for(var b in g){g.hasOwnProperty(b)&&(c[b]=a(c[b],g[b]))}}return c}},cL=eg(function(b,a){return lZ.isObject(b)&&lZ.isObject(a)?cL(b,a):a}),aB=eg(function(b,a){return a}),jm={deepMerge:cL,merge:aB},lv=function(d){for(var c=[],a=function(e){c.push(e)},b=0;b<d.length;b++){d[b].each(a)}return c},hA=function(d,c){for(var a=0;a<d.length;a++){var b=c(d[a],a);if(b.isSome()){return b}}return lN.none()},iw=function(b,a){return mN.rowcells(a,b.section())},i5=function(b,a){return b.cells()[a]},ky={addCell:function(h,f,c){var d=h.cells(),g=d.slice(0,f),b=d.slice(f),a=g.concat([c]).concat(b);return iw(h,a)},setCells:iw,mutateCell:function(c,b,a){c.cells()[b]=a},getCell:i5,getCellElement:function(b,a){return i5(b,a).element()},mapCells:function(d,c){var a=d.cells(),b=mO.map(a,c);return mN.rowcells(b,d.section())},cellLength:function(a){return a.cells().length}},g1=function(c,b){if(0===c.length){return 0}var a=c[0];return mO.findIndex(c,function(d){return !b(a.element(),d.element())}).fold(function(){return c.length},function(d){return d})},nv=function(g,m,w,b){var d,j,v,q,p=(d=g,j=m,d[j]).cells().slice(w),h=g1(p,b),x=(v=g,q=w,mO.map(v,function(a){return ky.getCell(a,q)})).slice(m),k=g1(x,b);return{colspan:lM.constant(h),rowspan:lM.constant(k)}},md=function(c,b){var a=mO.map(c,function(f,d){return mO.map(f.cells(),function(h,g){return !1})});return mO.map(c,function(g,d){var f=mO.bind(g.cells(),function(j,i){if(!1===a[d][i]){var h=nv(c,d,i,b);return function(s,p,l,m){for(var q=s;q<s+l;q++){for(var k=p;k<p+m;k++){a[q][k]=!0}}}(d,i,h.rowspan(),h.colspan()),[mN.detailnew(j.element(),h.rowspan(),h.colspan(),j.isNew())]}return[]});return mN.rowdetails(f,g.section())})},jQ=function(f,h,m){for(var b=[],d=0;d<f.grid().rows();d++){for(var g=[],l=0;l<f.grid().columns();l++){var k=aF.getAt(f,d,l).map(function(a){return mN.elementnew(a.element(),m)}).getOrThunk(function(){return mN.elementnew(h.gap(),!0)});g.push(k)}var j=mN.rowcells(g,f.all()[d].section());b.push(j)}return b},hX=function(d,c,a,b){a===b?cp.remove(d,c):cp.set(d,c,a)},k7=function(j,k){var f=[],c=[],h=function(l,i){var a;0<l.length?function(q,p){var m=eZ.child(j,p).getOrThunk(function(){var e=jj.fromTag(p,h1.owner(j).dom());return jK.append(j,e),e});lB.empty(m);var o=mO.map(q,function(s){s.isNew()&&f.push(s.element());var r=s.element();return lB.empty(r),mO.each(s.cells(),function(e){e.isNew()&&c.push(e.element()),hX(e.element(),"colspan",e.colspan(),1),hX(e.element(),"rowspan",e.rowspan(),1),jK.append(r,e.element())}),r});hP.append(m,o)}(l,i):(a=i,eZ.child(j,a).bind(lB.remove))},d=[],g=[],b=[];return mO.each(k,function(a){switch(a.section()){case"thead":d.push(a);break;case"tbody":g.push(a);break;case"tfoot":b.push(a)}}),h(d,"thead"),h(g,"tbody"),h(b,"tfoot"),{newRows:lM.constant(f),newCells:lM.constant(c)}},lG=function(a){return mO.map(a,function(c){var b=mI(c.element());return mO.each(c.cells(),function(f){var d=fX(f.element());hX(d,"colspan",f.colspan(),1),hX(d,"rowspan",f.rowspan(),1),jK.append(b,d)}),b})},jE=function(d,c){for(var a=[],b=0;b<d;b++){a.push(c(b))}return a},kV=function(d,c){for(var a=[],b=d;b<c;b++){a.push(b)}return a},kJ=function(c,a){if(a<0||a>=c.length-1){return lN.none()}var d=c[a].fold(function(){var e=mO.reverse(c.slice(0,a));return hA(e,function(g,f){return g.map(function(h){return{value:h,delta:f+1}})})},function(e){return lN.some({value:e,delta:0})}),b=c[a+1].fold(function(){var e=c.slice(a+1);return hA(e,function(g,f){return g.map(function(h){return{value:h,delta:f+1}})})},function(e){return lN.some({value:e,delta:1})});return d.bind(function(e){return b.map(function(g){var f=g.delta+e.delta;return Math.abs(g.value-e.value)/f})})},iT=function(d,c,a){var b=d();return mO.find(b,c).orThunk(function(){return lN.from(b[0]).orThunk(a)}).map(function(e){return e.element()})},gE=function(a){var d=a.grid(),c=kV(0,d.columns()),b=kV(0,d.rows());return mO.map(c,function(f){return iT(function(){return mO.bind(b,function(e){return aF.getAt(a,e,f).filter(function(g){return g.column()===f}).fold(lM.constant([]),function(g){return[g]})})},function(e){return 1===e.colspan()},function(){return aF.getAt(a,0,f)})})},mZ=function(a){var d=a.grid(),c=kV(0,d.rows()),b=kV(0,d.columns());return mO.map(c,function(f){return iT(function(){return mO.bind(b,function(e){return aF.getAt(a,f,e).filter(function(g){return g.row()===f}).fold(lM.constant([]),function(g){return[g]})})},function(e){return 1===e.rowspan()},function(){return aF.getAt(a,f,0)})})},f5=function(g,d,b,c,f){var a=jj.fromTag("div");return gT.setAll(a,{position:"absolute",left:d-c/2+"px",top:b+"px",height:f+"px",width:c+"px"}),cp.setAll(a,{"data-column":g,role:"presentation"}),a},e9=function(g,d,b,c,f){var a=jj.fromTag("div");return gT.setAll(a,{position:"absolute",left:d+"px",top:b-f/2+"px",height:f+"px",width:c+"px"}),cp.setAll(a,{"data-row":g,role:"presentation"}),a},fI=function(b){var a=b.replace(/\./g,"-");return{resolve:function(c){return a+"-"+c}}},hh={resolve:fI("ephox-snooker").resolve},cD=function(c,b){var a=cp.get(c,b);return a===undefined||""===a?[]:a.split(" ")},cm=cD,b5=function(d,c,a){var b=cD(d,c).concat([a]);cp.set(d,c,b.join(" "))},gQ=function(d,c,a){var b=mO.filter(cD(d,c),function(e){return e!==a});0<b.length?cp.set(d,c,b.join(" ")):cp.remove(d,c)},j2=function(a){return cm(a,"class")},h9=function(b,a){return b5(b,"class",a)},db=function(b,a){return gQ(b,"class",a)},dx=j2,gp=h9,cZ=db,hM=function(b,a){mO.contains(j2(b),a)?db(b,a):h9(b,a)},eC=function(a){return a.dom().classList!==undefined},bd=function(b,a){return eC(b)&&b.dom().classList.contains(a)},dI={add:function(b,a){eC(b)?b.dom().classList.add(a):gp(b,a)},remove:function(c,b){var a;eC(c)?c.dom().classList.remove(b):cZ(c,b),0===(eC(a=c)?a.dom().classList:dx(a)).length&&cp.remove(a,"class")},toggle:function(b,a){return eC(b)?b.dom().classList.toggle(a):hM(b,a)},toggler:function(f,j){var q,b,d,h,p,m,k=eC(f),g=f.dom().classList;return q=function(){k?g.remove(j):cZ(f,j)},b=function(){k?g.add(j):gp(f,j)},d=bd(f,j),h=d||!1,{on:p=function(){b(),h=!0},off:m=function(){q(),h=!1},toggle:function(){(h?m:p)()},isOn:function(){return h}}},has:bd},dT=hh.resolve("resizer-bar"),iI=hh.resolve("resizer-rows"),kg=hh.resolve("resizer-cols"),ap=function(b){var a=dy.descendants(b.parent(),"."+dT);mO.each(a,lB.remove)},eN=function(a,d,b){var c=a.origin();mO.each(d,function(g,f){g.each(function(i){var h=b(c,i);dI.add(h,dT),jK.append(a.parent(),h)})})},eY=function(q,B,G,b,k,x){var F,E,D,w,H=kG(B),A=0<G.length?k.positions(G,B):[];F=q,E=A,D=H,w=aL(B),eN(F,E,function(d,c){var a=e9(c.row(),D.left()-d.left(),c.y()-d.top(),w,7);return dI.add(a,iI),a});var C,v,z,y,j=0<b.length?x.positions(b,B):[];C=q,v=j,z=H,y=bq(B),eN(C,v,function(d,c){var a=f5(c.col(),c.x()-d.left(),z.top()-d.top(),7,y);return dI.add(a,kg),a})},fU=function(c,b){var a=dy.descendants(c.parent(),"."+dT);mO.each(a,b)},bU={refresh:function(k,h,f,g){ap(k);var j=d5(h),d=aF.generate(j),c=mZ(d),b=gE(d);eY(k,h,c,b,f,g)},hide:function(a){fU(a,function(b){gT.set(b,"display","none")})},show:function(a){fU(a,function(b){gT.set(b,"display","block")})},destroy:ap,isRowBar:function(a){return dI.has(a,iI)},isColBar:function(a){return dI.has(a,kg)}},by=function(b,a){return mO.map(b,function(f){var d,c=(d=f.details(),hA(d,function(e){return h1.parent(e.element()).map(function(h){var g=h1.parent(h).isNone();return mN.elementnew(h,g)})}).getOrThunk(function(){return mN.elementnew(a.row(),!0)}));return mN.rowdatanew(c.element(),f.details(),f.section(),c.isNew())})},fx=function(c,b){var a=md(c,hE.eq);return by(a,b)},a0=function(c,b){var a=mO.flatten(mO.map(c.all(),function(d){return d.cells()}));return mO.find(a,function(d){return hE.eq(b,d.element())})},aP=function(d,h,b,e,g){return function(f,j,m,l,c){var k=d5(j),a=aF.generate(k);return h(a,m).map(function(q){var p=jQ(a,l,!1),i=d(p,q,hE.eq,g(l)),o=fx(i.grid(),l);return{grid:lM.constant(o),cursor:i.cursor}}).fold(function(){return lN.none()},function(o){var i=k7(j,o.grid());return b(j,o.grid(),c),e(j),bU.refresh(f,j,gN.height,c),lN.some({cursor:o.cursor,newRows:i.newRows,newCells:i.newCells})})}},d4=fx,bJ=function(a,b){return aQ.cell(b.element()).bind(function(c){return a0(a,c)})},ek=function(c,d){var a=mO.map(d.selection(),function(e){return aQ.cell(e).bind(function(f){return a0(c,f)})}),b=lv(a);return 0<b.length?lN.some(b):lN.none()},cO=function(b,a){return aQ.cell(a.element()).bind(function(c){return a0(b,c).map(function(d){return jm.merge(d,{generators:a.generators,clipboard:a.clipboard})})})},aE=function(c,d){var a=mO.map(d.selection(),function(e){return aQ.cell(e).bind(function(f){return a0(c,f)})}),b=lv(a);return 0<b.length?lN.some(jm.merge({cells:b},{generators:d.generators,clipboard:d.clipboard})):lN.none()},jb=function(b,a){return a.mergable()},lg=function(b,a){return a.unmergable()},hk=function(a){return{is:function(b){return a===b},isValue:lM.always,isError:lM.never,getOr:lM.constant(a),getOrThunk:lM.constant(a),getOrDie:lM.constant(a),or:function(b){return hk(a)},orThunk:function(b){return hk(a)},fold:function(c,b){return b(a)},map:function(b){return hk(b(a))},each:function(b){b(a)},bind:function(b){return b(a)},exists:function(b){return b(a)},forall:function(b){return b(a)},toOption:function(){return lN.some(a)}}},id=function(a){return{is:lM.never,isValue:lM.never,isError:lM.always,getOr:lM.identity,getOrThunk:function(b){return b()},getOrDie:function(){return lM.die(String(a))()},or:function(b){return b},orThunk:function(b){return b()},fold:function(c,b){return c(a)},map:function(b){return id(a)},each:lM.noop,bind:function(b){return id(a)},exists:lM.never,forall:lM.always,toOption:lN.none}},iY={value:hk,error:id},km=function(b,a){return mO.map(b,function(){return mN.elementnew(a.cell(),!0)})},gS=function(b,c,a){return b.concat(jE(c,function(d){return ky.setCells(b[b.length-1],km(b[b.length-1].cells(),a))}))},ng=function(c,b,a){return mO.map(c,function(d){return ky.setCells(d,d.cells().concat(km(kV(0,b),a)))})},lS=function(h,f,c){if(h.row()>=f.length||h.column()>ky.cellLength(f[0])){return iY.error("invalid start address out of table bounds, row: "+h.row()+", column: "+h.column())}var d=f.slice(h.row()),g=d[0].cells().slice(h.column()),b=ky.cellLength(c[0]),a=c.length;return iY.value({rowDelta:lM.constant(d.length-a),colDelta:lM.constant(g.length-b)})},jJ=function(d,c){var a=ky.cellLength(d[0]),b=ky.cellLength(c[0]);return{rowDelta:lM.constant(0),colDelta:lM.constant(a-b)}},hO=function(d,c,a){var b=c.colDelta()<0?ng:lM.identity;return(c.rowDelta()<0?gS:lM.identity)(b(d,Math.abs(c.colDelta()),a),Math.abs(c.rowDelta()),a)},k0=function(g,d,b,c){if(0===g.length){return g}for(var f=d.startRow();f<=d.finishRow();f++){for(var a=d.startCol();a<=d.finishCol();a++){ky.mutateCell(g[f],a,mN.elementnew(c(),!1))}}return g},lA=function(k,h,f,g){for(var j=!0,d=0;d<k.length;d++){for(var c=0;c<ky.cellLength(k[0]);c++){var b=f(ky.getCellElement(k[d],c),h);!0===b&&!1===j?ky.mutateCell(k[d],c,mN.elementnew(g(),!0)):!0===b&&(j=!1)}}return k},jx=function(g,d,b,l){if(0<d&&d<g.length){var k=g[d-1].cells(),j=(f=k,h=b,mO.foldl(f,function(c,a){return mO.exists(c,function(e){return h(e.element(),a.element())})?c:c.concat([a])},[]));mO.each(j,function(p){for(var i=lN.none(),a=d;a<g.length;a++){for(var c=0;c<ky.cellLength(g[0]);c++){var m=g[a].cells()[c];b(m.element(),p.element())&&(i.isNone()&&(i=lN.some(l())),i.each(function(e){ky.mutateCell(g[a],c,mN.elementnew(e,!0))}))}}})}var f,h;return g},kO=function(c,d,e,b,a){return lS(c,d,e).map(function(g){var f=hO(d,g,b);return function(C,J,x,z,B){for(var F,q,N,L,E,y,I,K=C.row(),D=C.column(),H=K+x.length,G=D+ky.cellLength(x[0]),A=K;A<H;A++){for(var k=D;k<G;k++){F=J,q=A,N=k,L=B,y=E=void 0,E=ky.getCell(F[q],N),y=lM.curry(L,E.element()),I=F[q],1<F.length&&1<ky.cellLength(I)&&(0<N&&y(ky.getCellElement(I,N-1))||N<I.length-1&&y(ky.getCellElement(I,N+1))||0<q&&y(ky.getCellElement(F[q-1],N))||q<F.length-1&&y(ky.getCellElement(F[q+1],N)))&&lA(J,ky.getCellElement(J[A],k),B,z.cell);var M=ky.getCellElement(x[A-K],k-D),j=z.replace(M);ky.mutateCell(J[A],k,mN.elementnew(j,!0))}}return J}(c,f,e,b,a)})},kC=function(f,h,m,b,d){jx(h,f,d,b.cell);var g=jJ(m,h),l=hO(m,g,b),k=jJ(h,l),j=hO(h,k,b);return j.slice(0,f).concat(l).concat(j.slice(f,j.length))},iM=function(f,g,k,j,d){var h=f.slice(0,g),c=f.slice(g),b=ky.mapCells(f[k],function(i,a){return 0<g&&g<f.length&&j(ky.getCellElement(f[g-1],a),ky.getCellElement(f[g],a))?ky.getCell(f[g],a):mN.elementnew(d(i.element(),j),!0)});return h.concat([b]).concat(c)},gv=function(e,b,c,d,a){return mO.map(e,function(g){var f=0<b&&b<ky.cellLength(g)&&d(ky.getCellElement(g,b-1),ky.getCellElement(g,b))?ky.getCell(g,b):mN.elementnew(a(ky.getCellElement(g,c),d),!0);return ky.addCell(g,b,f)})},mG=function(g,e,f,d,c){var b=f+1;return mO.map(g,function(i,h){var a=h===e?mN.elementnew(c(ky.getCellElement(i,f),d),!0):ky.getCell(i,f);return ky.addCell(i,b,a)})},fW=function(f,h,m,b,d){var g=h+1,l=f.slice(0,g),k=f.slice(g),j=ky.mapCells(f[h],function(c,a){return a===m?mN.elementnew(d(c.element(),b),!0):c});return l.concat([j]).concat(k)},e0=function(c,b,a){return c.slice(0,b).concat(c.slice(a+1))},fz=function(d,a,b){var c=mO.map(d,function(g){var f=g.cells().slice(0,a).concat(g.cells().slice(b+1));return mN.rowcells(f,g.section())});return mO.filter(c,function(e){return 0<e.cells().length})},g3=function(d,a,b,c){return mO.map(d,function(e){return ky.mapCells(e,function(g){return f=g,mO.exists(a,function(h){return b(f.element(),h.element())})?mN.elementnew(c(g.element(),b),!0):g;var f})})},cw=function(d,c,a,b){return ky.getCellElement(d[c],a)!==undefined&&0<c&&b(ky.getCellElement(d[c-1],a),ky.getCellElement(d[c],a))},b9=function(c,b,a){return 0<b&&a(ky.getCellElement(c,b-1),ky.getCellElement(c,b))},bY=function(a,b,d,f){var c=mO.bind(a,function(h,g){return cw(a,g,b,d)||b9(h,b,d)?[]:[ky.getCell(h,b)]});return g3(a,c,d,f)},gG=function(b,c,f,g){var a=b[c],d=mO.bind(a.cells(),function(i,h){return cw(b,c,h,f)||b9(a,h,f)?[]:[i]});return g3(b,d,f,g)},jV=function(a){return{fold:a}},hZ=function(){return jV(function(f,c,a,b,d){return f()})},c3=function(a){return jV(function(g,d,b,c,f){return d(a)})},dj=function(b,a){return jV(function(h,f,c,d,g){return c(b,a)})},f7=function(d,c,b){return jV(function(i,g,a,f,h){return f(d,c,b)})},cS=function(b,a){return jV(function(h,f,c,d,g){return g(b,a)})},hC=function(g,m,j,v){var w,b,q=g.slice(0),d=(b=m,0===(w=g).length?hZ():1===w.length?c3(0):0===b?dj(0,1):b===w.length-1?cS(b-1,b):0<b&&b<w.length-1?f7(b-1,b,b+1):hZ()),p=function(a){return mO.map(a,lM.constant(0))},h=lM.constant(p(q)),x=function(l,f){if(0<=j){var a=Math.max(v.minCellWidth(),q[f]-j);return p(q.slice(0,l)).concat([j,a-q[f]]).concat(p(q.slice(f+1)))}var c=Math.max(v.minCellWidth(),q[l]+j),i=q[l]-c;return p(q.slice(0,l)).concat([c-q[l],i]).concat(p(q.slice(f+1)))},k=x;return d.fold(h,function(a){return v.singleColumnWidth(q[a],j)},k,function(f,c,a){return x(c,a)},function(f,c){if(0<=j){return p(q.slice(0,c)).concat([j])}var a=Math.max(v.minCellWidth(),q[c]+j);return p(q.slice(0,c)).concat([a-q[c]])})},ev=function(b,a){return cp.has(b,a)&&1<parseInt(cp.get(b,a),10)},a4={hasColspan:function(a){return ev(a,"colspan")},hasRowspan:function(a){return ev(a,"rowspan")},minWidth:lM.constant(10),minHeight:lM.constant(10),getInt:function(b,a){return parseInt(gT.get(b,a),10)}},dB=function(c,b,a){return gT.getRaw(c,b).fold(function(){return a(c)+"px"},function(d){return d})},dM=function(a){return dB(a,"width",nm.getPixelWidth)},iB=function(a){return dB(a,"height",nm.getHeight)},j6=function(h,f,c,d,g){var b=gE(h),a=mO.map(b,function(e){return e.map(f.edge)});return mO.map(b,function(j,i){return j.filter(lM.not(a4.hasColspan)).fold(function(){var e=kJ(a,i);return d(e)},function(e){return c(e,g)})})},ab=function(a){return a.map(function(b){return b+"px"}).getOr("")},eE=function(g,d,b,c){var f=mZ(g),a=mO.map(f,function(e){return e.map(d.edge)});return mO.map(f,function(i,h){return i.filter(lM.not(a4.hasRowspan)).fold(function(){var e=kJ(a,h);return c(e)},function(e){return b(e)})})},eO={getRawWidths:function(b,a){return j6(b,a,dM,ab)},getPixelWidths:function(c,b,a){return j6(c,b,nm.getPixelWidth,function(d){return d.getOrThunk(a.minCellWidth)},a)},getPercentageWidths:function(c,b,a){return j6(c,b,nm.getPercentageWidth,function(d){return d.fold(function(){return a.minCellWidth()},function(e){return e/a.pixelWidth()*100})},a)},getPixelHeights:function(b,a){return eE(b,a,nm.getHeight,function(c){return c.getOrThunk(a4.minHeight)})},getRawHeights:function(b,a){return eE(b,a,iB,ab)}},fK=function(f,c,a){for(var b=0,d=f;d<c;d++){b+=a[d]!==undefined?a[d]:0}return b},bL=function(c,a){var b=aF.justCells(c);return mO.map(b,function(f){var d=fK(f.column(),f.column()+f.colspan(),a);return{element:f.element,width:lM.constant(d),colspan:f.colspan}})},bk=function(c,a){var b=aF.justCells(c);return mO.map(b,function(f){var d=fK(f.row(),f.row()+f.rowspan(),a);return{element:f.element,height:lM.constant(d),rowspan:f.rowspan}})},fd=function(b,a){return mO.map(b.all(),function(d,c){return{element:d.element,height:lM.constant(a[c])}})},aT=function(c){var b=parseInt(c,10),a=lM.identity;return{width:lM.constant(b),pixelWidth:lM.constant(b),getWidths:eO.getPixelWidths,getCellDelta:a,singleColumnWidth:function(f,d){return[Math.max(a4.minWidth(),f+d)-f]},minCellWidth:a4.minWidth,setElementWidth:nm.setPixelWidth,setTableWidth:function(h,g,d){var f=mO.foldr(g,function(j,i){return j+i},0);nm.setPixelWidth(h,f)}}},aI=function(f,h){if(nm.percentageBasedSizeRegex().test(h)){var m=nm.percentageBasedSizeRegex().exec(h);return d=m[1],g=f,l=parseFloat(d),k=aW(g),{width:lM.constant(l),pixelWidth:lM.constant(k),getWidths:eO.getPercentageWidths,getCellDelta:function(a){return a/k*100},singleColumnWidth:function(c,a){return[100-c]},minCellWidth:function(){return a4.minWidth()/k*100},setElementWidth:nm.setPercentageWidth,setTableWidth:function(o,i,a){var c=l+a;nm.setPercentageWidth(o,c)}}}if(nm.pixelBasedSizeRegex().test(h)){var b=nm.pixelBasedSizeRegex().exec(h);return aT(b[1])}var d,g,l,k,j=aW(f);return aT(j)},dX=function(a){return nm.getRawWidth(a).fold(function(){var b=aW(a);return aT(b)},function(b){return aI(a,b)})},bz=function(a){return aF.generate(a)},d8=function(b){var a=d5(b);return bz(a)},cH=function(f,j,q,b){var d=dX(f),h=d.getCellDelta(j),p=d8(f),m=d.getWidths(p,b,d),k=hC(m,q,h,d),g=mO.map(k,function(c,a){return c+m[a]}),v=bL(p,g);mO.each(v,function(a){d.setElementWidth(a.element(),a.width())}),q===p.grid().columns()-1&&d.setTableWidth(f,g,h)},ax=function(f,q,b,j){var d=d8(f),h=eO.getPixelHeights(d,j),p=mO.map(h,function(c,a){return b===a?Math.max(q+c,a4.minHeight()):c}),m=bk(d,p),k=fd(d,p);mO.each(k,function(a){nm.setHeight(a.element(),a.height())}),mO.each(m,function(a){nm.setHeight(a.element(),a.height())});var g,v=(g=p,mO.foldr(g,function(c,a){return c+a},0));nm.setHeight(f,v)},jw=function(k,h,f){var g=dX(k),j=bz(h),d=g.getWidths(j,f,g),c=bL(j,d);mO.each(c,function(a){g.setElementWidth(a.element(),a.width())});var b=mO.foldr(d,function(i,a){return a+i},0);0<c.length&&g.setElementWidth(k,b)},lz=function(a){0===aQ.cells(a).length&&lB.remove(a)},hI=mE.immutable("grid","cursor"),iA=function(c,b,a){return i9(c,b,a).orThunk(function(){return i9(c,0,0)})},i9=function(c,b,a){return lN.from(c[b]).bind(function(d){return lN.from(d.cells()[a]).bind(function(e){return lN.from(e.element())})})},kB=function(c,b,a){return hI(c,i9(c,b,a))},g9=function(a){return mO.foldl(a,function(c,b){return mO.exists(c,function(d){return d.row()===b.row()})?c:c.concat([b])},[]).sort(function(c,b){return c.row()-b.row()})},nA=function(a){return mO.foldl(a,function(c,b){return mO.exists(c,function(d){return d.column()===b.column()})?c:c.concat([b])},[]).sort(function(c,b){return c.column()-b.column()})},my=function(f,c,a){var b=bK(f,a),d=aF.generate(b);return jQ(d,c,!0)},jU=jw,h5={insertRowBefore:aP(function(h,f,c,d){var g=f.row(),b=f.row(),a=iM(h,b,g,c,d.getOrInit);return kB(a,b,f.column())},bJ,lM.noop,lM.noop,dQ),insertRowsBefore:aP(function(k,h,f,g){var j=h[0].row(),d=h[0].row(),c=g9(h),b=mO.foldl(c,function(i,a){return iM(i,d,j,f,g.getOrInit)},k);return kB(b,d,h[0].column())},ek,lM.noop,lM.noop,dQ),insertRowAfter:aP(function(h,f,c,d){var g=f.row(),b=f.row()+f.rowspan(),a=iM(h,b,g,c,d.getOrInit);return kB(a,b,f.column())},bJ,lM.noop,lM.noop,dQ),insertRowsAfter:aP(function(k,h,f,g){var j=g9(h),d=j[j.length-1].row(),c=j[j.length-1].row()+j[j.length-1].rowspan(),b=mO.foldl(j,function(i,a){return iM(i,c,d,f,g.getOrInit)},k);return kB(b,c,h[0].column())},ek,lM.noop,lM.noop,dQ),insertColumnBefore:aP(function(h,f,c,d){var g=f.column(),b=f.column(),a=gv(h,b,g,c,d.getOrInit);return kB(a,f.row(),b)},bJ,jU,lM.noop,dQ),insertColumnsBefore:aP(function(k,h,f,g){var j=nA(h),d=j[0].column(),c=j[0].column(),b=mO.foldl(j,function(i,a){return gv(i,c,d,f,g.getOrInit)},k);return kB(b,h[0].row(),c)},ek,jU,lM.noop,dQ),insertColumnAfter:aP(function(h,f,c,d){var g=f.column(),b=f.column()+f.colspan(),a=gv(h,b,g,c,d.getOrInit);return kB(a,f.row(),b)},bJ,jU,lM.noop,dQ),insertColumnsAfter:aP(function(k,h,f,g){var j=h[h.length-1].column(),d=h[h.length-1].column()+h[h.length-1].colspan(),c=nA(h),b=mO.foldl(c,function(i,a){return gv(i,d,j,f,g.getOrInit)},k);return kB(b,h[0].row(),d)},ek,jU,lM.noop,dQ),splitCellIntoColumns:aP(function(f,c,a,b){var d=mG(f,c.row(),c.column(),a,b.getOrInit);return kB(d,c.row(),c.column())},bJ,jU,lM.noop,dQ),splitCellIntoRows:aP(function(f,c,a,b){var d=fW(f,c.row(),c.column(),a,b.getOrInit);return kB(d,c.row(),c.column())},bJ,lM.noop,lM.noop,dQ),eraseColumns:aP(function(h,f,c,d){var g=nA(f),b=fz(h,g[0].column(),g[g.length-1].column()),a=iA(b,f[0].row(),f[0].column());return hI(b,a)},ek,jU,lz,dQ),eraseRows:aP(function(h,f,c,d){var g=g9(f),b=e0(h,g[0].row(),g[g.length-1].row()),a=iA(b,f[0].row(),f[0].column());return hI(b,a)},ek,lM.noop,lz,dQ),makeColumnHeader:aP(function(f,c,a,b){var d=bY(f,c.column(),a,b.replaceOrInit);return kB(d,c.row(),c.column())},bJ,lM.noop,lM.noop,iF("row","th")),unmakeColumnHeader:aP(function(f,c,a,b){var d=bY(f,c.column(),a,b.replaceOrInit);return kB(d,c.row(),c.column())},bJ,lM.noop,lM.noop,iF(null,"td")),makeRowHeader:aP(function(f,c,a,b){var d=gG(f,c.row(),a,b.replaceOrInit);return kB(d,c.row(),c.column())},bJ,lM.noop,lM.noop,iF("col","th")),unmakeRowHeader:aP(function(f,c,a,b){var d=gG(f,c.row(),a,b.replaceOrInit);return kB(d,c.row(),c.column())},bJ,lM.noop,lM.noop,iF(null,"td")),mergeCells:aP(function(g,d,b,c){var f=d.cells();bG(f);var a=k0(g,d.bounds(),b,lM.constant(f[0]));return hI(a,lN.from(f[0]))},jb,lM.noop,lM.noop,kb),unmergeCells:aP(function(f,c,a,b){var d=mO.foldr(c,function(h,g){return lA(h,g,a,b.combine(g))},f);return hI(d,lN.from(c[0]))},lg,jU,lM.noop,kb),pasteCells:aP(function(f,q,j,b){var d,h,p,m,k=(d=q.clipboard(),h=q.generators(),p=d5(d),m=aF.generate(p),jQ(m,h,!0)),g=mN.address(q.row(),q.column());return kO(g,f,k,q.generators(),j).fold(function(){return hI(f,lN.some(q.element()))},function(c){var a=iA(c,q.row(),q.column());return hI(c,a)})},cO,jU,lM.noop,dQ),pasteRowsBefore:aP(function(f,h,m,b){var d=f[h.cells[0].row()],g=h.cells[0].row(),l=my(h.clipboard(),h.generators(),d),k=kC(g,f,l,h.generators(),m),j=iA(k,h.cells[0].row(),h.cells[0].column());return hI(k,j)},aE,lM.noop,lM.noop,dQ),pasteRowsAfter:aP(function(f,h,m,b){var d=f[h.cells[0].row()],g=h.cells[h.cells.length-1].row()+h.cells[h.cells.length-1].rowspan(),l=my(h.clipboard(),h.generators(),d),k=kC(g,f,l,h.generators(),m),j=iA(k,h.cells[0].row(),h.cells[0].column());return hI(k,j)},aE,lM.noop,lM.noop,dQ)},ld=function(a){return jj.fromDom(a.getBody())},lK=function(a){return a.getBoundingClientRect().width},jI=function(a){return a.getBoundingClientRect().height},kZ=function(a){return function(b){return hE.eq(b,ld(a))}},kN=function(a){return/^[0-9]+$/.test(a)&&(a+="px"),a},iX=function(b){var a=dy.descendants(b,"td[data-mce-style],th[data-mce-style]");cp.remove(b,"data-mce-style"),mO.each(a,function(c){cp.remove(c,"data-mce-style")})},gM=function(a){return"rtl"===gT.get(a,"direction")?"rtl":"ltr"},nd={onDirection:function(b,a){return function(c){return"rtl"===gM(c)?a:b}},getDirection:gM},gh={isRtl:lM.constant(!1)},fp={isRtl:lM.constant(!0)},fQ={directionAt:function(a){return"rtl"===nd.getDirection(a)?fp:gh}},hw=["tableprops","tabledelete","|","tableinsertrowbefore","tableinsertrowafter","tabledeleterow","|","tableinsertcolbefore","tableinsertcolafter","tabledeletecol"],cG={"border-collapse":"collapse",width:"100%"},cv={border:"1"},b8=function(a){return a.getParam("table_cell_advtab",!0,"boolean")},gX=function(a){return a.getParam("table_row_advtab",!0,"boolean")},j5=function(a){return a.getParam("table_advtab",!0,"boolean")},im=function(a){return a.getParam("table_style_by_css",!1,"boolean")},dh=function(a){return a.getParam("table_cell_class_list",[],"array")},dA=function(a){return a.getParam("table_row_class_list",[],"array")},gA=function(a){return a.getParam("table_class_list",[],"array")},c2=function(a){return !1===a.getParam("table_responsive_width")},hT=function(b,a){return b.fire("newrow",{node:a})},eJ=function(b,a){return b.fire("newcell",{node:a})},bj=function(d,c,a,b){d.fire("ObjectResizeStart",{target:c,width:a,height:b})},dL=function(d,c,a,b){d.fire("ObjectResized",{target:c,width:a,height:b})},dW=function(b,h){var g,a=function(e){return"table"===f9.name(ld(e))},d=(g=b.getParam("table_clone_elements"),lZ.isString(g)?lN.some(g.split(/[ ,]/)):Array.isArray(g)?lN.some(g):lN.none()),c=function(i,f,j,e){return function(s,p){iX(s);var l=e(),m=jj.fromDom(b.getDoc()),q=h6(fQ.directionAt),k=hD(j,m,d);return f(s)?i(l,s,p,k,q).bind(function(o){return mO.each(o.newRows(),function(r){hT(b,r.dom())}),mO.each(o.newCells(),function(r){eJ(b,r.dom())}),o.cursor().map(function(t){var r=b.dom.createRng();return r.setStart(t.dom(),0),r.setEnd(t.dom(),0),r})}):lN.none()}};return{deleteRow:c(h5.eraseRows,function(i){var f=c7(i);return !1===a(b)||1<f.rows()},lM.noop,h),deleteColumn:c(h5.eraseColumns,function(i){var f=c7(i);return !1===a(b)||1<f.columns()},lM.noop,h),insertRowsBefore:c(h5.insertRowsBefore,lM.always,lM.noop,h),insertRowsAfter:c(h5.insertRowsAfter,lM.always,lM.noop,h),insertColumnsBefore:c(h5.insertColumnsBefore,lM.always,l2,h),insertColumnsAfter:c(h5.insertColumnsAfter,lM.always,l2,h),mergeCells:c(h5.mergeCells,lM.always,lM.noop,h),unmergeCells:c(h5.unmergeCells,lM.always,lM.noop,h),pasteRowsBefore:c(h5.pasteRowsBefore,lM.always,lM.noop,h),pasteRowsAfter:c(h5.pasteRowsAfter,lM.always,lM.noop,h),pasteCells:c(h5.pasteCells,lM.always,lM.noop,h)}},iL=function(f,c,b){var a=d5(f),d=aF.generate(a);return ek(d,c).map(function(i){var h=jQ(d,b,!1).slice(i[0].row(),i[i.length-1].row()+i[i.length-1].rowspan()),g=d4(h,b);return lG(g)})},kk=tinymce.util.Tools.resolve("tinymce.util.Tools"),aw=function(c,b,a){a&&c.formatter.apply("align"+a,{},b)},eU=function(c,b,a){a&&c.formatter.apply("valign"+a,{},b)},e5=function(b,a){kk.each("left center right".split(" "),function(c){b.formatter.remove("align"+c,{},a)})},f1=function(b,a){kk.each("top middle bottom".split(" "),function(c){b.formatter.remove("valign"+c,{},a)})},bX=function(c,d,a){var b;return b=function(i,h){for(var f=0;f<h.length;f++){var g=c.getStyle(h[f],a);if(void 0===i&&(i=g),i!==g){return""}}return i}(b,c.select("td,th",d))},bF=function(g,d){var b=g.dom,c=d.control.rootControl,f=c.toJSON(),a=b.parseStyle(f.style);"style"===d.control.name()?(c.find("#borderStyle").value(a["border-style"]||"")[0].fire("select"),c.find("#borderColor").value(a["border-color"]||"")[0].fire("change"),c.find("#backgroundColor").value(a["background-color"]||"")[0].fire("change"),c.find("#width").value(a.width||"").fire("change"),c.find("#height").value(a.height||"").fire("change")):(a["border-style"]=f.borderStyle,a["border-color"]=f.borderColor,a["background-color"]=f.backgroundColor,a.width=f.width?kN(f.width):"",a.height=f.height?kN(f.height):""),c.find("#style").value(b.serializeStyle(b.parseStyle(b.serializeStyle(a))))},fE=function(a){var b=function(){var c=a.getParam("color_picker_callback");if(c){return function(d){return c.call(a,function(e){d.control.value(e).fire("change")},d.control.value())}}};return{title:"Advanced",type:"form",defaults:{onchange:lM.curry(bF,a)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:lM.curry(bF,a),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:b()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:b()}]}]}},a3=function(d,a,b){var c=function(f,e){return e=e||[],kk.each(f,function(h){var g={text:h.text||h.title};h.menu?g.menu=c(h.menu):(g.value=h.value,a&&a(g)),e.push(g)}),e};return c(d,b||[])},aS=bF,d7=function(d,c){var a=d.parseStyle(d.getAttrib(c,"style")),b={};return a["border-style"]&&(b.borderStyle=a["border-style"]),a["border-color"]&&(b.borderColor=a["border-color"]),a["background-color"]&&(b.backgroundColor=a["background-color"]),b.style=d.serializeStyle(a),b},bQ=function(f,g,j){var e,d=f.dom;function b(i,c,a){a&&d.setAttrib(i,c,a)}function h(i,c,a){a&&d.setStyle(i,c,a)}aS(f,j),e=j.control.rootControl.toJSON(),f.undoManager.transact(function(){kk.each(g,function(i){var c,a;b(i,"scope",e.scope),1===g.length?b(i,"style",e.style):(c=i,a=e.style,delete c.dataset.mceStyle,c.style.cssText+=";"+a),b(i,"class",e["class"]),h(i,"width",kN(e.width)),h(i,"height",kN(e.height)),e.type&&i.nodeName.toLowerCase()!==e.type&&(i=d.rename(i,e.type)),1===g.length&&(e5(f,i),f1(f,i)),e.align&&aw(f,i,e.align),e.valign&&eU(f,i,e.valign)}),f.focus()})},eq=function(j){var f,q,b,d=[];if(d=j.dom.select("td[data-mce-selected],th[data-mce-selected]"),f=j.dom.getParent(j.selection.getStart(),"td,th"),!d.length&&f&&d.push(f),f=f||d[0]){var h,p,m,k;1<d.length?q={width:"",height:"",scope:"","class":"",align:"",valign:"",style:"",type:f.nodeName.toLowerCase()}:(p=f,m=(h=j).dom,k={width:m.getStyle(p,"width")||m.getAttrib(p,"width"),height:m.getStyle(p,"height")||m.getAttrib(p,"height"),scope:m.getAttrib(p,"scope"),"class":m.getAttrib(p,"class"),type:p.nodeName.toLowerCase(),style:"",align:"",valign:""},kk.each("left center right".split(" "),function(a){h.formatter.matchNode(p,"align"+a)&&(k.align=a)}),kk.each("top middle bottom".split(" "),function(a){h.formatter.matchNode(p,"valign"+a)&&(k.valign=a)}),b8(h)&&kk.extend(k,d7(m,p)),q=k),0<dh(j).length&&(b={name:"class",type:"listbox",label:"Class",values:a3(dh(j),function(a){a.value&&(a.textStyle=function(){return j.formatter.getCssText({block:"td",classes:[a.value]})})})});var g={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:lM.curry(aS,j)},{label:"Height",name:"height",onchange:lM.curry(aS,j)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},b]};b8(j)?j.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:q,body:[{title:"General",type:"form",items:g},fE(j)],onsubmit:lM.curry(bQ,j,d)}):j.windowManager.open({title:"Cell properties",data:q,body:g,onsubmit:lM.curry(bQ,j,d)})}};function cR(b,k,h,i){var j=b.dom;function a(g,f,d){d&&j.setAttrib(g,f,d)}aS(b,i);var c=i.control.rootControl.toJSON();b.undoManager.transact(function(){kk.each(k,function(g){var q,x,d,f,p,w,v,s,m;a(g,"scope",c.scope),a(g,"style",c.style),a(g,"class",c["class"]),q=g,x="height",(d=kN(c.height))&&j.setStyle(q,x,d),c.type!==g.parentNode.nodeName.toLowerCase()&&(f=b.dom,p=g,w=c.type,v=f.getParent(p,"table"),s=p.parentNode,(m=f.select(w,v)[0])||(m=f.create(w),v.firstChild?"CAPTION"===v.firstChild.nodeName?f.insertAfter(m,v.firstChild):v.insertBefore(m,v.firstChild):v.appendChild(m)),m.appendChild(p),s.hasChildNodes()||f.remove(s)),c.align!==h.align&&(e5(b,g),aw(b,g,c.align))}),b.focus()})}var aH=function(p){var h,y,b,g,k,x,w,v,j,z,m=p.dom,q=[];h=m.getParent(p.selection.getStart(),"table"),y=m.getParent(p.selection.getStart(),"td,th"),kk.each(h.rows,function(a){kk.each(a.cells,function(c){if(m.getAttrib(c,"data-mce-selected")||c===y){return q.push(a),!1}})}),(b=q[0])&&(1<q.length?k={height:"",scope:"",style:"","class":"",align:"",type:b.parentNode.nodeName.toLowerCase()}:(v=b,j=(w=p).dom,z={height:j.getStyle(v,"height")||j.getAttrib(v,"height"),scope:j.getAttrib(v,"scope"),"class":j.getAttrib(v,"class"),align:"",style:"",type:v.parentNode.nodeName.toLowerCase()},kk.each("left center right".split(" "),function(a){w.formatter.matchNode(v,"align"+a)&&(z.align=a)}),gX(w)&&kk.extend(z,d7(j,v)),k=z),0<dA(p).length&&(g={name:"class",type:"listbox",label:"Class",values:a3(dA(p),function(a){a.value&&(a.textStyle=function(){return p.formatter.getCssText({block:"tr",classes:[a.value]})})})}),x={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},g]},gX(p)?p.windowManager.open({title:"Row properties",data:k,bodyType:"tabpanel",body:[{title:"General",type:"form",items:x},fE(p)],onsubmit:lM.curry(cR,p,q,k)}):p.windowManager.open({title:"Row properties",data:k,body:x,onsubmit:lM.curry(cR,p,q,k)}))},jv=tinymce.util.Tools.resolve("tinymce.Env"),ly={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},hH=function(g,m,w,b,d){void 0===d&&(d=ly);var j=jj.fromTag("table");gT.setAll(j,d.styles),cp.setAll(j,d.attributes);var v=jj.fromTag("tbody");jK.append(j,v);for(var q=[],p=0;p<g;p++){for(var h=jj.fromTag("tr"),x=0;x<m;x++){var k=p<w||x<b?jj.fromTag("th"):jj.fromTag("td");x<b&&cp.set(k,"scope","row"),p<w&&cp.set(k,"scope","col"),jK.append(k,jj.fromTag("br")),d.percentages&&gT.set(k,"width",100/m+"%"),jK.append(h,k)}q.push(h)}return hP.append(v,q),j},iz=function(a){return a.dom().innerHTML},i8=function(c){var b=jj.fromTag("div"),a=jj.fromDom(c.dom().cloneNode(!0));return jK.append(b,a),iz(b)},kA=function(b,a){b.selection.select(a.dom(),!0),b.selection.collapse(!0)},g8=function(g,f,h){var m,b,d=g.getParam("table_default_styles",cG,"object"),l={styles:d,attributes:(b=g,b.getParam("table_default_attributes",cv,"object")),percentages:(m=d.width,lZ.isString(m)&&-1!==m.indexOf("%")&&!c2(g))},k=hH(h,f,0,0,l);cp.set(k,"data-mce-id","__mce");var j=i8(k);return g.insertContent(j),eZ.descendant(ld(g),'table[data-mce-id="__mce"]').map(function(q){var i,a,c,p;return c2(g)&&gT.set(q,"width",gT.get(q,"width")),cp.remove(q,"data-mce-id"),i=g,a=q,mO.each(dy.descendants(a,"tr"),function(e){hT(i,e.dom()),mO.each(dy.descendants(e,"th,td"),function(o){eJ(i,o.dom())})}),c=g,p=q,eZ.descendant(p,"td,th").each(lM.curry(kA,c)),q.dom()}).getOr(null)};function nz(f,c,a,b){if("TD"===c.tagName||"TH"===c.tagName){f.setStyle(c,a,b)}else{if(c.children){for(var d=0;d<c.children.length;d++){nz(f,c.children[d],a,b)}}}}var mw=function(g,d,b){var c,f,a=g.dom;aS(g,b),!1===(f=b.control.rootControl.toJSON())["class"]&&delete f["class"],g.undoManager.transact(function(){d||(d=g8(g,f.cols||1,f.rows||1)),function(s,p,l){var m,q=s.dom,k={},j={};if(k["class"]=l["class"],j.height=kN(l.height),q.getAttrib(p,"width")&&!im(s)?k.width=(m=l.width)?m.replace(/px$/,""):"":j.width=kN(l.width),im(s)?(j["border-width"]=kN(l.border),j["border-spacing"]=kN(l.cellspacing),kk.extend(k,{"data-mce-border-color":l.borderColor,"data-mce-cell-padding":l.cellpadding,"data-mce-border":l.border})):kk.extend(k,{border:l.border,cellpadding:l.cellpadding,cellspacing:l.cellspacing}),im(s)&&p.children){for(var h=0;h<p.children.length;h++){nz(q,p.children[h],{"border-width":kN(l.border),"border-color":l.borderColor,padding:kN(l.cellpadding)})}}l.style?kk.extend(j,q.parseStyle(l.style)):j=kk.extend({},q.parseStyle(q.getAttrib(p,"style")),j),k.style=q.serializeStyle(j),q.setAttribs(p,k)}(g,d,f),(c=a.select("caption",d)[0])&&!f.caption&&a.remove(c),!c&&f.caption&&((c=a.create("caption")).innerHTML=jv.ie?"\xa0":'<br data-mce-bogus="1"/>',d.insertBefore(c,d.firstChild)),e5(g,d),f.align&&aw(g,d,f.align),g.focus(),g.addVisual()})},jT=function(v,h){var A,b,g,p,z,y,x,k,B,q,w=v.dom,j={};!0===h?(A=w.getParent(v.selection.getStart(),"table"))&&(x=A,k=(y=v).dom,B={width:k.getStyle(x,"width")||k.getAttrib(x,"width"),height:k.getStyle(x,"height")||k.getAttrib(x,"height"),cellspacing:k.getStyle(x,"border-spacing")||k.getAttrib(x,"cellspacing"),cellpadding:k.getAttrib(x,"data-mce-cell-padding")||k.getAttrib(x,"cellpadding")||bX(y.dom,x,"padding"),border:k.getAttrib(x,"data-mce-border")||k.getAttrib(x,"border")||bX(y.dom,x,"border"),borderColor:k.getAttrib(x,"data-mce-border-color"),caption:!!k.select("caption",x)[0],"class":k.getAttrib(x,"class")},kk.each("left center right".split(" "),function(a){y.formatter.matchNode(x,"align"+a)&&(B.align=a)}),j5(y)&&kk.extend(B,d7(k,x)),j=B):(b={label:"Cols",name:"cols"},g={label:"Rows",name:"rows"}),0<gA(v).length&&(j["class"]&&(j["class"]=j["class"].replace(/\s*mce\-item\-table\s*/g,"")),p={name:"class",type:"listbox",label:"Class",values:a3(gA(v),function(a){a.value&&(a.textStyle=function(){return v.formatter.getCssText({block:"table",classes:[a.value]})})})}),z={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:(q=v,q.getParam("table_appearance_options",!0,"boolean")?[b,g,{label:"Width",name:"width",onchange:lM.curry(aS,v)},{label:"Height",name:"height",onchange:lM.curry(aS,v)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[b,g,{label:"Width",name:"width",onchange:lM.curry(aS,v)},{label:"Height",name:"height",onchange:lM.curry(aS,v)}])},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},p]},j5(v)?v.windowManager.open({title:"Table properties",data:j,bodyType:"tabpanel",body:[{title:"General",type:"form",items:z},fE(v)],onsubmit:lM.curry(mw,v,A)}):v.windowManager.open({title:"Table properties",data:j,body:z,onsubmit:lM.curry(mw,v,A)})},h4=kk.each,lb=function(q,m,p,h,w){var b=kZ(q),x=function(){return jj.fromDom(q.dom.getParent(q.selection.getStart(),"th,td"))},k=function(a){return aQ.table(a,b)},n=function(a){return{width:lK(a.dom()),height:lK(a.dom())}},g=function(c){var a=x();k(a).each(function(e){var f=ah.forMenu(h,e,a),d=n(e);c(e,f).each(function(y){var s,i,l,u;s=q,i=d,u=n(l=e),i.width===u.width&&i.height===u.height||(bj(s,l.dom(),i.width,i.height),dL(s,l.dom(),u.width,u.height)),q.selection.setRng(y),q.focus(),p.clear(e),iX(e)})})},j=function(c){var a=x();return k(a).bind(function(l){var i=jj.fromDom(q.getDoc()),d=ah.forMenu(h,l,a),f=hD(lM.noop,i,lN.none());return iL(l,d,f)})},v=function(a){w.get().each(function(e){var d=mO.map(e,function(f){return fX(f)}),c=x();k(c).bind(function(l){var o=jj.fromDom(q.getDoc()),f=ew(o),i=ah.pasteRows(h,l,c,d,f);a(l,i).each(function(r){q.selection.setRng(r),q.focus(),p.clear(l)})})})};h4({mceTableSplitCells:function(){g(m.unmergeCells)},mceTableMergeCells:function(){g(m.mergeCells)},mceTableInsertRowBefore:function(){g(m.insertRowsBefore)},mceTableInsertRowAfter:function(){g(m.insertRowsAfter)},mceTableInsertColBefore:function(){g(m.insertColumnsBefore)},mceTableInsertColAfter:function(){g(m.insertColumnsAfter)},mceTableDeleteCol:function(){g(m.deleteColumn)},mceTableDeleteRow:function(){g(m.deleteRow)},mceTableCutRow:function(a){w.set(j()),g(m.deleteRow)},mceTableCopyRow:function(a){w.set(j())},mceTablePasteRowBefore:function(a){v(m.pasteRowsBefore)},mceTablePasteRowAfter:function(a){v(m.pasteRowsAfter)},mceTableDelete:function(){var a=jj.fromDom(q.dom.getParent(q.selection.getStart(),"th,td"));aQ.table(a,b).filter(lM.not(b)).each(function(f){var d=jj.fromText("");jK.after(f,d),lB.remove(f);var c=q.dom.createRng();c.setStart(d.dom(),0),c.setEnd(d.dom(),0),q.selection.setRng(c)})}},function(c,a){q.addCommand(a,c)}),h4({mceInsertTable:lM.curry(jT,q),mceTableProps:lM.curry(jT,q,!0),mceTableRowProps:lM.curry(aH,q),mceTableCellProps:lM.curry(eq,q)},function(a,c){q.addCommand(c,function(f,d){a(d)})})},lJ=function(b){var a=lN.from(b.dom().documentElement).map(jj.fromDom).getOr(b);return{parent:lM.constant(a),view:lM.constant(b),origin:lM.constant(k4(0,0))}},jH=function(b,a){return{parent:lM.constant(a),view:lM.constant(b),origin:lM.constant(k4(0,0))}};function kY(c){var a=mE.immutable.apply(null,c),b=[];return{bind:function(d){if(d===undefined){throw"Event bind error: undefined handler"}b.push(d)},unbind:function(d){b=mO.filter(b,function(e){return e!==d})},trigger:function(){var d=a.apply(null,arguments);mO.each(b,function(e){e(d)})}}}var kM={create:function(a){return{registry:lX.map(a,function(b){return{bind:b.bind,unbind:b.unbind}}),trigger:lX.map(a,function(b){return b.trigger})}}},iW={mode:ez.exactly(["compare","extract","mutate","sink"]),sink:ez.exactly(["element","start","stop","destroy"]),api:ez.exactly(["forceDrop","drop","move","delayDrop"])},gL={resolve:fI("ephox-dragster").resolve},m8=function(a,b){return function(j){if(a(j)){var q,z,g,h,m,y,x,w=jj.fromDom(j.target),k=function(){j.stopPropagation()},A=function(){j.preventDefault()},p=lM.compose(A,k),v=(q=w,z=j.clientX,g=j.clientY,h=k,m=A,y=p,x=j,{target:lM.constant(q),x:lM.constant(z),y:lM.constant(g),stop:h,prevent:m,kill:y,raw:lM.constant(x)});b(v)}}},gg=function(g,d,b,c,f){var a=m8(b,c);return g.dom().addEventListener(d,a,f),{unbind:lM.curry(fm,g,d,a,f)}},fm=function(d,c,a,b){d.dom().removeEventListener(c,a,b)},fP=function(d,c,a,b){return gg(d,c,a,b,!1)},hq=function(d,c,a,b){return gg(d,c,a,b,!0)},cF=lM.constant(!0),cq={bind:function(c,b,a){return fP(c,b,cF,a)},capture:function(c,b,a){return hq(c,b,cF,a)}},b7=iW.mode({compare:function(b,a){return k4(a.left()-b.left(),a.top()-b.top())},extract:function(a){return lN.some(k4(a.x(),a.y()))},sink:function(f,j){var q,b,d,h=(q=j,b=jm.merge({layerClass:gL.resolve("blocker")},q),d=jj.fromTag("div"),cp.set(d,"role","presentation"),gT.setAll(d,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),dI.add(d,gL.resolve("blocker")),dI.add(d,b.layerClass),{element:function(){return d},destroy:function(){lB.remove(d)}}),p=cq.bind(h.element(),"mousedown",f.forceDrop),m=cq.bind(h.element(),"mouseup",f.drop),k=cq.bind(h.element(),"mousemove",f.move),g=cq.bind(h.element(),"mouseout",f.delayDrop);return iW.sink({element:h.element,start:function(a){jK.append(a,h.element())},stop:function(){lB.remove(h.element())},destroy:function(){h.destroy(),m.unbind(),k.unbind(),g.unbind(),p.unbind()}})},mutate:function(b,a){b.mutate(a.left(),a.top())}});function gV(){var b=lN.none(),a=kM.create({move:kY(["info"])});return{onEvent:function(d,c){c.extract(d).each(function(i){var h,f,g;(h=c,f=i,g=b.map(function(e){return h.compare(e,f)}),b=lN.some(f),g).each(function(e){a.trigger.move(e)})})},reset:function(){b=lN.none()},events:a.registry}}function j4(){var c={onEvent:function(f,d){},reset:lM.noop},b=gV(),a=c;return{on:function(){a.reset(),a=b},off:function(){a.reset(),a=c},isOn:function(){return a===b},onEvent:function(f,d){a.onEvent(f,d)},events:b.events}}var ij=function(c,a){var b=null;return{cancel:function(){null!==b&&(clearTimeout(b),b=null)},throttle:function(){var d=arguments;null!==b&&clearTimeout(b),b=setTimeout(function(){c.apply(null,d),d=b=null},a)}}},dg=function(j,q,f){var b=!1,d=kM.create({start:kY([]),stop:kY([])}),h=j4(),p=function(){g.stop(),h.isOn()&&(h.off(),d.trigger.stop())},m=ij(p,200);h.events.move.bind(function(a){q.mutate(j,a.info())});var k=function(a){return function(){var c=Array.prototype.slice.call(arguments,0);if(b){return a.apply(null,c)}}},g=q.sink(iW.api({forceDrop:p,drop:k(p),move:k(function(c,a){m.cancel(),h.onEvent(c,q)}),delayDrop:k(m.throttle)}),f);return{element:g.element,go:function(a){g.start(a),h.on(),d.trigger.start()},on:function(){b=!0},off:function(){b=!1},destroy:function(){g.destroy()},events:d.registry}},dz={transform:function(d,c){var a=c!==undefined?c:{},b=a.mode!==undefined?a.mode:b7;return dg(d,b,c)}};function gy(){var a,b=kM.create({drag:kY(["xDelta","yDelta","target"])}),c=lN.none(),d={mutate:function(g,f){a.trigger.drag(g,f)},events:(a=kM.create({drag:kY(["xDelta","yDelta"])})).registry};return d.events.drag.bind(function(f){c.each(function(e){b.trigger.drag(f.xDelta(),f.yDelta(),e)})}),{assign:function(e){c=lN.some(e)},get:function(){return c},mutate:d.mutate,events:b.registry}}var c1={any:function(a){return eZ.first(a).isSome()},ancestor:function(c,b,a){return eZ.ancestor(c,b,a).isSome()},sibling:function(b,a){return eZ.sibling(b,a).isSome()},child:function(b,a){return eZ.child(b,a).isSome()},descendant:function(b,a){return eZ.descendant(b,a).isSome()},closest:function(c,b,a){return eZ.closest(c,b,a).isSome()}},hR=hh.resolve("resizer-bar-dragging");function eH(f,a){var b=gN.height,c=function(h,q,m){var z=gy(),g=dz.transform(z,{}),y=lN.none(),j=function(l,i){return lN.from(cp.get(l,i))};z.events.drag.bind(function(e){j(e.target(),"data-row").each(function(l){var i=a4.getInt(e.target(),"top");gT.set(e.target(),"top",i+e.yDelta()+"px")}),j(e.target(),"data-column").each(function(l){var i=a4.getInt(e.target(),"left");gT.set(e.target(),"left",i+e.xDelta()+"px")})});var x=function(l,i){return a4.getInt(l,i)-parseInt(cp.get(l,"data-initial-"+i),10)};g.events.stop.bind(function(){z.get().each(function(e){y.each(function(i){j(e,"data-row").each(function(o){var l=x(e,"top");cp.remove(e,"data-initial-top"),v.trigger.adjustHeight(i,l,parseInt(o,10))}),j(e,"data-column").each(function(o){var l=x(e,"left");cp.remove(e,"data-initial-left"),v.trigger.adjustWidth(i,l,parseInt(o,10))}),bU.refresh(h,i,m,q)})})});var w=function(l,i){v.trigger.startAdjust(),z.assign(l),cp.set(l,"data-initial-"+i,parseInt(gT.get(l,i),10)),dI.add(l,hR),gT.set(l,"opacity","0.2"),g.go(h.parent())},k=cq.bind(h.parent(),"mousedown",function(e){bU.isRowBar(e.target())&&w(e.target(),"top"),bU.isColBar(e.target())&&w(e.target(),"left")}),A=function(e){return hE.eq(e,h.view())},p=cq.bind(h.view(),"mouseover",function(e){"table"===f9.name(e.target())||c1.closest(e.target(),"table",A)?(y="table"===f9.name(e.target())?lN.some(e.target()):eZ.ancestor(e.target(),"table",A)).each(function(i){bU.refresh(h,i,m,q)}):j3.inBody(e.target())&&bU.destroy(h)}),v=kM.create({adjustHeight:kY(["table","delta","row"]),adjustWidth:kY(["table","delta","column"]),startAdjust:kY([])});return{destroy:function(){k.unbind(),p.unbind(),g.destroy(),bU.destroy(h)},refresh:function(e){bU.refresh(h,e,m,q)},on:g.on,off:g.off,hideBars:lM.curry(bU.hide,h),showBars:lM.curry(bU.show,h),events:v.registry}}(f,a,b),d=kM.create({beforeResize:kY(["table"]),afterResize:kY(["table"]),startDrag:kY([])});return c.events.adjustHeight.bind(function(h){d.trigger.beforeResize(h.table());var g=b.delta(h.delta(),h.table());ax(h.table(),g,h.row(),b),d.trigger.afterResize(h.table())}),c.events.startAdjust.bind(function(e){d.trigger.startDrag()}),c.events.adjustWidth.bind(function(h){d.trigger.beforeResize(h.table());var g=a.delta(h.delta(),h.table());cH(h.table(),g,h.column(),a),d.trigger.afterResize(h.table())}),{on:c.on,off:c.off,hideBars:c.hideBars,showBars:c.showBars,destroy:c.destroy,events:d.registry}}var bh=function(c,b){return c.inline?jH(ld(c),(a=jj.fromTag("div"),gT.setAll(a,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),jK.append(j3.body(),a),a)):lJ(jj.fromDom(c.getDoc()));var a},dK=function(b,a){b.inline&&lB.remove(a.parent())},dV=function(e){var d,m,k=lN.none(),g=lN.none(),b=lN.none(),h=/(\d+(\.\d+)?)%/,j=function(a){return"TABLE"===a.nodeName};return e.on("init",function(){var i,f=h6(fQ.directionAt),a=bh(e);if(b=lN.some(a),("table"===(i=e.getParam("object_resizing",!0))||i)&&e.getParam("table_resize_bars",!0,"boolean")){var c=eH(a,f);c.on(),c.events.startDrag.bind(function(l){k=lN.some(e.selection.getRng())}),c.events.beforeResize.bind(function(o){var l=o.table().dom();bj(e,l,lK(l),jI(l))}),c.events.afterResize.bind(function(p){var o=p.table(),l=o.dom();iX(o),k.each(function(q){e.selection.setRng(q),e.focus()}),dL(e,l,lK(l),jI(l)),e.undoManager.add()}),g=lN.some(c)}}),e.on("ObjectResizeStart",function(f){var c,a=f.target;j(a)&&(d=f.width,c=a,m=e.dom.getStyle(c,"width")||e.dom.getAttrib(c,"width"))}),e.on("ObjectResized",function(q){var l=q.target;if(j(l)){var c=l;if(h.test(m)){var f=parseFloat(h.exec(m)[1]),p=q.width*f/d;e.dom.setStyle(c,"width",p+"%")}else{var a=[];kk.each(c.rows,function(i){kk.each(i.cells,function(r){var o=e.dom.getStyle(r,"width",!0);a.push({cell:r,width:o})})}),kk.each(a,function(i){e.dom.setStyle(i.cell,"width",i.width),e.dom.setAttrib(i.cell,"width",null)})}}}),{lazyResize:function(){return g},lazyWire:function(){return b.getOr(lJ(jj.fromDom(e.getBody())))},destroy:function(){g.each(function(a){a.destroy()}),b.each(function(a){dK(e,a)})}}},iK=function(a){return{fold:a}},kj=function(a){return iK(function(f,d,b,c){return f(a)})},av=function(a){return iK(function(f,d,b,c){return d(a)})},eT=function(b,a){return iK(function(g,f,c,d){return c(b,a)})},e3=function(a){return iK(function(f,d,b,c){return c(a)})},fZ=function(a,b){return aQ.table(a,b).bind(function(d){var c=aQ.cells(d);return mO.findIndex(c,function(e){return hE.eq(a,e)}).map(function(e){return{index:lM.constant(e),all:lM.constant(c)}})})},bW=function(a,b){return fZ(a,b).fold(function(){return kj(a)},function(c){return c.index()+1<c.all().length?eT(a,c.all()[c.index()+1]):e3(a)})},bE=function(a,b){return fZ(a,b).fold(function(){return kj()},function(c){return 0<=c.index()-1?eT(a,c.all()[c.index()-1]):av(a)})},fC=gd([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),a2={before:fC.before,on:fC.on,after:fC.after,cata:function(d,c,a,b){return d.fold(c,a,b)},getStart:function(a){return a.fold(lM.identity,lM.identity,lM.identity)}},aR=gd([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),d6=mE.immutable("start","soffset","finish","foffset"),bO={domRange:aR.domRange,relative:aR.relative,exact:aR.exact,exactFromRange:function(a){return aR.exact(a.start(),a.soffset(),a.finish(),a.foffset())},range:d6,getWin:function(b){var a=b.match({domRange:function(c){return jj.fromDom(c.startContainer)},relative:function(d,c){return a2.getStart(d)},exact:function(g,f,c,d){return g}});return h1.defaultView(a)}},ep=function(f,c,a,b){var d=h1.owner(f).dom().createRange();return d.setStart(f.dom(),c),d.setEnd(a.dom(),b),d},cQ=function(g,d,b,c){var f=ep(g,d,b,c),a=hE.eq(g,b)&&d===c;return f.collapsed&&!a},aG=function(b,a){b.selectNodeContents(a.dom())},jk=function(a){a.deleteContents()},lq=function(a){return{left:lM.constant(a.left),top:lM.constant(a.top),right:lM.constant(a.right),bottom:lM.constant(a.bottom),width:lM.constant(a.width),height:lM.constant(a.height)}},hz={create:function(a){return a.document.createRange()},replaceWith:function(b,a){jk(b),b.insertNode(a.dom())},selectNodeContents:function(c,b){var a=c.document.createRange();return aG(a,b),a},selectNodeContentsUsing:aG,relativeToNative:function(g,d,b){var c,f,a=g.document.createRange();return c=a,d.fold(function(e){c.setStartBefore(e.dom())},function(i,h){c.setStart(i.dom(),h)},function(e){c.setStartAfter(e.dom())}),f=a,b.fold(function(e){f.setEndBefore(e.dom())},function(i,h){f.setEnd(i.dom(),h)},function(e){f.setEndAfter(e.dom())}),a},exactToNative:function(g,d,b,c,f){var a=g.document.createRange();return a.setStart(d.dom(),b),a.setEnd(c.dom(),f),a},deleteContents:jk,cloneFragment:function(b){var a=b.cloneContents();return jj.fromDom(a)},getFirstRect:function(c){var b=c.getClientRects(),a=0<b.length?b[0]:c.getBoundingClientRect();return 0<a.width||0<a.height?lN.some(a).map(lq):lN.none()},getBounds:function(b){var a=b.getBoundingClientRect();return 0<a.width||0<a.height?lN.some(a).map(lq):lN.none()},isWithin:function(b,a){return a.compareBoundaryPoints(b.END_TO_START,b)<1&&-1<a.compareBoundaryPoints(b.START_TO_END,b)},toString:function(a){return a.toString()}},iv=gd([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),i4=function(c,b,a){return b(jj.fromDom(a.startContainer),a.startOffset,jj.fromDom(a.endContainer),a.endOffset)},kx=function(g,d){var f,b,c,a=(f=g,d.match({domRange:function(e){return{ltr:lM.constant(e),rtl:lN.none}},relative:function(i,h){return{ltr:mS(function(){return hz.relativeToNative(f,i,h)}),rtl:mS(function(){return lN.some(hz.relativeToNative(f,h,i))})}},exact:function(k,j,h,i){return{ltr:mS(function(){return hz.exactToNative(f,k,j,h,i)}),rtl:mS(function(){return lN.some(hz.exactToNative(f,h,i,k,j))})}}}));return(c=(b=a).ltr()).collapsed?b.rtl().filter(function(e){return !1===e.collapsed}).map(function(e){return iv.rtl(jj.fromDom(e.endContainer),e.endOffset,jj.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return i4(0,iv.ltr,c)}):i4(0,iv.ltr,c)},g0={ltr:iv.ltr,rtl:iv.rtl,diagnose:kx,asLtrRange:function(a,b){return kx(a,b).match({ltr:function(h,f,c,d){var g=a.document.createRange();return g.setStart(h.dom(),f),g.setEnd(c.dom(),d),g},rtl:function(h,f,c,d){var g=a.document.createRange();return g.setStart(c.dom(),d),g.setEnd(h.dom(),f),g}})}},nq=function(c,b,a){return b>=c.left&&b<=c.right&&a>=c.top&&a<=c.bottom},l7=function(f,h,m,b,d){if(0===d){return 0}if(h===b){return d-1}for(var g=b,l=1;l<d;l++){var k=f(l),j=Math.abs(h-k.left);if(m>k.bottom){}else{if(m<k.top||g<j){return l-1}g=j}}return 0},jP={locate:function(a,b,c,h){var i=a.dom().createRange();i.selectNode(b.dom());var g=i.getClientRects();return hA(g,function(d){return nq(d,c,h)?lN.some(d):lN.none()}).map(function(j){return s=a,l=c,f=h,k=j,q=function(r){var o=s.dom().createRange();return o.setStart(d.dom(),r),o.collapse(!0),o},p=g4.get(d=b).length,m=l7(function(e){return q(e).getBoundingClientRect()},l,f,k.right,p),q(m);var s,d,l,f,k,q,p,m})}},hW=function(d,g,b,c){var f=d.dom().createRange(),a=h1.children(g);return hA(a,function(e){return f.selectNode(e.dom()),nq(f.getBoundingClientRect(),b,c)?k6(d,e,b,c):lN.none()})},k6=function(d,c,a,b){return(f9.isText(c)?jP.locate:hW)(d,c,a,b)},lF=function(k,h,f,g){var j=k.dom().createRange();j.selectNode(h.dom());var d=j.getBoundingClientRect(),c=Math.max(d.left,Math.min(d.right,f)),b=Math.max(d.top,Math.min(d.bottom,g));return k6(k,h,c,b)},jD=function(b,a){return a-b.left<b.right-a},kU=function(d,c,a){var b=d.dom().createRange();return b.selectNode(c.dom()),b.collapse(a),b},kI=function(d,g,b){var c=d.dom().createRange();c.selectNode(g.dom());var f=c.getBoundingClientRect(),a=jD(f,b);return(!0===a?h0.first:h0.last)(g).map(function(e){return kU(d,e,a)})},iS=function(f,c,a){var b=c.dom().getBoundingClientRect(),d=jD(b,a);return lN.some(kU(f,c,d))},gD=function(c,b,a){return(0===h1.children(b).length?iS:kI)(c,b,a)},mV=document.caretPositionFromPoint?function(a,c,b){return lN.from(a.dom().caretPositionFromPoint(c,b)).bind(function(f){if(null===f.offsetNode){return lN.none()}var d=a.dom().createRange();return d.setStart(f.offsetNode,f.offset),d.collapse(),lN.some(d)})}:document.caretRangeFromPoint?function(c,b,a){return lN.from(c.dom().caretRangeFromPoint(b,a))}:function(a,b,c){return jj.fromPoint(a,b,c).bind(function(f){var d=function(){return gD(a,f,b)};return 0===h1.children(f).length?d():function(q,m,k,l){var p=q.dom().createRange();p.selectNode(m.dom());var j=p.getBoundingClientRect(),h=Math.max(j.left,Math.min(j.right,k)),g=Math.max(j.top,Math.min(j.bottom,l));return lF(q,m,h,g)}(a,f,b,c).orThunk(d)})},f4=function(d,c,a){var b=jj.fromDom(d.document);return mV(b,c,a).map(function(e){return bO.range(jj.fromDom(e.startContainer),e.startOffset,jj.fromDom(e.endContainer),e.endOffset)})},e8=function(c,b){var a=f9.name(c);return"input"===a?a2.after(c):mO.contains(["br","img"],a)?0===b?a2.before(c):a2.after(c):a2.on(c,b)},fH=function(d,c){var a=d.fold(a2.before,e8,a2.after),b=c.fold(a2.before,e8,a2.after);return bO.relative(a,b)},hg=function(g,d,b,c){var f=e8(g,d),a=e8(b,c);return bO.relative(f,a)},cC=function(a){return a.match({domRange:function(d){var c=jj.fromDom(d.startContainer),b=jj.fromDom(d.endContainer);return hg(c,d.startOffset,b,d.endOffset)},relative:fH,exact:hg})},ck=fH,b4=hg,gP=function(b,a){lN.from(b.getSelection()).each(function(c){c.removeAllRanges(),c.addRange(a)})},j1=function(g,d,b,c,f){var a=hz.exactToNative(g,d,b,c,f);gP(g,a)},h8=function(a,b){return g0.diagnose(a,b).match({ltr:function(g,f,c,d){j1(a,g,f,c,d)},rtl:function(h,f,c,d){var g=a.getSelection();g.setBaseAndExtent?g.setBaseAndExtent(h.dom(),f,c.dom(),d):g.extend?(g.collapse(h.dom(),f),g.extend(c.dom(),d)):j1(a,c,d,h,f)}})},c9=function(c){var b=jj.fromDom(c.anchorNode),a=jj.fromDom(c.focusNode);return cQ(b,c.anchorOffset,a,c.focusOffset)?lN.some(bO.range(jj.fromDom(c.anchorNode),c.anchorOffset,jj.fromDom(c.focusNode),c.focusOffset)):function(g){if(0<g.rangeCount){var f=g.getRangeAt(0),d=g.getRangeAt(g.rangeCount-1);return lN.some(bO.range(jj.fromDom(f.startContainer),f.startOffset,jj.fromDom(d.endContainer),d.endOffset))}return lN.none()}(c)},dw=function(a){return lN.from(a.getSelection()).filter(function(b){return 0<b.rangeCount}).bind(c9)},gm=function(g,d,b,c,f){var a=b4(d,b,c,f);h8(g,a)},cY=function(a){return dw(a).map(function(b){return bO.exact(b.start(),b.soffset(),b.finish(),b.foffset())})},hL=function(d,c,a){var b=ck(c,a);h8(d,b)},eB=function(d){var c=bO.getWin(d).dom(),b=function(i,h,f,g){return hz.exactToNative(c,i,h,f,g)},a=cC(d);return g0.diagnose(c,a).match({ltr:b,rtl:b})},bb=function(c,b){var a=hz.selectNodeContents(c,b);gP(c,a)},dH=function(a){a.getSelection().removeAllRanges()},dS=function(c,b){var a=g0.asLtrRange(c,b);return hz.getFirstRect(a)},iH=function(c,b,a){return f4(c,b,a)},kf=tinymce.util.Tools.resolve("tinymce.util.VK"),am=function(d,c,a,b){return fT(d,c,bW(a),b)},eM=function(d,c,a,b){return fT(d,c,bE(a),b)},eX=function(c,b){var a=bO.exact(b,0,b,0);return eB(a)},fT=function(d,f,c,b,a){return c.fold(lN.none,lN.none,function(h,g){return h0.first(g).map(function(e){return eX(0,e)})},function(e){return aQ.table(e,f).bind(function(i){var h,g=ah.noMenu(e);return d.undoManager.transact(function(){b.insertRowsAfter(i,g)}),h=dy.descendants(i,"tr"),mO.last(h).bind(function(j){return eZ.descendant(j,"td,th").map(function(k){return eX(0,k)})})})})},bT=["table","li","dl"],bx=function(h,f,g,j){if(h.keyCode===kf.TAB){var d=ld(f),c=function(i){var a=f9.name(i);return hE.eq(i,d)||mO.contains(bT,a)},k=f.selection.getRng();if(k.collapsed){var b=jj.fromDom(k.startContainer);aQ.cell(b,c).each(function(a){h.preventDefault(),(h.shiftKey?eM:am)(f,c,a,g,j).each(function(e){f.selection.setRng(e)})})}}},fw={response:mE.immutable("selection","kill")},aZ=function(a){return function(b){return b===a}},aO=aZ(38),d3=aZ(40),bI={ltr:{isBackward:aZ(37),isForward:aZ(39)},rtl:{isBackward:aZ(39),isForward:aZ(37)},isUp:aO,isDown:d3,isNavigation:function(a){return 37<=a&&a<=40}},ej=function(c,b){var a=g0.asLtrRange(c,b);return{start:lM.constant(jj.fromDom(a.startContainer)),soffset:lM.constant(a.startOffset),finish:lM.constant(jj.fromDom(a.endContainer)),foffset:lM.constant(a.endOffset)}},cN=function(d,c,a,b){return{start:lM.constant(a2.on(d,c)),finish:lM.constant(a2.on(a,b))}},aD=(aC.detect().browser.isSafari(),function(d){var c=d!==undefined?d.dom():document,a=c.body.scrollLeft||c.documentElement.scrollLeft,b=c.body.scrollTop||c.documentElement.scrollTop;return k4(a,b)}),jf=aD,lj=function(c,b,a){(a!==undefined?a.dom():document).defaultView.scrollBy(c,b)};function hp(a){return{elementFromPoint:function(c,b){return jj.fromPoint(jj.fromDom(a.document),c,b)},getRect:function(b){return b.dom().getBoundingClientRect()},getRangedRect:function(g,d,b,c){var f=bO.exact(g,d,b,c);return dS(a,f).map(function(e){return lX.map(e,lM.apply)})},getSelection:function(){return cY(a).map(function(b){return ej(a,b)})},fromSitus:function(c){var b=bO.relative(c.start(),c.finish());return ej(a,b)},situsFromPoint:function(c,b){return iH(a,c,b).map(function(d){return{start:lM.constant(a2.on(d.start(),d.soffset())),finish:lM.constant(a2.on(d.finish(),d.foffset()))}})},clearSelection:function(){dH(a)},setSelection:function(b){gm(a,b.start(),b.soffset(),b.finish(),b.foffset())},setRelativeSelection:function(c,b){hL(a,c,b)},selectContents:function(b){bb(a,b)},getInnerHeight:function(){return a.innerHeight},getScrollY:function(){return jf(jj.fromDom(a.document)).top()},scrollBy:function(c,b){lj(c,b,jj.fromDom(a.document))}}}var ih=function(a,f,b,c,d){return hE.eq(b,c)?lN.none():fD(b,c,f).bind(function(h){var g=h.boxes().getOr([]);return 0<g.length?(d(a,g,h.start(),h.finish()),lN.some(fw.response(lN.some(cN(b,0,b,bZ(b))),!0))):lN.none()})},i0={sync:function(c,d,h,f,g,b,a){return hE.eq(h,g)&&f===b?lN.none():eZ.closest(h,"td,th",d).bind(function(i){return eZ.closest(g,"td,th",d).bind(function(e){return ih(c,d,i,e,a)})})},detect:ih,update:function(f,c,a,b,d){return cz(b,f,c,d.firstSelectedSelector(),d.lastSelectedSelector()).map(function(e){return d.clear(a),d.selectRange(a,e.boxes(),e.start(),e.finish()),e.boxes()})}},kq=mE.immutableBag(["left","top","right","bottom"],[]),gU={nu:kq,moveUp:function(b,a){return kq({left:b.left(),top:b.top()-a,right:b.right(),bottom:b.bottom()-a})},moveDown:function(b,a){return kq({left:b.left(),top:b.top()+a,right:b.right(),bottom:b.bottom()+a})},moveBottomTo:function(c,b){var a=c.bottom()-c.top();return kq({left:c.left(),top:b-a,right:c.right(),bottom:b})},moveTopTo:function(c,b){var a=c.bottom()-c.top();return kq({left:c.left(),top:b,right:c.right(),bottom:b+a})},getTop:function(a){return a.top()},getBottom:function(a){return a.bottom()},translate:function(c,b,a){return kq({left:c.left()+b,top:c.top()+a,right:c.right()+b,bottom:c.bottom()+a})},toString:function(a){return"("+a.left()+", "+a.top()+") -> ("+a.right()+", "+a.bottom()+")"}},nj=function(a){return gU.nu({left:a.left,top:a.top,right:a.right,bottom:a.bottom})},lV=function(b,a){return lN.some(b.getRect(a))},jL=function(g,d,b){return f9.isElement(d)?lV(g,d).map(nj):f9.isText(d)?(c=g,f=d,a=b,0<=a&&a<bZ(f)?c.getRangedRect(f,a,f,a+1):0<a?c.getRangedRect(f,a-1,f,a):lN.none()).map(nj):lN.none();var c,f,a},hQ=function(b,a){return f9.isElement(a)?lV(b,a).map(nj):f9.isText(a)?b.getRangedRect(a,0,a,bZ(a)).map(nj):lN.none()},k2=mE.immutable("item","mode"),lC=function(f,c,a,b){var d=b!==undefined?b:jz;return f.property().parent(c).map(function(e){return k2(e,d)})},jz=function(f,c,a,b){var d=b!==undefined?b:kQ;return a.sibling(f,c).map(function(e){return k2(e,d)})},kQ=function(g,d,b,c){var f=c!==undefined?c:kQ,a=g.property().children(d);return b.first(a).map(function(e){return k2(e,f)})},kE=[{current:lC,next:jz,fallback:lN.none()},{current:jz,next:kQ,fallback:lN.some(lC)},{current:kQ,next:kQ,fallback:lN.some(jz)}],iO=function(c,a,b,d,f){return f=f!==undefined?f:kE,mO.find(f,function(e){return e.current===b}).bind(function(e){return e.current(c,a,d,e.next).orThunk(function(){return e.fallback.bind(function(g){return iO(c,a,g,d)})})})},gx={backtrack:lC,sidestep:jz,advance:kQ,go:iO},mJ={left:function(){return{sibling:function(b,a){return b.query().prevSibling(a)},first:function(a){return 0<a.length?lN.some(a[a.length-1]):lN.none()}}},right:function(){return{sibling:function(b,a){return b.query().nextSibling(a)},first:function(a){return 0<a.length?lN.some(a[0]):lN.none()}}}},fY=function(d,g,b,c,f,a){return gx.go(d,g,c,f).bind(function(e){return a(e.item())?lN.none():b(e.item())?lN.some(e.item()):fY(d,e.item(),b,e.mode(),f,a)})},e2=function(d,c,a,b){return fY(d,c,a,gx.sidestep,mJ.left(),b)},fB=function(d,c,a,b){return fY(d,c,a,gx.sidestep,mJ.right(),b)},g6=function(b,a){return 0===b.property().children(a).length},cy=function(d,c,a,b){return e2(d,c,a,b)},cd=function(d,c,a,b){return fB(d,c,a,b)},b0={before:function(c,b,a){return cy(c,b,lM.curry(g6,c),a)},after:function(c,b,a){return cd(c,b,lM.curry(g6,c),a)},seekLeft:cy,seekRight:cd,walkers:function(){return{left:mJ.left,right:mJ.right}},walk:function(f,c,a,b,d){return gx.go(f,c,a,b,d)},backtrack:gx.backtrack,sidestep:gx.sidestep,advance:gx.advance},gJ=dN(),jX={gather:function(c,b,a){return b0.gather(gJ,c,b,a)},before:function(b,a){return b0.before(gJ,b,a)},after:function(b,a){return b0.after(gJ,b,a)},seekLeft:function(c,b,a){return b0.seekLeft(gJ,c,b,a)},seekRight:function(c,b,a){return b0.seekRight(gJ,c,b,a)},walkers:function(){return b0.walkers()},walk:function(d,c,a,b){return b0.walk(gJ,d,c,a,b)}},h2=gd([{none:[]},{retry:["caret"]}]),c5=function(b,c,a){return aq.closest(c,aX).fold(lM.constant(!1),function(d){return hQ(b,d).exists(function(h){return f=h,(g=a).left()<f.left()||Math.abs(f.right()-g.left())<1||g.left()>f.right();var g,f})})},dm={point:gU.getTop,adjuster:function(g,d,b,c,f){var a=gU.moveUp(f,5);return Math.abs(b.top()-c.top())<1?h2.retry(a):b.bottom()<f.top()?h2.retry(a):b.bottom()===f.top()?h2.retry(gU.moveUp(f,1)):c5(g,d,f)?h2.retry(gU.translate(a,5,0)):h2.none()},move:gU.moveUp,gather:jX.before},gb={point:gU.getBottom,adjuster:function(g,d,b,c,f){var a=gU.moveDown(f,5);return Math.abs(b.bottom()-c.bottom())<1?h2.retry(a):b.top()>f.bottom()?h2.retry(a):b.top()===f.bottom()?h2.retry(gU.moveDown(f,1)):c5(g,d,f)?h2.retry(gU.translate(a,5,0)):h2.none()},move:gU.moveDown,gather:jX.after},cU=function(q,b,d,h,p){return 0===p?lN.some(h):(k=q,g=h.left(),v=b.point(h),k.elementFromPoint(g,v).filter(function(a){return"table"===f9.name(a)}).isSome()?(j=h,m=p-1,cU(q,f=b,d,f.move(j,5),m)):q.situsFromPoint(h.left(),b.point(h)).bind(function(a){return a.start().fold(lN.none,function(c,i){return hQ(q,c,i).bind(function(e){return b.adjuster(q,c,e,d,h).fold(lN.none,function(l){return cU(q,b,d,l,p-1)})}).orThunk(function(){return lN.some(h)})},lN.none)}));var f,j,m,k,g,v},hF=function(h,f,k){var g,j,d,c=h.move(k,5),b=cU(f,h,k,c,100).getOr(c);return(g=h,j=b,d=f,g.point(j)>d.getInnerHeight()?lN.some(g.point(j)-d.getInnerHeight()):g.point(j)<0?lN.some(-g.point(j)):lN.none()).fold(function(){return f.situsFromPoint(b.left(),h.point(b))},function(a){return f.scrollBy(0,a),f.situsFromPoint(b.left(),h.point(b)-a)})},ex={tryUp:lM.curry(hF,dm),tryDown:lM.curry(hF,gb),ieTryUp:function(b,a){return b.situsFromPoint(a.left(),a.top()-5)},ieTryDown:function(b,a){return b.situsFromPoint(a.left(),a.bottom()+5)},getJumpSize:lM.constant(5)},a6=gd([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),dD=function(a){return eZ.closest(a,"tr")},dO={verify:function(b,j,g,d,f,i,h){return eZ.closest(d,"td,th",h).bind(function(a){return eZ.closest(j,"td,th",h).map(function(c){return hE.eq(a,c)?hE.eq(d,a)&&bZ(a)===f?i(c):a6.none("in same cell"):ik.sharedOne(dD,[a,c]).fold(function(){return m=c,k=a,l=(q=b).getRect(m),(p=q.getRect(k)).right>l.left&&p.left<l.right?a6.success():i(c);var q,m,k,l,p},function(e){return i(c)})})}).getOr(a6.none("default"))},cata:function(f,c,a,b,d){return f.fold(c,a,b,d)},adt:a6},iD={point:mE.immutable("element","offset"),delta:mE.immutable("element","deltaOffset"),range:mE.immutable("element","start","finish"),points:mE.immutable("begin","end"),text:mE.immutable("element","text")},j8=(mE.immutable("ancestor","descendants","element","index"),mE.immutable("parent","children","element","index")),ag=function(b,a){return mO.findIndex(b,lM.curry(hE.eq,a))},eG=function(a){return h1.parent(a).bind(function(c){var b=h1.children(c);return ag(b,a).map(function(d){return j8(c,b,a,d)})})},eR=function(a){return"br"===f9.name(a)},fN=function(c,b,a){return b(c,a).bind(function(d){return f9.isText(d)&&0===g4.get(d).trim().length?fN(d,b,a):lN.some(d)})},bN=function(d,g,b,c){return(f=g,a=b,h1.child(f,a).filter(eR).orThunk(function(){return h1.child(f,a-1).filter(eR)})).bind(function(e){return c.traverse(e).fold(function(){return fN(e,c.gather,d).map(c.relative)},function(h){return eG(h).map(function(i){return a2.on(i.parent(),i.index())})})});var f,a},bp=function(h,f,c,d){var g,b,a;return(eR(f)?(g=h,b=f,(a=d).traverse(b).orThunk(function(){return fN(b,a.gather,g)}).map(a.relative)):bN(h,f,c,d)).map(function(e){return{start:lM.constant(e),finish:lM.constant(e)}})},fj=function(a){return dO.cata(a,function(b){return lN.none()},function(){return lN.none()},function(b){return lN.some(iD.point(b,0))},function(b){return lN.some(iD.point(b,bZ(b)))})},aV=aC.detect(),aK=function(f,g,e,d,b,h){return 0===h?lN.none():eb(f,g,e,d,b).bind(function(i){var c=f.fromSitus(i),a=dO.verify(f,e,d,c.finish(),c.foffset(),b.failure,g);return dO.cata(a,function(){return lN.none()},function(){return lN.some(i)},function(j){return hE.eq(e,j)&&0===d?dZ(f,e,d,gU.moveUp,b):aK(f,g,j,0,b,h-1)},function(j){return hE.eq(e,j)&&d===bZ(j)?dZ(f,e,d,gU.moveDown,b):aK(f,g,j,bZ(j),b,h-1)})})},dZ=function(c,f,a,b,d){return jL(c,f,a).bind(function(e){return bC(c,d,b(e,ex.getJumpSize()))})},bC=function(c,b,a){return aV.browser.isChrome()||aV.browser.isSafari()||aV.browser.isFirefox()||aV.browser.isEdge()?b.otherRetry(c,a):aV.browser.isIE()?b.ieRetry(c,a):lN.none()},eb=function(c,f,a,b,d){return jL(c,a,b).bind(function(e){return bC(c,d,e)})},cJ=function(f,c,d){return(g=f,b=c,a=d,g.getSelection().bind(function(e){return bp(b,e.finish(),e.foffset(),a).fold(function(){return lN.some(iD.point(e.finish(),e.foffset()))},function(j){var i=g.fromSitus(j),h=dO.verify(g,e.finish(),e.foffset(),i.finish(),i.foffset(),a.failure,b);return fj(h)})})).bind(function(e){return aK(f,c,e.element(),e.offset(),d,20).map(f.fromSitus)});var g,b,a},az=function(c,b,a){return aq.ancestor(c,b,a).isSome()},jp=aC.detect(),lw=function(c,d,b,e,a){return eZ.closest(e,"td,th",d).bind(function(f){return eZ.closest(f,"table",d).bind(function(h){return g=h,az(a,function(i){return h1.parent(i).exists(function(j){return hE.eq(j,g)})})?cJ(c,d,b).bind(function(i){return eZ.closest(i.finish(),"td,th",d).map(function(j){return{start:lM.constant(f),finish:lM.constant(j),range:lM.constant(i)}})}):lN.none();var g})})},hB=function(g,d,b,c,f,a){return jp.browser.isIE()?lN.none():a(c,d).orThunk(function(){return lw(g,d,b,c,f).map(function(i){var h=i.range();return fw.response(lN.some(cN(h.start(),h.soffset(),h.finish(),h.foffset())),!0)})})},ix=function(h,f,c,d,g,b,a){return lw(h,c,d,g,b).bind(function(e){return i0.detect(f,c,e.start(),e.finish(),a)})},i6=function(b,a){return eZ.closest(b,"tr",a).bind(function(c){return eZ.closest(c,"table",a).bind(function(f){var d=dy.descendants(f,"tr");return hE.eq(c,d[0])?jX.seekLeft(f,function(e){return h0.last(e).isSome()},a).map(function(h){var g=bZ(h);return fw.response(lN.some(cN(h,g,h,g)),!0)}):lN.none()})})},g2=function(b,a){return eZ.closest(b,"tr",a).bind(function(c){return eZ.closest(c,"table",a).bind(function(f){var d=dy.descendants(f,"tr");return hE.eq(c,d[d.length-1])?jX.seekRight(f,function(e){return h0.first(e).isSome()},a).map(function(e){return fw.response(lN.some(cN(e,0,e,0)),!0)}):lN.none()})})},nw=function(b,a){return eZ.closest(b,"td,th",a)},mj={down:{traverse:h1.nextSibling,gather:jX.after,relative:a2.before,otherRetry:ex.tryDown,ieRetry:ex.ieTryDown,failure:dO.adt.failedDown},up:{traverse:h1.prevSibling,gather:jX.before,relative:a2.before,otherRetry:ex.tryUp,ieRetry:ex.ieTryUp,failure:dO.adt.failedUp}},jR=mE.immutable("rows","cols"),hY={mouse:function(g,m,w,b){var d,j,v,q,p,h,x=hp(g),k=(d=x,j=m,v=w,q=b,p=lN.none(),h=function(){p=lN.none()},{mousedown:function(a){q.clear(j),p=nw(a.target(),v)},mouseover:function(a){p.each(function(c){q.clear(j),nw(a.target(),v).each(function(e){fD(c,e,v).each(function(i){var f=i.boxes().getOr([]);(1<f.length||1===f.length&&!hE.eq(c,e))&&(q.selectRange(j,f,i.start(),i.finish()),d.selectContents(e))})})})},mouseup:function(){p.each(h)}});return{mousedown:k.mousedown,mouseover:k.mouseover,mouseup:k.mouseup}},keyboard:function(i,h,a,b){var e=hp(i),g=function(){return b.clear(h),lN.none()};return{keydown:function(p,l,j,k,m,f){var d=p.raw().which,c=!0===p.raw().shiftKey;return g7(h,b.selectedSelector()).fold(function(){return bI.isDown(d)&&c?lM.curry(ix,e,h,a,mj.down,k,l,b.selectRange):bI.isUp(d)&&c?lM.curry(ix,e,h,a,mj.up,k,l,b.selectRange):bI.isDown(d)?lM.curry(hB,e,a,mj.down,k,l,g2):bI.isUp(d)?lM.curry(hB,e,a,mj.up,k,l,i6):lN.none},function(o){var q=function(r){return function(){return hA(r,function(s){return i0.update(s.rows(),s.cols(),h,o,b)}).fold(function(){return cg(h,b.firstSelectedSelector(),b.lastSelectedSelector()).map(function(t){var s=bI.isDown(d)||f.isForward(d)?a2.after:a2.before;return e.setRelativeSelection(a2.on(t.first(),0),s(t.table())),b.clear(h),fw.response(lN.none(),!0)})},function(s){return lN.some(fw.response(lN.none(),!0))})}};return bI.isDown(d)&&c?q([jR(1,0)]):bI.isUp(d)&&c?q([jR(-1,0)]):f.isBackward(d)&&c?q([jR(0,-1),jR(-1,0)]):f.isForward(d)&&c?q([jR(0,1),jR(1,0)]):bI.isNavigation(d)&&!1===c?g:lN.none})()},keyup:function(j,d,f,k,c){return g7(h,b.selectedSelector()).fold(function(){var l=j.raw().which;return 0==(!0===j.raw().shiftKey)?lN.none():bI.isNavigation(l)?i0.sync(h,a,d,f,k,c,b.selectRange):lN.none()},lN.none)}}}},k8=function(a,b){mO.each(b,function(c){dI.remove(a,c)})},lH=function(a){return function(b){dI.add(b,a)}},jF=function(a){return function(b){k8(b,a)}},kW={byClass:function(d){var c=lH(d.selected()),b=jF([d.selected(),d.lastSelected(),d.firstSelected()]),a=function(g){var f=dy.descendants(g,d.selectedSelector());mO.each(f,b)};return{clear:a,selectRange:function(i,h,f,g){a(i),mO.each(h,c),dI.add(f,d.firstSelected()),dI.add(g,d.lastSelected())},selectedSelector:d.selectedSelector,firstSelectedSelector:d.firstSelectedSelector,lastSelectedSelector:d.lastSelectedSelector}},byAttr:function(d){var c=function(e){cp.remove(e,d.selected()),cp.remove(e,d.firstSelected()),cp.remove(e,d.lastSelected())},b=function(e){cp.set(e,d.selected(),"1")},a=function(g){var f=dy.descendants(g,d.selectedSelector());mO.each(f,c)};return{clear:a,selectRange:function(i,h,f,g){a(i),mO.each(h,b),cp.set(f,d.firstSelected(),"1"),cp.set(g,d.lastSelected(),"1")},selectedSelector:d.selectedSelector,firstSelectedSelector:d.firstSelectedSelector,lastSelectedSelector:d.lastSelectedSelector}}},kK=function(a){return !1===dI.has(jj.fromDom(a.target),"ephox-snooker-resizer-bar")};function iU(e,f){var d=mE.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),a=lN.none(),c=kW.byAttr(dp);return e.on("init",function(j){var b=e.getWin(),h=ld(e),x=kZ(e),C=hY.mouse(b,h,x,c),A=hY.keyboard(b,h,x,c),z=function(i,g){!0===i.raw().shiftKey&&(g.kill()&&i.kill(),g.selection().each(function(o){var m=bO.relative(o.start(),o.finish()),l=g0.asLtrRange(b,m);e.selection.setRng(l)}))},q=function(s){var l=D(s);if(l.raw().shiftKey&&bI.isNavigation(l.raw().which)){var g=e.selection.getRng(),i=jj.fromDom(g.startContainer),m=jj.fromDom(g.endContainer);A.keyup(l,i,g.startOffset,m,g.endOffset).each(function(o){z(l,o)})}},B=function(G){var E=D(G);f().each(function(i){i.hideBars()});var m=e.selection.getRng(),s=jj.fromDom(e.selection.getStart()),F=jj.fromDom(m.startContainer),l=jj.fromDom(m.endContainer),g=fQ.directionAt(s).isRtl()?bI.rtl:bI.ltr;A.keydown(E,F,m.startOffset,l,m.endOffset,g).each(function(i){z(E,i)}),f().each(function(i){i.showBars()})},p=function(g){return g.hasOwnProperty("x")&&g.hasOwnProperty("y")},D=function(s){var l=jj.fromDom(s.target),g=function(){s.stopPropagation()},i=function(){s.preventDefault()},m=lM.compose(i,g);return{target:lM.constant(l),x:lM.constant(p(s)?s.x:null),y:lM.constant(p(s)?s.y:null),stop:g,prevent:i,kill:m,raw:lM.constant(s)}},w=function(g){return 0===g.button},y=function(g){w(g)&&kK(g)&&C.mousedown(D(g))},k=function(i){var g;(g=i).buttons!==undefined&&0==(1&g.buttons)||!kK(i)||C.mouseover(D(i))},v=function(g){w(g)&&kK(g)&&C.mouseup(D(g))};e.on("mousedown",y),e.on("mouseover",k),e.on("mouseup",v),e.on("keyup",q),e.on("keydown",B),e.on("nodechange",function(){var l=e.selection,i=jj.fromDom(l.getStart()),g=jj.fromDom(l.getEnd());ik.sharedOne(aQ.table,[i,g]).fold(function(){c.clear(h)},lM.noop)}),a=lN.some(d({mousedown:y,mouseover:k,mouseup:v,keyup:q,keydown:B}))}),{clear:c.clear,destroy:function(){a.each(function(b){})}}}var gF=kk.each,m2=function(b){var a=[];function c(d){return function(){b.execCommand(d)}}gF("inserttable tableprops deletetable | cell row column".split(" "),function(d){"|"===d?a.push({text:"-"}):a.push(b.menuItems[d])}),b.addButton("table",{type:"menubutton",title:"Table",menu:a}),b.addButton("tableprops",{title:"Table properties",onclick:c("mceTableProps"),icon:"table"}),b.addButton("tabledelete",{title:"Delete table",onclick:c("mceTableDelete")}),b.addButton("tablecellprops",{title:"Cell properties",onclick:c("mceTableCellProps")}),b.addButton("tablemergecells",{title:"Merge cells",onclick:c("mceTableMergeCells")}),b.addButton("tablesplitcells",{title:"Split cell",onclick:c("mceTableSplitCells")}),b.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:c("mceTableInsertRowBefore")}),b.addButton("tableinsertrowafter",{title:"Insert row after",onclick:c("mceTableInsertRowAfter")}),b.addButton("tabledeleterow",{title:"Delete row",onclick:c("mceTableDeleteRow")}),b.addButton("tablerowprops",{title:"Row properties",onclick:c("mceTableRowProps")}),b.addButton("tablecutrow",{title:"Cut row",onclick:c("mceTableCutRow")}),b.addButton("tablecopyrow",{title:"Copy row",onclick:c("mceTableCopyRow")}),b.addButton("tablepasterowbefore",{title:"Paste row before",onclick:c("mceTablePasteRowBefore")}),b.addButton("tablepasterowafter",{title:"Paste row after",onclick:c("mceTablePasteRowAfter")}),b.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:c("mceTableInsertColBefore")}),b.addButton("tableinsertcolafter",{title:"Insert column after",onclick:c("mceTableInsertColAfter")}),b.addButton("tabledeletecol",{title:"Delete column",onclick:c("mceTableDeleteCol")})},f6=function(b){var c,a=""===(c=b.getParam("table_toolbar",hw))||!1===c?[]:lZ.isString(c)?c.split(/[ ,]/):lZ.isArray(c)?c:[];0<a.length&&b.addContextToolbar(function(d){return b.dom.is(d,"table")&&b.getBody().contains(d)},a.join(" "))},fb=function(z,q){var x=lN.none(),D=[],k=[],L=[],J=[],C=function(a){a.disabled(!0)},w=function(a){a.disabled(!1)},A=function(){var a=this;D.push(a),x.fold(function(){C(a)},function(b){w(a)})},H=function(){var a=this;k.push(a),x.fold(function(){C(a)},function(b){w(a)})};z.on("init",function(){z.on("nodechange",function(b){var a=lN.from(z.dom.getParent(z.selection.getStart(),"th,td"));(x=a.bind(function(d){var c=jj.fromDom(d);return aQ.table(c).map(function(e){return ah.forMenu(q,e,c)})})).fold(function(){mO.each(D,C),mO.each(k,C),mO.each(L,C),mO.each(J,C)},function(c){mO.each(D,w),mO.each(k,w),mO.each(L,function(d){d.disabled(c.mergable().isNone())}),mO.each(J,function(d){d.disabled(c.unmergable().isNone())})})})});var G=function(f,m,N,b){var d,h,M,v,p,g=b.getEl().getElementsByTagName("table")[0],O=b.isRtl()||"tl-tr"===b.parent().rel;for(g.nextSibling.innerHTML=m+1+" x "+(N+1),O&&(m=9-m),h=0;h<10;h++){for(d=0;d<10;d++){v=g.rows[h].childNodes[d].firstChild,p=(O?m<=d:d<=m)&&h<=N,f.dom.toggleClass(v,"mce-active",p),p&&(M=v)}}return M.parentNode},I=!1===z.getParam("table_grid",!0,"boolean")?{text:"Table",icon:"table",context:"table",onclick:B("mceInsertTable")}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(a){a.aria&&(this.parent().hideAll(),a.stopImmediatePropagation(),z.execCommand("mceInsertTable"))},onshow:function(){G(z,0,0,this.menu.items()[0])},onhide:function(){var a=this.menu.items()[0].getEl().getElementsByTagName("a");z.dom.removeClass(a,"mce-active"),z.dom.addClass(a[0],"mce-active")},menu:[{type:"container",html:function(){var c="";c='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var b=0;b<10;b++){c+="<tr>";for(var a=0;a<10;a++){c+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*b+a)+'" href="#" data-mce-x="'+a+'" data-mce-y="'+b+'"></a></td>'}c+="</tr>"}return c+="</table>",c+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(d){var c,a,b=d.target;"A"===b.tagName.toUpperCase()&&(c=parseInt(b.getAttribute("data-mce-x"),10),a=parseInt(b.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(c=9-c),c===this.lastX&&a===this.lastY||(G(z,c,a,d.control),this.lastX=c,this.lastY=a))},onclick:function(b){var a=this;"A"===b.target.tagName.toUpperCase()&&(b.preventDefault(),b.stopPropagation(),a.parent().cancel(),z.undoManager.transact(function(){g8(z,a.lastX+1,a.lastY+1)}),z.addVisual())}}]};function B(a){return function(){z.execCommand(a)}}var F={text:"Table properties",context:"table",onPostRender:A,onclick:B("mceTableProps")},E={text:"Delete table",context:"table",onPostRender:A,cmd:"mceTableDelete"},y={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:B("mceTableInsertRowBefore"),onPostRender:H},{text:"Insert row after",onclick:B("mceTableInsertRowAfter"),onPostRender:H},{text:"Delete row",onclick:B("mceTableDeleteRow"),onPostRender:H},{text:"Row properties",onclick:B("mceTableRowProps"),onPostRender:H},{text:"-"},{text:"Cut row",onclick:B("mceTableCutRow"),onPostRender:H},{text:"Copy row",onclick:B("mceTableCopyRow"),onPostRender:H},{text:"Paste row before",onclick:B("mceTablePasteRowBefore"),onPostRender:H},{text:"Paste row after",onclick:B("mceTablePasteRowAfter"),onPostRender:H}]},j={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:B("mceTableInsertColBefore"),onPostRender:H},{text:"Insert column after",onclick:B("mceTableInsertColAfter"),onPostRender:H},{text:"Delete column",onclick:B("mceTableDeleteCol"),onPostRender:H}]},K={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:B("mceTableCellProps"),onPostRender:H},{text:"Merge cells",onclick:B("mceTableMergeCells"),onPostRender:function(){var a=this;L.push(a),x.fold(function(){C(a)},function(b){a.disabled(b.mergable().isNone())})}},{text:"Split cell",onclick:B("mceTableSplitCells"),onPostRender:function(){var a=this;J.push(a),x.fold(function(){C(a)},function(b){a.disabled(b.unmergable().isNone())})}}]};z.addMenuItem("inserttable",I),z.addMenuItem("tableprops",F),z.addMenuItem("deletetable",E),z.addMenuItem("row",y),z.addMenuItem("column",j),z.addMenuItem("cell",K)},fJ=function(a,b){return{insertTable:function(d,c){return g8(a,d,c)},setClipboardRows:function(g){return f=g,c=b,d=mO.map(f,jj.fromDom),void c.set(lN.from(d));var f,c,d},getClipboardRows:function(){return b.get().fold(function(){},function(c){return mO.map(c,function(d){return d.dom()})})}}};lQ.add("table",function(f){var c,d=dV(f),h=iU(f,d.lazyResize),g=dW(f,d.lazyWire),b=(c=f,{get:function(){var e=ld(c);return b1(e,dp.selectedSelector()).fold(function(){return c.selection.getStart()===undefined?hG.none():hG.single(c.selection)},function(i){return hG.multiple(i)})}}),a=dq(lN.none());return lb(f,g,h,b,a),eI(f,b,g,h),fb(f,b),m2(f),f6(f),f.on("PreInit",function(){f.serializer.addTempAttr(dp.firstSelected()),f.serializer.addTempAttr(dp.lastSelected())}),f.getParam("table_tab_navigation",!0,"boolean")&&f.on("keydown",function(e){bx(e,f,g,d.lazyWire)}),f.on("remove",function(){d.destroy(),h.destroy()}),fJ(f,a)})}();