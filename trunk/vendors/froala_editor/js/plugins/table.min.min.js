/*!
 * froala_editor v2.8.4 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(c,a){return a===undefined&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(c)),b(a)}:b(window.jQuery)}(function(a){a.extend(a.FE.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_][_CUSTOM_COLOR_]"}),a.extend(a.FE.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableDefaultWidth:"100%",tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15}),a.FE.PLUGINS.table=function(au){var aw,aL,aH,aM,aO,aI,aD;function aS(){var g=aj();if(g){var d=au.popups.get("table.edit");if(d||(d=aK()),d){au.popups.setContainer("table.edit",au.$sc);var c=al(g),b=(c.left+c.right)/2,f=c.bottom;au.popups.show("table.edit",b,f,c.bottom-c.top),au.edit.isDisabled()&&(1<ao().length&&au.toolbar.disable(),au.$el.removeClass("fr-no-selection"),au.edit.on(),au.button.bulkRefresh(),au.selection.setAtEnd(au.$el.find(".fr-selected-cell:last").get(0)),au.selection.restore())}}}function aU(){var h,k,j,f,m=aj();if(m){var d=au.popups.get("table.colors");d||(d=function(){var q="";0<au.opts.tableColorsButtons.length&&(q='<div class="fr-buttons fr-table-colors-buttons">'+au.button.buildList(au.opts.tableColorsButtons)+"</div>");var p="";au.opts.colorsHEXInput&&(p='<div class="fr-table-colors-hex-layer fr-active fr-layer" id="fr-table-colors-hex-layer-'+au.id+'"><div class="fr-input-line"><input maxlength="7" id="fr-table-colors-hex-layer-text-'+au.id+'" type="text" placeholder="'+au.language.translate("HEX Color")+'" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="tableCellBackgroundCustomColor" tabIndex="2" role="button">'+au.language.translate("OK")+"</button></div></div>");var n={buttons:q,colors:function(){for(var r='<div class="fr-table-colors">',l=0;l<au.opts.tableColors.length;l++){0!==l&&l%au.opts.tableColorsStep==0&&(r+="<br>"),"REMOVE"!=au.opts.tableColors[l]?r+='<span class="fr-command" style="background: '+au.opts.tableColors[l]+';" tabIndex="-1" role="button" data-cmd="tableCellBackgroundColor" data-param1="'+au.opts.tableColors[l]+'"><span class="fr-sr-only">'+au.language.translate("Color")+" "+au.opts.tableColors[l]+"&nbsp;&nbsp;&nbsp;</span></span>":r+='<span class="fr-command" data-cmd="tableCellBackgroundColor" tabIndex="-1" role="button" data-param1="REMOVE" title="'+au.language.translate("Clear Formatting")+'">'+au.icon.create("tableColorRemove")+'<span class="fr-sr-only">'+au.language.translate("Clear Formatting")+"</span></span>"}return r+="</div>"}(),custom_color:p},i=au.popups.create("table.colors",n);return au.events.$on(au.$wp,"scroll.table-colors",function(){au.popups.isVisible("table.colors")&&aU()}),o=i,au.events.on("popup.tab",function(C){var G=a(C.currentTarget);if(!au.popups.isVisible("table.colors")||!G.is("span")){return !0}var F=C.which,y=!0;if(a.FE.KEYCODE.TAB==F){var H=o.find(".fr-buttons");y=!au.accessibility.focusToolbar(H,!!C.shiftKey)}else{if(a.FE.KEYCODE.ARROW_UP==F||a.FE.KEYCODE.ARROW_DOWN==F||a.FE.KEYCODE.ARROW_LEFT==F||a.FE.KEYCODE.ARROW_RIGHT==F){var x=G.parent().find("span.fr-command"),u=x.index(G),w=au.opts.colorsStep,z=Math.floor(x.length/w),B=u%w,E=Math.floor(u/w),D=E*w+B,v=z*w;a.FE.KEYCODE.ARROW_UP==F?D=((D-w)%v+v)%v:a.FE.KEYCODE.ARROW_DOWN==F?D=(D+w)%v:a.FE.KEYCODE.ARROW_LEFT==F?D=((D-1)%v+v)%v:a.FE.KEYCODE.ARROW_RIGHT==F&&(D=(D+1)%v);var A=a(x.get(D));au.events.disableBlur(),A.focus(),y=!1}else{a.FE.KEYCODE.ENTER==F&&(au.button.exec(G),y=!1)}}return !1===y&&(C.preventDefault(),C.stopPropagation()),y},!0),i;var o}()),au.popups.setContainer("table.colors",au.$sc);var b=al(m),c=(b.left+b.right)/2,g=b.bottom;h=au.popups.get("table.colors"),k=au.$el.find(".fr-selected-cell:first"),j=au.helpers.RGBToHex(k.css("background-color")),f=h.find(".fr-table-colors-hex-layer input"),h.find(".fr-selected-color").removeClass("fr-selected-color fr-active-item"),h.find('span[data-param1="'+j+'"]').addClass("fr-selected-color fr-active-item"),f.val(j).trigger("change"),au.popups.show("table.colors",c,g,b.bottom-b.top)}}function aR(){0===ao().length&&au.toolbar.enable()}function aX(g){if(g){return au.popups.onHide("table.insert",function(){au.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),!0}var d="";0<au.opts.tableInsertButtons.length&&(d='<div class="fr-buttons">'+au.button.buildList(au.opts.tableInsertButtons)+"</div>");var c,b={buttons:d,rows_columns:function(){for(var m='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',j=1;j<=au.opts.tableInsertMaxSize;j++){for(var i=1;i<=au.opts.tableInsertMaxSize;i++){var h="inline-block";2<j&&!au.helpers.isMobile()&&(h="none");var k="fr-table-cell ";1==j&&1==i&&(k+=" hover"),m+='<span class="fr-command '+k+'" tabIndex="-1" data-cmd="tableInsert" data-row="'+j+'" data-col="'+i+'" data-param1="'+j+'" data-param2="'+i+'" style="display: '+h+';" role="button"><span></span><span class="fr-sr-only">'+j+" &times; "+i+"&nbsp;&nbsp;&nbsp;</span></span>"}m+='<div class="new-line"></div>'}return m+="</div></div>"}()},f=au.popups.create("table.insert",b);return au.events.$on(f,"mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(h){aW(a(h.currentTarget))},!0),c=f,au.events.$on(c,"focus","[tabIndex]",function(i){var h=a(i.currentTarget);aW(h)}),au.events.on("popup.tab",function(u){var x=a(u.currentTarget);if(!au.popups.isVisible("table.insert")||!x.is("span, a")){return !0}var w,m=u.which;if(a.FE.KEYCODE.ARROW_UP==m||a.FE.KEYCODE.ARROW_DOWN==m||a.FE.KEYCODE.ARROW_LEFT==m||a.FE.KEYCODE.ARROW_RIGHT==m){if(x.is("span.fr-table-cell")){var y=x.parent().find("span.fr-table-cell"),k=y.index(x),h=au.opts.tableInsertMaxSize,j=k%h,p=Math.floor(k/h);a.FE.KEYCODE.ARROW_UP==m?p=Math.max(0,p-1):a.FE.KEYCODE.ARROW_DOWN==m?p=Math.min(au.opts.tableInsertMaxSize-1,p+1):a.FE.KEYCODE.ARROW_LEFT==m?j=Math.max(0,j-1):a.FE.KEYCODE.ARROW_RIGHT==m&&(j=Math.min(au.opts.tableInsertMaxSize-1,j+1));var q=p*h+j,v=a(y.get(q));aW(v),au.events.disableBlur(),v.focus(),w=!1}}else{a.FE.KEYCODE.ENTER==m&&(au.button.exec(x),w=!1)}return !1===w&&(u.preventDefault(),u.stopPropagation()),w},!0),f}function aW(h){var d=h.data("row"),c=h.data("col"),b=h.parent();b.siblings(".fr-table-size-info").html(d+" &times; "+c),b.find("> span").removeClass("hover fr-active-item");for(var f=1;f<=au.opts.tableInsertMaxSize;f++){for(var i=0;i<=au.opts.tableInsertMaxSize;i++){var g=b.find('> span[data-row="'+f+'"][data-col="'+i+'"]');f<=d&&i<=c?g.addClass("hover"):f<=d+1||f<=2&&!au.helpers.isMobile()?g.css("display","inline-block"):2<f&&!au.helpers.isMobile()&&g.css("display","none")}}h.addClass("fr-active-item")}function aK(d){if(d){return au.popups.onHide("table.edit",aR),!0}if(0<au.opts.tableEditButtons.length){var c={buttons:'<div class="fr-buttons">'+au.button.buildList(au.opts.tableEditButtons)+"</div>"},b=au.popups.create("table.edit",c);return au.events.$on(au.$wp,"scroll.table-edit",function(){au.popups.isVisible("table.edit")&&aS()}),b}return !1}function aF(){if(0<ao().length){var b=ah();au.selection.setBefore(b.get(0))||au.selection.setAfter(b.get(0)),au.selection.restore(),au.popups.hide("table.edit"),b.remove(),au.toolbar.enable()}}function aY(h){var k=ah();if(0<k.length){if(0<au.$el.find("th.fr-selected-cell").length&&"above"==h){return}var j,f,m,d=aj(),b=az(d);f="above"==h?b.min_i:b.max_i;var c="<tr>";for(j=0;j<d[f].length;j++){if("below"==h&&f<d.length-1&&d[f][j]==d[f+1][j]||"above"==h&&0<f&&d[f][j]==d[f-1][j]){if(0===j||0<j&&d[f][j]!=d[f][j-1]){var g=a(d[f][j]);g.attr("rowspan",parseInt(g.attr("rowspan"),10)+1)}}else{c+="<td><br></td>"}}c+="</tr>",m=0<au.$el.find("th.fr-selected-cell").length&&"below"==h?a(k.find("tbody").not(k.find("table tbody"))):a(k.find("tr").not(k.find("table tr")).get(f)),"below"==h?"TBODY"==m.prop("tagName")?m.prepend(c):m.after(c):"above"==h&&(m.before(c),au.popups.isVisible("table.edit")&&aS())}}function aT(k,p,m){var g,q,d,b,c,h=0,j=aj(m);if(k<(p=Math.min(p,j[0].length-1))){for(q=k;q<=p;q++){if(!(k<q&&j[0][q]==j[0][q-1])&&1<(b=Math.min(parseInt(j[0][q].getAttribute("colspan"),10)||1,p-k+1))&&j[0][q]==j[0][q+1]){for(h=b-1,g=1;g<j.length;g++){if(j[g][q]!=j[g-1][q]){for(d=q;d<q+b;d++){if(1<(c=parseInt(j[g][d].getAttribute("colspan"),10)||1)&&j[g][d]==j[g][d+1]){d+=h=Math.min(h,c-1)}else{if(!(h=Math.max(0,h-1))){break}}}if(!h){break}}}}}}h&&aE(j,h,"colspan",0,j.length-1,k,p)}function aN(k,p,m){var g,q,d,b,c,h=0,j=aj(m);if(k<(p=Math.min(p,j.length-1))){for(g=k;g<=p;g++){if(!(k<g&&j[g][0]==j[g-1][0])&&1<(b=Math.min(parseInt(j[g][0].getAttribute("rowspan"),10)||1,p-k+1))&&j[g][0]==j[g+1][0]){for(h=b-1,q=1;q<j[0].length;q++){if(j[g][q]!=j[g][q-1]){for(d=g;d<g+b;d++){if(1<(c=parseInt(j[d][q].getAttribute("rowspan"),10)||1)&&j[d][q]==j[d+1][q]){d+=h=Math.min(h,c-1)}else{if(!(h=Math.max(0,h-1))){break}}}if(!h){break}}}}}}h&&aE(j,h,"rowspan",k,p,0,j[0].length-1)}function aE(k,p,m,g,q,d,b){var c,h,j;for(c=g;c<=q;c++){for(h=d;h<=b;h++){g<c&&k[c][h]==k[c-1][h]||d<h&&k[c][h]==k[c][h-1]||1<(j=parseInt(k[c][h].getAttribute(m),10)||1)&&(1<j-p?k[c][h].setAttribute(m,j-p):k[c][h].removeAttribute(m))}}}function ag(g,d,c,b,f){aN(g,d,f),aT(c,b,f)}function aG(c){var b=au.$el.find(".fr-selected-cell");"REMOVE"!=c?b.css("background-color",au.helpers.HEXtoRGB(c)):b.css("background-color",""),aS()}function aj(c){var b=[];return null==(c=c||null)&&0<ao().length&&(c=ah()),c&&c.find("tr:visible").not(c.find("table tr")).each(function(h,g){var f=a(g),d=0;f.find("> th, > td").each(function(p,k){for(var j=a(k),i=parseInt(j.attr("colspan"),10)||1,m=parseInt(j.attr("rowspan"),10)||1,q=h;q<h+m;q++){for(var o=d;o<d+i;o++){b[q]||(b[q]=[]),b[q][o]?d++:b[q][o]=k}}d+=i})}),b}function ay(f,d){for(var c=0;c<d.length;c++){for(var b=0;b<d[c].length;b++){if(d[c][b]==f){return{row:c,col:b}}}}}function at(g,d,c){for(var b=g+1,f=d+1;b<c.length;){if(c[b][d]!=c[g][d]){b--;break}b++}for(b==c.length&&b--;f<c[g].length;){if(c[g][f]!=c[g][d]){f--;break}f++}return f==c[g].length&&f--,{row:b,col:f}}function aC(){au.el.querySelector(".fr-cell-fixed")&&au.el.querySelector(".fr-cell-fixed").classList.remove("fr-cell-fixed"),au.el.querySelector(".fr-cell-handler")&&au.el.querySelector(".fr-cell-handler").classList.remove("fr-cell-handler")}function av(){var b=au.$el.find(".fr-selected-cell");0<b.length&&b.each(function(){var c=a(this);c.removeClass("fr-selected-cell"),""===c.attr("class")&&c.removeAttr("class")}),aC()}function aB(){au.events.disableBlur(),au.selection.clear(),au.$el.addClass("fr-no-selection"),au.$el.blur(),au.events.enableBlur()}function az(h){var k=au.$el.find(".fr-selected-cell");if(0<k.length){var j,f=h.length,m=0,d=h[0].length,b=0;for(j=0;j<k.length;j++){var c=ay(k[j],h),g=at(c.row,c.col,h);f=Math.min(c.row,f),m=Math.max(g.row,m),d=Math.min(c.col,d),b=Math.max(g.col,b)}return{min_i:f,max_i:m,min_j:d,max_j:b}}return null}function al(g){var d=az(g),c=a(g[d.min_i][d.min_j]),b=a(g[d.min_i][d.max_j]),f=a(g[d.max_i][d.min_j]);return{left:c.offset().left,right:b.offset().left+b.outerWidth(),top:c.offset().top,bottom:f.offset().top+f.outerHeight()}}function a0(k,j){if(a(k).is(j)){av(),a(k).addClass("fr-selected-cell")}else{aB(),au.edit.off();var f=aj(),m=ay(k,f),d=ay(j,f),b=function h(D,C,w,E,v){var e,u,x,z,B=D,A=C,q=w,y=E;for(e=B;e<=A;e++){(1<(parseInt(a(v[e][q]).attr("rowspan"),10)||1)||1<(parseInt(a(v[e][q]).attr("colspan"),10)||1))&&(z=at((x=ay(v[e][q],v)).row,x.col,v),B=Math.min(x.row,B),A=Math.max(z.row,A),q=Math.min(x.col,q),y=Math.max(z.col,y)),(1<(parseInt(a(v[e][y]).attr("rowspan"),10)||1)||1<(parseInt(a(v[e][y]).attr("colspan"),10)||1))&&(z=at((x=ay(v[e][y],v)).row,x.col,v),B=Math.min(x.row,B),A=Math.max(z.row,A),q=Math.min(x.col,q),y=Math.max(z.col,y))}for(u=q;u<=y;u++){(1<(parseInt(a(v[B][u]).attr("rowspan"),10)||1)||1<(parseInt(a(v[B][u]).attr("colspan"),10)||1))&&(z=at((x=ay(v[B][u],v)).row,x.col,v),B=Math.min(x.row,B),A=Math.max(z.row,A),q=Math.min(x.col,q),y=Math.max(z.col,y)),(1<(parseInt(a(v[A][u]).attr("rowspan"),10)||1)||1<(parseInt(a(v[A][u]).attr("colspan"),10)||1))&&(z=at((x=ay(v[A][u],v)).row,x.col,v),B=Math.min(x.row,B),A=Math.max(z.row,A),q=Math.min(x.col,q),y=Math.max(z.col,y))}return B==D&&A==C&&q==w&&y==E?{min_i:D,max_i:C,min_j:w,max_j:E}:h(B,A,q,y,v)}(Math.min(m.row,d.row),Math.max(m.row,d.row),Math.min(m.col,d.col),Math.max(m.col,d.col),f);av(),k.classList.add("fr-cell-fixed"),j.classList.add("fr-cell-handler");for(var c=b.min_i;c<=b.max_i;c++){for(var g=b.min_j;g<=b.max_j;g++){a(f[c][g]).addClass("fr-selected-cell")}}}}function ap(d){var c=null,b=a(d.target);return"TD"==d.target.tagName||"TH"==d.target.tagName?c=d.target:0<b.closest("td").length?c=b.closest("td").get(0):0<b.closest("th").length&&(c=b.closest("th").get(0)),0===au.$el.find(c).length?null:c}function ae(){av(),au.popups.hide("table.edit")}function aV(d){var c=ap(d);if("false"==a(c).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")){return !0}if(0<ao().length&&!c&&ae(),!au.edit.isDisabled()||au.popups.isVisible("table.edit")){if(1!=d.which||1==d.which&&au.helpers.isMac()&&d.ctrlKey){(3==d.which||1==d.which&&au.helpers.isMac()&&d.ctrlKey)&&c&&ae()}else{if(aM=!0,c){0<ao().length&&!d.shiftKey&&ae(),d.stopPropagation(),au.events.trigger("image.hideResizer"),au.events.trigger("video.hideResizer"),aH=!0;var b=c.tagName.toLowerCase();d.shiftKey&&0<au.$el.find(b+".fr-selected-cell").length?a(au.$el.find(b+".fr-selected-cell").closest("table")).is(a(c).closest("table"))?a0(aO,c):aB():((au.keys.ctrlKey(d)||d.shiftKey)&&(1<ao().length||0===a(c).find(au.selection.element()).length&&!a(c).is(au.selection.element()))&&aB(),aO=c,0<au.opts.tableEditButtons.length&&a0(aO,aO))}}}}function aZ(c){if(aH||au.$tb.is(c.target)||au.$tb.is(a(c.target).closest(au.$tb.get(0)))||(0<ao().length&&au.toolbar.enable(),av()),!(1!=c.which||1==c.which&&au.helpers.isMac()&&c.ctrlKey)){if(aM=!1,aH){aH=!1,ap(c)||1!=ao().length?0<ao().length&&(au.selection.isCollapsed()?aS():av()):av()}if(aD){aD=!1,aw.removeClass("fr-moving"),au.$el.removeClass("fr-no-selection"),au.edit.on();var b=parseFloat(aw.css("left"))+au.opts.tableResizerOffset+au.$wp.offset().left;au.opts.iframe&&(b-=au.$iframe.offset().left),aw.data("release-position",b),aw.removeData("max-left"),aw.removeData("max-right"),function(){var J=aw.data("origin"),x=aw.data("release-position");if(J!==x){var N=aw.data("first"),E=aw.data("second"),y=aw.data("table"),C=y.outerWidth();if(au.undo.canDo()||au.undo.saveStep(),null!==N&&null!==E){var z,B,F,I=aj(y),L=[],K=[],A=[],G=[];for(z=0;z<I.length;z++){B=a(I[z][N]),F=a(I[z][E]),L[z]=B.outerWidth(),A[z]=F.outerWidth(),K[z]=L[z]/C*100,G[z]=A[z]/C*100}for(z=0;z<I.length;z++){if(B=a(I[z][N]),F=a(I[z][E]),I[z][N]!=I[z][E]){var q=(K[z]*(L[z]+x-J)/L[z]).toFixed(4);B.css("width",q+"%"),F.css("width",(K[z]+G[z]-q).toFixed(4)+"%")}}}else{var M,H=y.parent(),D=C/H.width()*100,k=(parseInt(y.css("margin-left"),10)||0)/H.width()*100,j=(parseInt(y.css("margin-right"),10)||0)/H.width()*100;"rtl"==au.opts.direction&&0===E||"rtl"!=au.opts.direction&&0!==E?(M=(C+x-J)/C*D,y.css("margin-right","calc(100% - "+Math.round(M).toFixed(4)+"% - "+Math.round(k).toFixed(4)+"%)")):("rtl"==au.opts.direction&&0!==E||"rtl"!=au.opts.direction&&0===E)&&(M=(C-x+J)/C*D,y.css("margin-left","calc(100% - "+Math.round(M).toFixed(4)+"% - "+Math.round(j).toFixed(4)+"%)")),y.css("width",Math.round(M).toFixed(4)+"%")}au.selection.restore(),au.undo.saveStep(),au.events.trigger("table.resized",[y.get(0)])}aw.removeData("origin"),aw.removeData("release-position"),aw.removeData("first"),aw.removeData("second"),aw.removeData("table")}(),ab()}}}function ak(b){if(!0===aH&&0<au.opts.tableEditButtons.length){if(a(b.currentTarget).closest("table").is(ah())){if("TD"==b.currentTarget.tagName&&0===au.$el.find("th.fr-selected-cell").length){return void a0(aO,b.currentTarget)}if("TH"==b.currentTarget.tagName&&0===au.$el.find("td.fr-selected-cell").length){return void a0(aO,b.currentTarget)}}aB()}}function af(g,d,c,b){for(var f,h=d;h!=au.el&&"TD"!=h.tagName&&"TH"!=h.tagName&&("up"==b?f=h.previousElementSibling:"down"==b&&(f=h.nextElementSibling),!f);){h=h.parentNode}"TD"==h.tagName||"TH"==h.tagName?function(m,k){for(var j=m;j&&"TABLE"!=j.tagName&&j.parentNode!=au.el;){j=j.parentNode}if(j&&"TABLE"==j.tagName){var i=aj(a(j));"up"==k?aA(ay(m,i),j,i):"down"==k&&ax(ay(m,i),j,i)}}(h,b):f&&("up"==b&&au.selection.setAtEnd(f),"down"==b&&au.selection.setAtStart(f))}function aA(d,c,b){0<d.row?au.selection.setAtEnd(b[d.row-1][d.col]):af(0,c,0,"up")}function ax(f,d,c){var b=parseInt(c[f.row][f.col].getAttribute("rowspan"),10)||1;f.row<c.length-b?au.selection.setAtStart(c[f.row+b][f.col]):af(0,d,0,"down")}function ab(){aw&&(aw.find("div").css("opacity",0),aw.css("top",0),aw.css("left",0),aw.css("height",0),aw.find("div").css("height",0),aw.hide())}function aP(){aL&&aL.removeClass("fr-visible").css("left","-9999px")}function an(H,q){var L=a(q),C=L.closest("table"),w=C.parent();if(q&&"TD"!=q.tagName&&"TH"!=q.tagName&&(0<L.closest("td").length?q=L.closest("td"):0<L.closest("th").length&&(q=L.closest("th"))),!q||"TD"!=q.tagName&&"TH"!=q.tagName){aw&&L.get(0)!=aw.get(0)&&L.parent().get(0)!=aw.get(0)&&au.core.sameInstance(aw)&&ab()}else{if(L=a(q),0===au.$el.find(L).length){return !1}var A=L.offset().left-1,x=A+L.outerWidth();if(Math.abs(H.pageX-A)<=au.opts.tableResizerOffset||Math.abs(x-H.pageX)<=au.opts.tableResizerOffset){var z,D,G,J,I,y=aj(C),E=ay(q,y),k=at(E.row,E.col,y),K=C.offset().top,F=C.outerHeight()-1;"rtl"!=au.opts.direction?H.pageX-A<=au.opts.tableResizerOffset?(G=A,0<E.col?(J=A-aQ(E.col-1,y)+au.opts.tableResizingLimit,I=A+aQ(E.col,y)-au.opts.tableResizingLimit,z=E.col-1,D=E.col):(z=null,D=0,J=C.offset().left-1-parseInt(C.css("margin-left"),10),I=C.offset().left-1+C.width()-y[0].length*au.opts.tableResizingLimit)):x-H.pageX<=au.opts.tableResizerOffset&&(G=x,k.col<y[k.row].length&&y[k.row][k.col+1]?(J=x-aQ(k.col,y)+au.opts.tableResizingLimit,I=x+aQ(k.col+1,y)-au.opts.tableResizingLimit,z=k.col,D=k.col+1):(z=k.col,D=null,J=C.offset().left-1+y[0].length*au.opts.tableResizingLimit,I=w.offset().left-1+w.width()+parseFloat(w.css("padding-left")))):x-H.pageX<=au.opts.tableResizerOffset?(G=x,0<E.col?(J=x-aQ(E.col,y)+au.opts.tableResizingLimit,I=x+aQ(E.col-1,y)-au.opts.tableResizingLimit,z=E.col,D=E.col-1):(z=null,D=0,J=C.offset().left+y[0].length*au.opts.tableResizingLimit,I=w.offset().left-1+w.width()+parseFloat(w.css("padding-left")))):H.pageX-A<=au.opts.tableResizerOffset&&(G=A,k.col<y[k.row].length&&y[k.row][k.col+1]?(J=A-aQ(k.col+1,y)+au.opts.tableResizingLimit,I=A+aQ(k.col,y)-au.opts.tableResizingLimit,z=k.col+1,D=k.col):(z=k.col,D=null,J=w.offset().left+parseFloat(w.css("padding-left")),I=C.offset().left-1+C.width()-y[0].length*au.opts.tableResizingLimit)),aw||(au.shared.$table_resizer||(au.shared.$table_resizer=a('<div class="fr-table-resizer"><div></div></div>')),aw=au.shared.$table_resizer,au.events.$on(aw,"mousedown",function(b){return !au.core.sameInstance(aw)||(0<ao().length&&ae(),1==b.which?(au.selection.save(),aD=!0,aw.addClass("fr-moving"),aB(),au.edit.off(),aw.find("div").css("opacity",1),!1):void 0)}),au.events.$on(aw,"mousemove",function(b){if(!au.core.sameInstance(aw)){return !0}aD&&(au.opts.iframe&&(b.pageX-=au.$iframe.offset().left),aa(b))}),au.events.on("shared.destroy",function(){aw.html("").removeData().remove(),aw=null},!0),au.events.on("destroy",function(){au.$el.find(".fr-selected-cell").removeClass("fr-selected-cell"),aw.hide().appendTo(a("body:first"))},!0)),aw.data("table",C),aw.data("first",z),aw.data("second",D),aw.data("instance",au),au.$wp.append(aw);var B=G-au.win.pageXOffset-au.opts.tableResizerOffset-au.$wp.offset().left,j=K-au.$wp.offset().top+au.$wp.scrollTop();au.opts.iframe&&(B+=au.$iframe.offset().left,j+=au.$iframe.offset().top,J+=au.$iframe.offset().left,I+=au.$iframe.offset().left),aw.data("max-left",J),aw.data("max-right",I),aw.data("origin",G-au.win.pageXOffset),aw.css("top",j),aw.css("left",B),aw.css("height",F),aw.find("div").css("height",F),aw.css("padding-left",au.opts.tableResizerOffset),aw.css("padding-right",au.opts.tableResizerOffset),aw.show()}else{au.core.sameInstance(aw)&&ab()}}}function am(h,d){if(au.$box.find(".fr-line-breaker").is(":visible")){return !1}aL||aJ(),au.$box.append(aL),aL.data("instance",au);var c,b=a(d).find("tr:first"),f=h.pageX,i=0,g=0;au.opts.iframe&&(i+=au.$iframe.offset().left-au.helpers.scrollLeft(),g+=au.$iframe.offset().top-au.helpers.scrollTop()),b.find("th, td").each(function(){var j=a(this);return j.offset().left<=f&&f<j.offset().left+j.outerWidth()/2?(c=parseInt(aL.find("a").css("width"),10),aL.css("top",g+j.offset().top-au.$box.offset().top-au.win.pageYOffset-c-5),aL.css("left",i+j.offset().left-au.$box.offset().left-au.win.pageXOffset-c/2),aL.data("selected-cell",j),aL.data("position","before"),aL.addClass("fr-visible"),!1):j.offset().left+j.outerWidth()/2<=f&&f<j.offset().left+j.outerWidth()?(c=parseInt(aL.find("a").css("width"),10),aL.css("top",g+j.offset().top-au.$box.offset().top-au.win.pageYOffset-c-5),aL.css("left",i+j.offset().left-au.$box.offset().left+j.outerWidth()-au.win.pageXOffset-c/2),aL.data("selected-cell",j),aL.data("position","after"),aL.addClass("fr-visible"),!1):void 0})}function aq(h,d){if(au.$box.find(".fr-line-breaker").is(":visible")){return !1}aL||aJ(),au.$box.append(aL),aL.data("instance",au);var c,b=a(d),f=h.pageY,i=0,g=0;au.opts.iframe&&(i+=au.$iframe.offset().left-au.helpers.scrollLeft(),g+=au.$iframe.offset().top-au.helpers.scrollTop()),b.find("tr").each(function(){var j=a(this);return j.offset().top<=f&&f<j.offset().top+j.outerHeight()/2?(c=parseInt(aL.find("a").css("width"),10),aL.css("top",g+j.offset().top-au.$box.offset().top-au.win.pageYOffset-c/2),aL.css("left",i+j.offset().left-au.$box.offset().left-au.win.pageXOffset-c-5),aL.data("selected-cell",j.find("td:first")),aL.data("position","above"),aL.addClass("fr-visible"),!1):j.offset().top+j.outerHeight()/2<=f&&f<j.offset().top+j.outerHeight()?(c=parseInt(aL.find("a").css("width"),10),aL.css("top",g+j.offset().top-au.$box.offset().top+j.outerHeight()-au.win.pageYOffset-c/2),aL.css("left",i+j.offset().left-au.$box.offset().left-au.win.pageXOffset-c-5),aL.data("selected-cell",j.find("td:first")),aL.data("position","below"),aL.addClass("fr-visible"),!1):void 0})}function Z(c){aI=null;var b=au.doc.elementFromPoint(c.pageX-au.win.pageXOffset,c.pageY-au.win.pageYOffset);au.opts.tableResizer&&(!au.popups.areVisible()||au.popups.areVisible()&&au.popups.isVisible("table.edit"))&&an(c,b),!au.opts.tableInsertHelper||au.popups.areVisible()||au.$tb.hasClass("fr-inline")&&au.$tb.is(":visible")||function(i,g){if(0===ao().length){var f,d,h;if(g&&("HTML"==g.tagName||"BODY"==g.tagName||au.node.isElement(g))){for(f=1;f<=au.opts.tableInsertHelperOffset;f++){if(d=au.doc.elementFromPoint(i.pageX-au.win.pageXOffset,i.pageY-au.win.pageYOffset+f),a(d).hasClass("fr-tooltip")){return}if(d&&("TH"==d.tagName||"TD"==d.tagName||"TABLE"==d.tagName)&&(a(d).parents(".fr-wrapper").length||au.opts.iframe)){return am(i,a(d).closest("table"))}if(h=au.doc.elementFromPoint(i.pageX-au.win.pageXOffset+f,i.pageY-au.win.pageYOffset),a(h).hasClass("fr-tooltip")){return}if(h&&("TH"==h.tagName||"TD"==h.tagName||"TABLE"==h.tagName)&&(a(h).parents(".fr-wrapper").length||au.opts.iframe)){return aq(i,a(h).closest("table"))}}}au.core.sameInstance(aL)&&aP()}}(c,b)}function ai(){if(aD){var b=aw.data("table").offset().top-au.win.pageYOffset;au.opts.iframe&&(b+=au.$iframe.offset().top-au.helpers.scrollTop()),aw.css("top",b)}}function aQ(f,d){var c,b=a(d[0][f]).outerWidth();for(c=1;c<d.length;c++){b=Math.min(b,a(d[c][f]).outerWidth())}return b}function ac(g,d,c){var b,f=0;for(b=g;b<=d;b++){f+=aQ(b,c)}return f}function aa(f){if(1<ao().length&&aM&&aB(),!1===aM&&!1===aH&&!1===aD){aI&&clearTimeout(aI),au.edit.isDisabled()&&!au.popups.isVisible("table.edit")||(aI=setTimeout(Z,30,f))}else{if(aD){var d=f.pageX-au.win.pageXOffset;au.opts.iframe&&(d+=au.$iframe.offset().left);var c=aw.data("max-left"),b=aw.data("max-right");c<=d&&d<=b?aw.css("left",d-au.opts.tableResizerOffset-au.$wp.offset().left):d<c&&parseFloat(aw.css("left"),10)>c-au.opts.tableResizerOffset?aw.css("left",c-au.opts.tableResizerOffset-au.$wp.offset().left):b<d&&parseFloat(aw.css("left"),10)<b-au.opts.tableResizerOffset&&aw.css("left",b-au.opts.tableResizerOffset-au.$wp.offset().left)}else{aM&&aP()}}}function ad(b){au.node.isEmpty(b.get(0))?b.prepend(a.FE.MARKERS):b.prepend(a.FE.START_MARKER).append(a.FE.END_MARKER)}function aJ(){au.shared.$ti_helper||(au.shared.$ti_helper=a('<div class="fr-insert-helper"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+au.language.translate("Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a></div>'),au.events.bindClick(au.shared.$ti_helper,"a",function(){var d=aL.data("selected-cell"),c=aL.data("position"),b=aL.data("instance")||au;"before"==c?(au.undo.saveStep(),d.addClass("fr-selected-cell"),b.table.insertColumn(c),d.removeClass("fr-selected-cell"),au.undo.saveStep()):"after"==c?(au.undo.saveStep(),d.addClass("fr-selected-cell"),b.table.insertColumn(c),d.removeClass("fr-selected-cell"),au.undo.saveStep()):"above"==c?(au.undo.saveStep(),d.addClass("fr-selected-cell"),b.table.insertRow(c),d.removeClass("fr-selected-cell"),au.undo.saveStep()):"below"==c&&(au.undo.saveStep(),d.addClass("fr-selected-cell"),b.table.insertRow(c),d.removeClass("fr-selected-cell"),au.undo.saveStep()),aP()}),au.events.on("shared.destroy",function(){au.shared.$ti_helper.html("").removeData().remove(),au.shared.$ti_helper=null},!0),au.events.$on(au.shared.$ti_helper,"mousemove",function(b){b.stopPropagation()},!0),au.events.$on(a(au.o_win),"scroll",function(){aP()},!0),au.events.$on(au.$wp,"scroll",function(){aP()},!0)),aL=au.shared.$ti_helper,au.events.on("destroy",function(){aL=null}),au.tooltip.bind(au.$box,".fr-insert-helper > a.fr-floating-btn")}function ar(){aO=null,clearTimeout(aI)}function ao(){return au.el.querySelectorAll(".fr-selected-cell")}function ah(){var c=ao();if(c.length){for(var b=c[0];b&&"TABLE"!=b.tagName&&b.parentNode!=au.el;){b=b.parentNode}return b&&"TABLE"==b.tagName?a(b):a([])}return a([])}return{_init:function(){if(!au.$wp){return !1}if(!au.helpers.isMobile()){aD=aH=aM=!1,au.events.$on(au.$el,"mousedown",aV),au.popups.onShow("image.edit",function(){av(),aH=aM=!1}),au.popups.onShow("link.edit",function(){av(),aH=aM=!1}),au.events.on("commands.mousedown",function(c){0<c.parents(".fr-toolbar").length&&av()}),au.events.$on(au.$el,"mouseenter","th, td",ak),au.events.$on(au.$win,"mouseup",aZ),au.opts.iframe&&au.events.$on(a(au.o_win),"mouseup",aZ),au.events.$on(au.$win,"mousemove",aa),au.events.$on(a(au.o_win),"scroll",ai),au.events.on("contentChanged",function(){0<ao().length&&(aS(),au.$el.find("img").on("load.selected-cells",function(){a(this).off("load.selected-cells"),0<ao().length&&aS()}))}),au.events.$on(a(au.o_win),"resize",function(){av()}),au.events.on("toolbar.esc",function(){if(0<ao().length){return au.events.disableBlur(),au.events.focus(),!1}},!0),au.events.$on(a(au.o_win),"keydown",function(){aM&&aH&&(aH=aM=!1,au.$el.removeClass("fr-no-selection"),au.edit.on(),au.selection.setAtEnd(au.$el.find(".fr-selected-cell:last").get(0)),au.selection.restore(),av())}),au.events.$on(au.$el,"keydown",function(c){c.shiftKey?!1===function(j){var g=ao();if(0<g.length){var f,d,h=aj(),k=j.which;1==g.length?d=f=g[0]:(f=au.el.querySelector(".fr-cell-fixed"),d=au.el.querySelector(".fr-cell-handler"));var i=ay(d,h);if(a.FE.KEYCODE.ARROW_RIGHT==k){if(i.col<h[0].length-1){return a0(f,h[i.row][i.col+1]),!1}}else{if(a.FE.KEYCODE.ARROW_DOWN==k){if(i.row<h.length-1){return a0(f,h[i.row+1][i.col]),!1}}else{if(a.FE.KEYCODE.ARROW_LEFT==k){if(0<i.col){return a0(f,h[i.row][i.col-1]),!1}}else{if(a.FE.KEYCODE.ARROW_UP==k&&0<i.row){return a0(f,h[i.row-1][i.col]),!1}}}}}}(c)&&setTimeout(function(){aS()},0):function(j){var g=j.which,f=au.selection.blocks();if(f.length&&("TD"==(f=f[0]).tagName||"TH"==f.tagName)){for(var d=f;d&&"TABLE"!=d.tagName&&d.parentNode!=au.el;){d=d.parentNode}if(d&&"TABLE"==d.tagName&&(a.FE.KEYCODE.ARROW_LEFT==g||a.FE.KEYCODE.ARROW_UP==g||a.FE.KEYCODE.ARROW_RIGHT==g||a.FE.KEYCODE.ARROW_DOWN==g)&&(0<ao().length&&ae(),au.browser.webkit&&(a.FE.KEYCODE.ARROW_UP==g||a.FE.KEYCODE.ARROW_DOWN==g))){var h=au.selection.ranges(0).startContainer;if(h.nodeType==Node.TEXT_NODE&&(a.FE.KEYCODE.ARROW_UP==g&&h.previousSibling||a.FE.KEYCODE.ARROW_DOWN==g&&h.nextSibling)){return}j.preventDefault(),j.stopPropagation();var k=aj(a(d)),i=ay(f,k);a.FE.KEYCODE.ARROW_UP==g?aA(i,d,k):a.FE.KEYCODE.ARROW_DOWN==g&&ax(i,d,k),au.selection.restore()}}}(c)}),au.events.on("keydown",function(f){if(!1===function(i){if(i.which==a.FE.KEYCODE.TAB){var h;if(0<ao().length){h=au.$el.find(".fr-selected-cell:last")}else{var g=au.selection.element();"TD"==g.tagName||"TH"==g.tagName?h=a(g):g!=au.el&&(0<a(g).parentsUntil(au.$el,"td").length?h=a(g).parents("td:first"):0<a(g).parentsUntil(au.$el,"th").length&&(h=a(g).parents("th:first")))}if(h){return i.preventDefault(),!!(0<a(au.selection.element()).parentsUntil(au.$el,"ol, ul").length&&(0<a(au.selection.element()).parents("li").prev().length||a(au.selection.element()).is("li")&&0<a(au.selection.element()).prev().length))||(ae(),i.shiftKey?0<h.prev().length?ad(h.prev()):0<h.closest("tr").length&&0<h.closest("tr").prev().length?ad(h.closest("tr").prev().find("td:last")):0<h.closest("tbody").length&&0<h.closest("table").find("thead tr").length&&ad(h.closest("table").find("thead tr th:last")):0<h.next().length?ad(h.next()):0<h.closest("tr").length&&0<h.closest("tr").next().length?ad(h.closest("tr").next().find("td:first")):0<h.closest("thead").length&&0<h.closest("table").find("tbody tr").length?ad(h.closest("table").find("tbody tr td:first")):(h.addClass("fr-selected-cell"),aY("below"),av(),ad(h.closest("tr").next().find("td:first"))),au.selection.restore(),!1)}}}(f)){return !1}var d=ao();if(0<d.length){if(0<d.length&&au.keys.ctrlKey(f)&&f.which==a.FE.KEYCODE.A){return av(),au.popups.isVisible("table.edit")&&au.popups.hide("table.edit"),d=[],!0}if(f.which==a.FE.KEYCODE.ESC&&au.popups.isVisible("table.edit")){return av(),au.popups.hide("table.edit"),f.preventDefault(),f.stopPropagation(),f.stopImmediatePropagation(),!(d=[])}if(1<d.length&&(f.which==a.FE.KEYCODE.BACKSPACE||f.which==a.FE.KEYCODE.DELETE)){au.undo.saveStep();for(var c=0;c<d.length;c++){a(d[c]).html("<br>"),c==d.length-1&&a(d[c]).prepend(a.FE.MARKERS)}return au.selection.restore(),au.undo.saveStep(),!(d=[])}if(1<d.length&&f.which!=a.FE.KEYCODE.F10&&!au.keys.isBrowserAction(f)){return f.preventDefault(),!(d=[])}}else{if(!(d=[])===function(i){if(i.altKey&&i.which==a.FE.KEYCODE.SPACE){var h,g=au.selection.element();if("TD"==g.tagName||"TH"==g.tagName?h=g:0<a(g).closest("td").length?h=a(g).closest("td").get(0):0<a(g).closest("th").length&&(h=a(g).closest("th").get(0)),h){return i.preventDefault(),a0(h,h),aS(),!1}}}(f)){return !1}}},!0);var b=[];au.events.on("html.beforeGet",function(){b=ao();for(var c=0;c<b.length;c++){b[c].className=(b[c].className||"").replace(/fr-selected-cell/g,"")}}),au.events.on("html.afterGet",function(){for(var c=0;c<b.length;c++){b[c].className=(b[c].className?b[c].className.trim()+" ":"")+"fr-selected-cell"}b=[]}),aX(!0),aK(!0)}au.events.on("destroy",ar)},insert:function(h,d){var c,b,f="<table "+(au.opts.tableDefaultWidth?'style="width: '+au.opts.tableDefaultWidth+';" ':"")+'class="fr-inserted-table"><tbody>',i=100/d;for(c=0;c<h;c++){for(f+="<tr>",b=0;b<d;b++){f+="<td"+(au.opts.tableDefaultWidth?' style="width: '+i.toFixed(4)+'%;"':"")+">",0===c&&0===b&&(f+=a.FE.MARKERS),f+="<br></td>"}f+="</tr>"}f+="</tbody></table>",au.html.insert(f),au.selection.restore();var g=au.$el.find(".fr-inserted-table");g.removeClass("fr-inserted-table"),au.events.trigger("table.inserted",[g.get(0)])},remove:aF,insertRow:aY,deleteRow:function(){var m=ah();if(0<m.length){var u,q,h,v=aj(),g=az(v);if(0===g.min_i&&g.max_i==v.length-1){aF()}else{for(u=g.max_i;u>=g.min_i;u--){for(h=a(m.find("tr").not(m.find("table tr")).get(u)),q=0;q<v[u].length;q++){if(0===q||v[u][q]!=v[u][q-1]){var b=a(v[u][q]);if(1<parseInt(b.attr("rowspan"),10)){var d=parseInt(b.attr("rowspan"),10)-1;1==d?b.removeAttr("rowspan"):b.attr("rowspan",d)}if(u<v.length-1&&v[u][q]==v[u+1][q]&&(0===u||v[u][q]!=v[u-1][q])){for(var j=v[u][q],k=q;0<k&&v[u][k]==v[u][k-1];){k--}0===k?a(m.find("tr").not(m.find("table tr")).get(u+1)).prepend(j):a(v[u+1][k-1]).after(j)}}}var p=h.parent();h.remove(),0===p.find("tr").length&&p.remove(),v=aj(m)}ag(0,v.length-1,0,v[0].length-1,m),0<g.min_i?au.selection.setAtEnd(v[g.min_i-1][0]):au.selection.setAtEnd(v[0][0]),au.selection.restore(),au.popups.hide("table.edit")}}},insertColumn:function(h){var l=ah();if(0<l.length){var j,n=aj(),g=az(n);j="before"==h?g.min_j:g.max_j;var b,m=100/n[0].length,k=100/(n[0].length+1);l.find("th, td").each(function(){(b=a(this)).data("old-width",b.outerWidth()/l.outerWidth()*100)}),l.find("tr").not(l.find("table tr")).each(function(q){for(var f,d=a(this),c=0,i=0;c-1<j;){if(!(f=d.find("> th, > td").get(i))){f=null;break}f==n[q][c]?(c+=parseInt(a(f).attr("colspan"),10)||1,i++):(c+=parseInt(a(n[q][c]).attr("colspan"),10)||1,"after"==h&&(f=0===i?-1:d.find("> th, > td").get(i-1)))}var v,p=a(f);if("after"==h&&j<c-1||"before"==h&&0<j&&n[q][j]==n[q][j-1]){if(0===q||0<q&&n[q][j]!=n[q-1][j]){var u=parseInt(p.attr("colspan"),10)+1;p.attr("colspan",u),p.css("width",(p.data("old-width")*k/m+k).toFixed(4)+"%"),p.removeData("old-width")}}else{v=0<d.find("th").length?'<th style="width: '+k.toFixed(4)+'%;"><br></th>':'<td style="width: '+k.toFixed(4)+'%;"><br></td>',-1==f?d.prepend(v):null==f?d.append(v):"before"==h?p.before(v):"after"==h&&p.after(v)}}),l.find("th, td").each(function(){(b=a(this)).data("old-width")&&(b.css("width",(b.data("old-width")*k/m).toFixed(4)+"%"),b.removeData("old-width"))}),au.popups.isVisible("table.edit")&&aS()}},deleteColumn:function(){var h=ah();if(0<h.length){var k,j,f,m=aj(),d=az(m);if(0===d.min_j&&d.max_j==m[0].length-1){aF()}else{var b=0;for(k=0;k<m.length;k++){for(j=0;j<m[0].length;j++){(f=a(m[k][j])).hasClass("fr-selected-cell")||(f.data("old-width",f.outerWidth()/h.outerWidth()*100),(j<d.min_j||j>d.max_j)&&(b+=f.outerWidth()/h.outerWidth()*100))}}for(b/=m.length,j=d.max_j;j>=d.min_j;j--){for(k=0;k<m.length;k++){if(0===k||m[k][j]!=m[k-1][j]){if(f=a(m[k][j]),1<(parseInt(f.attr("colspan"),10)||1)){var c=parseInt(f.attr("colspan"),10)-1;1==c?f.removeAttr("colspan"):f.attr("colspan",c),f.css("width",(100*(f.data("old-width")-aQ(j,m))/b).toFixed(4)+"%"),f.removeData("old-width")}else{var g=a(f.parent().get(0));f.remove(),0===g.find("> th, > td").length&&(0===g.prev().length||0===g.next().length||g.prev().find("> th[rowspan], > td[rowspan]").length<g.prev().find("> th, > td").length)&&g.remove()}}}}ag(0,m.length-1,0,m[0].length-1,h),0<d.min_j?au.selection.setAtEnd(m[d.min_i][d.min_j-1]):au.selection.setAtEnd(m[d.min_i][0]),au.selection.restore(),au.popups.hide("table.edit"),h.find("th, td").each(function(){(f=a(this)).data("old-width")&&(f.css("width",(100*f.data("old-width")/b).toFixed(4)+"%"),f.removeData("old-width"))})}}},mergeCells:function(){if(1<ao().length&&(0===au.$el.find("th.fr-selected-cell").length||0===au.$el.find("td.fr-selected-cell").length)){aC();var k,p,m=az(aj()),g=au.$el.find(".fr-selected-cell"),q=a(g[0]),d=q.parent().find(".fr-selected-cell"),b=q.closest("table"),c=q.html(),h=0;for(k=0;k<d.length;k++){h+=a(d[k]).outerWidth()}for(q.css("width",Math.min(100,h/b.outerWidth()*100).toFixed(4)+"%"),m.min_j<m.max_j&&q.attr("colspan",m.max_j-m.min_j+1),m.min_i<m.max_i&&q.attr("rowspan",m.max_i-m.min_i+1),k=1;k<g.length;k++){"<br>"!=(p=a(g[k])).html()&&""!==p.html()&&(c+="<br>"+p.html()),p.remove()}q.html(c),au.selection.setAtEnd(q.get(0)),au.selection.restore(),au.toolbar.enable(),aN(m.min_i,m.max_i,b);var j=b.find("tr:empty");for(k=j.length-1;0<=k;k--){a(j[k]).remove()}aT(m.min_j,m.max_j,b),aS()}},splitCellVertically:function(){if(1==ao().length){var p=au.$el.find(".fr-selected-cell"),w=parseInt(p.attr("colspan"),10)||1,v=p.parent().outerWidth(),j=p.outerWidth(),x=p.clone().html("<br>"),h=aj(),b=ay(p.get(0),h);if(1<w){var g=Math.ceil(w/2);j=ac(b.col,b.col+g-1,h)/v*100;var k=ac(b.col+g,b.col+w-1,h)/v*100;1<g?p.attr("colspan",g):p.removeAttr("colspan"),1<w-g?x.attr("colspan",w-g):x.removeAttr("colspan"),p.css("width",j.toFixed(4)+"%"),x.css("width",k.toFixed(4)+"%")}else{var m;for(m=0;m<h.length;m++){if(0===m||h[m][b.col]!=h[m-1][b.col]){var u=a(h[m][b.col]);if(!u.is(p)){var q=(parseInt(u.attr("colspan"),10)||1)+1;u.attr("colspan",q)}}}j=j/v*100/2,p.css("width",j.toFixed(4)+"%"),x.css("width",j.toFixed(4)+"%")}p.after(x),av(),au.popups.hide("table.edit")}},splitCellHorizontally:function(){if(1==ao().length){var u=au.$el.find(".fr-selected-cell"),y=u.parent(),x=u.closest("table"),k=parseInt(u.attr("rowspan"),10),z=aj(),j=ay(u.get(0),z),b=u.clone().html("<br>");if(1<k){var h=Math.ceil(k/2);1<h?u.attr("rowspan",h):u.removeAttr("rowspan"),1<k-h?b.attr("rowspan",k-h):b.removeAttr("rowspan");for(var m=j.row+h,q=0===j.col?j.col:j.col-1;0<=q&&(z[m][q]==z[m][q-1]||0<m&&z[m][q]==z[m-1][q]);){q--}-1==q?a(x.find("tr").not(x.find("table tr")).get(m)).prepend(b):a(z[m][q]).after(b)}else{var w,v=a("<tr>").append(b);for(w=0;w<z[0].length;w++){if(0===w||z[j.row][w]!=z[j.row][w-1]){var g=a(z[j.row][w]);g.is(u)||g.attr("rowspan",(parseInt(g.attr("rowspan"),10)||1)+1)}}y.after(v)}av(),au.popups.hide("table.edit")}},addHeader:function(){var f=ah();if(0<f.length&&0===f.find("th").length){var d,c="<thead><tr>",b=0;for(f.find("tr:first > td").each(function(){var g=a(this);b+=parseInt(g.attr("colspan"),10)||1}),d=0;d<b;d++){c+="<th><br></th>"}c+="</tr></thead>",f.prepend(c),aS()}},removeHeader:function(){var d=ah(),c=d.find("thead");if(0<c.length){if(0===d.find("tbody tr").length){aF()}else{if(c.remove(),0<ao().length){aS()}else{au.popups.hide("table.edit");var b=d.find("tbody tr:first td:first").get(0);b&&(au.selection.setAtEnd(b),au.selection.restore())}}}},setBackground:aG,showInsertPopup:function(){var f=au.$tb.find('.fr-command[data-cmd="insertTable"]'),d=au.popups.get("table.insert");if(d||(d=aX()),!d.hasClass("fr-active")){au.popups.refresh("table.insert"),au.popups.setContainer("table.insert",au.$tb);var c=f.offset().left+f.outerWidth()/2,b=f.offset().top+(au.opts.toolbarBottom?10:f.outerHeight()-10);au.popups.show("table.insert",c,b,f.outerHeight())}},showEditPopup:aS,showColorsPopup:aU,back:function(){0<ao().length?aS():(au.popups.hide("table.insert"),au.toolbar.showInline())},verticalAlign:function(b){au.$el.find(".fr-selected-cell").css("vertical-align",b)},horizontalAlign:function(b){au.$el.find(".fr-selected-cell").css("text-align",b)},applyStyle:function(g,d,c,b){if(0<d.length){if(!c){var f=Object.keys(b);f.splice(f.indexOf(g),1),d.removeClass(f.join(" "))}d.toggleClass(g)}},selectedTable:ah,selectedCells:ao,customColor:function(){var b=au.popups.get("table.colors").find(".fr-table-colors-hex-layer input");b.length&&aG(b.val())},selectCells:a0}},a.FE.DefineIcon("insertTable",{NAME:"table"}),a.FE.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"}),a.FE.RegisterCommand("tableInsert",{callback:function(d,c,b){this.table.insert(c,b),this.popups.hide("table.insert")}}),a.FE.DefineIcon("tableHeader",{NAME:"header",FA5NAME:"heading"}),a.FE.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,toggle:!0,callback:function(){this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]').hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(c){var b=this.table.selectedTable();0<b.length&&(0===b.find("th").length?c.removeClass("fr-active").attr("aria-pressed",!1):c.addClass("fr-active").attr("aria-pressed",!0))}}),a.FE.DefineIcon("tableRows",{NAME:"bars"}),a.FE.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.tableRows.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableRows" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(c[b])+"</a></li>")}return d+="</ul>"},callback:function(c,b){"above"==b||"below"==b?this.table.insertRow(b):this.table.deleteRow()}}),a.FE.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),a.FE.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.tableColumns.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableColumns" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(c[b])+"</a></li>")}return d+="</ul>"},callback:function(c,b){"before"==b||"after"==b?this.table.insertColumn(b):this.table.deleteColumn()}}),a.FE.DefineIcon("tableCells",{NAME:"square-o",FA5NAME:"square"}),a.FE.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.tableCells.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCells" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(c[b])+"</a></li>")}return d+="</ul>"},callback:function(c,b){"merge"==b?this.table.mergeCells():"vertical-split"==b?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(c,b){1<this.$el.find(".fr-selected-cell").length?(b.find('a[data-param1="vertical-split"]').addClass("fr-disabled").attr("aria-disabled",!0),b.find('a[data-param1="horizontal-split"]').addClass("fr-disabled").attr("aria-disabled",!0),b.find('a[data-param1="merge"]').removeClass("fr-disabled").attr("aria-disabled",!1)):(b.find('a[data-param1="merge"]').addClass("fr-disabled").attr("aria-disabled",!0),b.find('a[data-param1="vertical-split"]').removeClass("fr-disabled").attr("aria-disabled",!1),b.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled").attr("aria-disabled",!1))}}),a.FE.DefineIcon("tableRemove",{NAME:"trash"}),a.FE.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),a.FE.DefineIcon("tableStyle",{NAME:"paint-brush"}),a.FE.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=this.opts.tableStyles;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableStyle" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(c[b])+"</a></li>")}return d+="</ul>"},callback:function(c,b){this.table.applyStyle(b,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(d,c){var b=this.$el.find(".fr-selected-cell").closest("table");b&&c.find(".fr-command").each(function(){var g=a(this).data("param1"),f=b.hasClass(g);a(this).toggleClass("fr-active",f).attr("aria-selected",f)})}}),a.FE.DefineIcon("tableCellBackground",{NAME:"tint"}),a.FE.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,popup:!0,callback:function(){this.table.showColorsPopup()}}),a.FE.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(c,b){this.table.setBackground(b)}}),a.FE.DefineIcon("tableBack",{NAME:"arrow-left"}),a.FE.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(b){0!==this.table.selectedCells().length||this.opts.toolbarInline?(b.removeClass("fr-hidden"),b.next(".fr-separator").removeClass("fr-hidden")):(b.addClass("fr-hidden"),b.next(".fr-separator").addClass("fr-hidden"))}}),a.FE.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v",FA5NAME:"arrows-alt-v"}),a.FE.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.tableCellVerticalAlign.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellVerticalAlign" data-param1="'+b.toLowerCase()+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(b)+"</a></li>")}return d+="</ul>"},callback:function(c,b){this.table.verticalAlign(b)},refreshOnShow:function(c,b){b.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active").attr("aria-selected",!0)}}),a.FE.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),a.FE.DefineIcon("align-left",{NAME:"align-left"}),a.FE.DefineIcon("align-right",{NAME:"align-right"}),a.FE.DefineIcon("align-center",{NAME:"align-center"}),a.FE.DefineIcon("align-justify",{NAME:"align-justify"}),a.FE.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.tableCellHorizontalAlign.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="tableCellHorizontalAlign" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.icon.create("align-"+b)+'<span class="fr-sr-only">'+this.language.translate(c[b])+"</span></a></li>")}return d+="</ul>"},callback:function(c,b){this.table.horizontalAlign(b)},refresh:function(c){var b=this.table.selectedCells();b.length&&c.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(a(b[0]))))},refreshOnShow:function(c,b){b.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active").attr("aria-selected",!0)}}),a.FE.DefineIcon("tableCellStyle",{NAME:"magic"}),a.FE.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=this.opts.tableCellStyles;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellStyle" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.language.translate(c[b])+"</a></li>")}return d+="</ul>"},callback:function(c,b){this.table.applyStyle(b,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(d,c){var b=this.$el.find(".fr-selected-cell:first");b&&c.find(".fr-command").each(function(){var g=a(this).data("param1"),f=b.hasClass(g);a(this).toggleClass("fr-active",f).attr("aria-selected",f)})}}),a.FE.RegisterCommand("tableCellBackgroundCustomColor",{title:"OK",undo:!0,callback:function(){this.table.customColor()}}),a.FE.DefineIcon("tableColorRemove",{NAME:"eraser"})});