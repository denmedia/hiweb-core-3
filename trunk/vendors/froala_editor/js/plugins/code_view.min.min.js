/*!
 * froala_editor v2.8.4 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(c,b){return b===undefined&&(b="undefined"!=typeof window?require("jquery"):require("jquery")(c)),a(b)}:a(window.jQuery)}(function(a){a.extend(a.FE.DEFAULTS,{codeMirror:window.CodeMirror,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]}),a.FE.PLUGINS.codeView=function(j){var t,r;function k(){return j.$box.hasClass("fr-code-view")}function y(){return r?r.getValue():t.val()}function o(){k()&&(r&&r.setSize(null,j.opts.height?j.opts.height:"auto"),j.opts.heightMin||j.opts.height?j.$box.find(".CodeMirror-scroll, .CodeMirror-gutters").css("min-height",j.opts.heightMin||j.opts.height):j.$box.find(".CodeMirror-scroll, .CodeMirror-gutters").css("min-height",""))}var e,n=!1;function i(){k()&&j.events.trigger("blur")}function w(){k()&&n&&j.events.trigger("focus")}function z(h){t||(!function(){t=a('<textarea class="fr-code" tabIndex="-1">'),j.$wp.append(t),t.attr("dir",j.opts.direction),j.$box.hasClass("fr-basic")||(e=a('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(j.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"></i></button>'),j.$box.append(e),j.events.bindClick(j.$box,"a.html-switch",function(){x(!1)}));var p=function(){return !k()};j.events.on("buttons.refresh",p),j.events.on("copy",p,!0),j.events.on("cut",p,!0),j.events.on("paste",p,!0),j.events.on("destroy",q,!0),j.events.on("html.set",function(){k()&&x(!0)}),j.events.on("codeView.update",o),j.events.on("form.submit",function(){k()&&(j.html.set(y()),j.events.trigger("contentChanged",[],!0))},!0)}(),!r&&j.opts.codeMirror?((r=j.opts.codeMirror.fromTextArea(t.get(0),j.opts.codeMirrorOptions)).on("blur",i),r.on("focus",w)):(j.events.$on(t,"keydown keyup change input",function(){j.opts.height?this.removeAttribute("rows"):(this.rows=1,0===this.value.length?this.style.height="auto":this.style.height=this.scrollHeight+"px")}),j.events.$on(t,"blur",i),j.events.$on(t,"focus",w))),j.undo.saveStep(),j.html.cleanEmptyTags(),j.html.cleanWhiteTags(!0),j.core.hasFocus()&&(j.core.isEmpty()||(j.selection.save(),j.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),j.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var d=j.html.get(!1,!0);j.$el.find("span.fr-tmp").remove(),j.$box.toggleClass("fr-code-view",!0);var m,c,f=!1;if(j.core.hasFocus()&&(f=!0,j.events.disableBlur(),j.$el.blur()),d=(d=d.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM")).replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),j.codeBeautifier&&(d=j.codeBeautifier.run(d,j.opts.codeBeautifierOptions)),r){m=d.indexOf("FROALA-SM"),(c=d.indexOf("FROALA-EM"))<m?m=c:c-=9;var l=(d=d.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).substring(0,m).length-d.substring(0,m).replace(/\n/g,"").length,g=d.substring(0,c).length-d.substring(0,c).replace(/\n/g,"").length;m=d.substring(0,m).length-d.substring(0,d.substring(0,m).lastIndexOf("\n")+1).length,c=d.substring(0,c).length-d.substring(0,d.substring(0,c).lastIndexOf("\n")+1).length,r.setSize(null,j.opts.height?j.opts.height:"auto"),j.opts.heightMin&&j.$box.find(".CodeMirror-scroll").css("min-height",j.opts.heightMin),r.setValue(d),n=!f,r.focus(),n=!0,r.setSelection({line:l,ch:m},{line:g,ch:c}),r.refresh(),r.clearHistory()}else{m=d.indexOf("FROALA-SM"),c=d.indexOf("FROALA-EM")-9,j.opts.heightMin&&t.css("min-height",j.opts.heightMin),j.opts.height&&t.css("height",j.opts.height),j.opts.heightMax&&t.css("max-height",j.opts.height||j.opts.heightMax),t.val(d.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var b=a(j.o_doc).scrollTop();n=!f,t.focus(),n=!0,t.get(0).setSelectionRange(m,c),a(j.o_doc).scrollTop(b)}j.$tb.find(" > .fr-command").not(h).filter(function(){return j.opts.codeViewKeepActiveButtons.indexOf(a(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0),h.addClass("fr-active").attr("aria-pressed",!0),!j.helpers.isMobile()&&j.opts.toolbarInline&&j.toolbar.hide()}function x(d){void 0===d&&(d=!k());var c,f,b=j.$tb.find('.fr-command[data-cmd="html"]');d?(j.popups.hideAll(),z(b)):(j.$box.toggleClass("fr-code-view",!1),c=b,f=y(),j.html.set(f),j.$el.blur(),j.$tb.find(" > .fr-command").not(c).removeClass("fr-disabled").attr("aria-disabled",!1),c.removeClass("fr-active").attr("aria-pressed",!1),j.selection.setAtStart(j.el),j.selection.restore(),j.placeholder.refresh(),j.undo.saveStep())}function q(){k()&&x(!1),r&&r.toTextArea(),t.val("").removeData().remove(),t=null,e&&(e.remove(),e=null)}return{_init:function(){if(!j.$wp){return !1}},toggle:x,isActive:k,get:y}},a.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),a.FE.DefineIcon("html",{NAME:"code"})});