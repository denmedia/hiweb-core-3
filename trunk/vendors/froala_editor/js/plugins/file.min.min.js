/*!
 * froala_editor v2.8.4 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(c,b){return b===undefined&&(b="undefined"!=typeof window?require("jquery"):require("jquery")(c)),a(b)}:a(window.jQuery)}(function(a){a.extend(a.FE.POPUP_TEMPLATES,{"file.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_PROGRESS_BAR_]"}),a.extend(a.FE.DEFAULTS,{fileUpload:!0,fileUploadURL:null,fileUploadParam:"file",fileUploadParams:{},fileUploadToS3:!1,fileUploadMethod:"POST",fileMaxSize:10485760,fileAllowedTypes:["*"],fileInsertButtons:["fileBack","|"],fileUseSelectedText:!1}),a.FE.PLUGINS.file=function(O){var F,G="https://i.froala.com/upload",K=2,Q=3,A=4,R=5,z=6,L={};function N(){var b=O.popups.get("file.insert");b||(b=C()),b.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),b.find(".fr-file-progress-bar-layer").addClass("fr-active"),b.find(".fr-buttons").hide(),H(O.language.translate("Uploading"),0)}function I(c){var b=O.popups.get("file.insert");b&&(b.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),b.find(".fr-file-progress-bar-layer").removeClass("fr-active"),b.find(".fr-buttons").show(),c&&(O.events.focus(),O.popups.hide("file.insert")))}function H(f,c){var b=O.popups.get("file.insert");if(b){var d=b.find(".fr-file-progress-bar-layer");d.find("h3").text(f+(c?" "+c+"%":"")),d.removeClass("fr-error"),c?(d.find("div").removeClass("fr-indeterminate"),d.find("div > span").css("width",c+"%")):d.find("div").addClass("fr-indeterminate")}}function M(f,c,b){O.edit.on(),O.events.focus(!0),O.selection.restore(),O.opts.fileUseSelectedText&&O.selection.text().length&&(c=O.selection.text()),O.html.insert('<a href="'+f+'" target="_blank" id="fr-inserted-file" class="fr-file">'+c+"</a>");var d=O.$el.find("#fr-inserted-file");d.removeAttr("id"),O.popups.hide("file.insert"),O.undo.saveStep(),x(),O.events.trigger("file.inserted",[d,b])}function J(h){var d=this.status,c=this.response,g=this.responseXML,m=this.responseText;try{if(O.opts.fileUploadToS3){if(201==d){var l=function(s){try{var o=a(s).find("Location").text(),n=a(s).find("Key").text();return !1===O.events.trigger("file.uploadedToS3",[o,n,s],!0)?(O.edit.on(),!1):o}catch(p){return j(A,s),!1}}(g);l&&M(l,h,c||g)}else{j(A,c||g)}}else{if(200<=d&&d<300){var b=function(p){try{if(!1===O.events.trigger("file.uploaded",[p],!0)){return O.edit.on(),!1}var o=JSON.parse(p);return o.link?o:(j(K,p),!1)}catch(n){return j(A,p),!1}}(m);b&&M(b.link,h,c||m)}else{j(Q,c||m)}}}catch(f){j(A,c||m)}}function T(){j(A,this.response||this.responseText||this.responseXML)}function q(c){if(c.lengthComputable){var b=c.loaded/c.total*100|0;H(O.language.translate("Uploading"),b)}}function j(c,b){O.edit.on(),function(g){N();var f=O.popups.get("file.insert").find(".fr-file-progress-bar-layer");f.addClass("fr-error");var d=f.find("h3");d.text(g),O.events.disableBlur(),d.focus()}(O.language.translate("Something went wrong. Please try again.")),O.events.trigger("file.error",[{code:c,message:L[c]},b])}function k(){O.edit.on(),I(!0)}function V(h){if(void 0!==h&&0<h.length){if(!1===O.events.trigger("file.beforeUpload",[h])){return !1}var p,g=h[0];if(null===O.opts.fileUploadURL||O.opts.fileUploadURL==G){return u=g,(f=new FileReader).addEventListener("load",function(){for(var s=f.result,n=atob(f.result.split(",")[1]),l=[],o=0;o<n.length;o++){l.push(n.charCodeAt(o))}s=window.URL.createObjectURL(new Blob([new Uint8Array(l)],{type:u.type})),O.file.insert(s,u.name,null)},!1),N(),f.readAsDataURL(u),!1}if(g.size>O.opts.fileMaxSize){return j(R),!1}if(O.opts.fileAllowedTypes.indexOf("*")<0&&O.opts.fileAllowedTypes.indexOf(g.type.replace(/file\//g,""))<0){return j(z),!1}if(O.drag_support.formdata&&(p=O.drag_support.formdata?new FormData:null),p){var b;if(!1!==O.opts.fileUploadToS3){for(b in p.append("key",O.opts.fileUploadToS3.keyStart+(new Date).getTime()+"-"+(g.name||"untitled")),p.append("success_action_status","201"),p.append("X-Requested-With","xhr"),p.append("Content-Type",g.type),O.opts.fileUploadToS3.params){O.opts.fileUploadToS3.params.hasOwnProperty(b)&&p.append(b,O.opts.fileUploadToS3.params[b])}}for(b in O.opts.fileUploadParams){O.opts.fileUploadParams.hasOwnProperty(b)&&p.append(b,O.opts.fileUploadParams[b])}p.append(O.opts.fileUploadParam,g);var d=O.opts.fileUploadURL;O.opts.fileUploadToS3&&(d=O.opts.fileUploadToS3.uploadURL?O.opts.fileUploadToS3.uploadURL:"https://"+O.opts.fileUploadToS3.region+".amazonaws.com/"+O.opts.fileUploadToS3.bucket);var c=O.core.getXHR(d,O.opts.fileUploadMethod);c.onload=function(){J.call(c,g.name)},c.onerror=T,c.upload.onprogress=q,c.onabort=k,N();var m=O.popups.get("file.insert");m&&m.off("abortUpload").on("abortUpload",function(){4!=c.readyState&&c.abort()}),c.send(p)}}var u,f}function D(){I()}function C(f){if(f){return O.popups.onHide("file.insert",D),!0}var c;O.opts.fileUpload||O.opts.fileInsertButtons.splice(O.opts.fileInsertButtons.indexOf("fileUpload"),1),c='<div class="fr-buttons">'+O.button.buildList(O.opts.fileInsertButtons)+"</div>";var b="";O.opts.fileUpload&&(b='<div class="fr-file-upload-layer fr-layer fr-active" id="fr-file-upload-layer-'+O.id+'"><strong>'+O.language.translate("Drop file")+"</strong><br>("+O.language.translate("or click")+')<div class="fr-form"><input type="file" name="'+O.opts.fileUploadParam+'" accept="/*" tabIndex="-1" aria-labelledby="fr-file-upload-layer-'+O.id+'" role="button"></div></div>');var d,h={buttons:c,upload_layer:b,progress_bar:'<div class="fr-file-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="fileDismissError" tabIndex="2" role="button">OK</button></div></div>'},g=O.popups.create("file.insert",h);return d=g,O.events.$on(d,"dragover dragenter",".fr-file-upload-layer",function(){return a(this).addClass("fr-drop"),!1},!0),O.events.$on(d,"dragleave dragend",".fr-file-upload-layer",function(){return a(this).removeClass("fr-drop"),!1},!0),O.events.$on(d,"drop",".fr-file-upload-layer",function(l){l.preventDefault(),l.stopPropagation(),a(this).removeClass("fr-drop");var i=l.originalEvent.dataTransfer;i&&i.files&&(d.data("instance")||O).file.upload(i.files)},!0),O.helpers.isIOS()&&O.events.$on(d,"touchstart",'.fr-file-upload-layer input[type="file"]',function(){a(this).trigger("click")}),O.events.$on(d,"change",'.fr-file-upload-layer input[type="file"]',function(){if(this.files){var i=d.data("instance")||O;i.events.disableBlur(),d.find("input:focus").blur(),i.events.enableBlur(),i.file.upload(this.files)}a(this).val("")},!0),g}function P(b){O.node.hasClass(b,"fr-file")}function B(f){var c=f.originalEvent.dataTransfer;if(c&&c.files&&c.files.length){var b=c.files[0];if(b&&"undefined"!=typeof b.type){if(b.type.indexOf("image")<0){if(!O.opts.fileUpload){return f.preventDefault(),f.stopPropagation(),!1}O.markers.remove(),O.markers.insertAtPoint(f.originalEvent),O.$el.find(".fr-marker").replaceWith(a.FE.MARKERS),O.popups.hideAll();var d=O.popups.get("file.insert");return d||(d=C()),O.popups.setContainer("file.insert",O.$sc),O.popups.show("file.insert",f.originalEvent.pageX,f.originalEvent.pageY),N(),V(c.files),f.preventDefault(),f.stopPropagation(),!1}}else{b.type.indexOf("image")<0&&(f.preventDefault(),f.stopPropagation())}}}function x(){var d,c=Array.prototype.slice.call(O.el.querySelectorAll("a.fr-file")),b=[];for(d=0;d<c.length;d++){b.push(c[d].getAttribute("href"))}if(F){for(d=0;d<F.length;d++){b.indexOf(F[d].getAttribute("href"))<0&&O.events.trigger("file.unlink",[F[d]])}}F=c}return L[1]="File cannot be loaded from the passed link.",L[K]="No link in upload response.",L[Q]="Error during file upload.",L[A]="Parsing response failed.",L[R]="File is too large.",L[z]="File file type is invalid.",L[7]="Files can be uploaded only to same domain in IE 8 and IE 9.",{_init:function(){O.events.on("drop",B),O.events.$on(O.$win,"keydown",function(d){var c=d.which,b=O.popups.get("file.insert");b&&c==a.FE.KEYCODE.ESC&&b.trigger("abortUpload")}),O.events.on("destroy",function(){var b=O.popups.get("file.insert");b&&b.trigger("abortUpload")}),O.events.on("link.beforeRemove",P),O.$wp&&(x(),O.events.on("contentChanged",x)),C(!0)},showInsertPopup:function(){var f=O.$tb.find('.fr-command[data-cmd="insertFile"]'),c=O.popups.get("file.insert");if(c||(c=C()),I(),!c.hasClass("fr-active")){if(O.popups.refresh("file.insert"),O.popups.setContainer("file.insert",O.$tb),f.is(":visible")){var b=f.offset().left+f.outerWidth()/2,d=f.offset().top+(O.opts.toolbarBottom?10:f.outerHeight()-10);O.popups.show("file.insert",b,d,f.outerHeight())}else{O.position.forSelection(c),O.popups.show("file.insert")}}},upload:V,insert:M,back:function(){O.events.disableBlur(),O.selection.restore(),O.events.enableBlur(),O.popups.hide("file.insert"),O.toolbar.showInline()},hideProgressBar:I}},a.FE.DefineIcon("insertFile",{NAME:"file-o",FA5NAME:"file"}),a.FE.RegisterCommand("insertFile",{title:"Upload File",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("file.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("file.insert")):this.file.showInsertPopup()},plugin:"file"}),a.FE.DefineIcon("fileBack",{NAME:"arrow-left"}),a.FE.RegisterCommand("fileBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.file.back()},refresh:function(b){this.opts.toolbarInline?(b.removeClass("fr-hidden"),b.next(".fr-separator").removeClass("fr-hidden")):(b.addClass("fr-hidden"),b.next(".fr-separator").addClass("fr-hidden"))}}),a.FE.RegisterCommand("fileDismissError",{title:"OK",callback:function(){this.file.hideProgressBar(!0)}})});