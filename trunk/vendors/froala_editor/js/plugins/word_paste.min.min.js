/*!
 * froala_editor v2.8.4 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(c,b){return b===undefined&&(b="undefined"!=typeof window?require("jquery"):require("jquery")(c)),a(b)}:a(window.jQuery)}(function(a){a.extend(a.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style","text-indent"],wordPasteModal:!0}),a.FE.PLUGINS.wordPaste=function(r){var z,B,H="word_paste";function o(g){var c=r.opts.wordAllowedStyleProps;g||(r.opts.wordAllowedStyleProps=[]),0===B.indexOf("<colgroup>")&&(B="<table>"+B+"</table>"),B=function(w,C){!function(N){for(var L=N.split("v:shape"),M=1;M<L.length;M++){var K=L[M],O=K.split(' id="')[1];if(O&&1<O.length){O=O.split('"')[0];var J=K.split(' o:spid="')[1];J&&1<J.length&&(J=J.split('"')[0],G[O]=J)}}}(w=w.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/i,"$1"));var h=(new DOMParser).parseFromString(w,"text/html"),v=h.head,p=h.body,A=function(P){var S={},J=P.getElementsByTagName("style");if(J.length){var N=J[0],L=N.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(L){for(var M=0;M<L.length;M++){var R=L[M],T=R.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),K=R.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");T=T.replace(/^[\s]|[\s]$/gm,""),K=K.replace(/^[\s]|[\s]$/gm,""),T=T.replace(/\n|\r|\n\r/g,""),K=K.replace(/\n|\r|\n\r/g,"");for(var Q=T.split(", "),O=0;O<Q.length;O++){S[Q[O]]=K}}}}return S}(v);E(p,function(i){if(i.nodeType==Node.TEXT_NODE&&/\n|\u00a0|\r/.test(i.data)){if(!/\S| /.test(i.data)){return i.data==a.FE.UNICODE_NBSP?(i.data="\u200b",!0):1==i.data.length&&10==i.data.charCodeAt(0)?(i.data=" ",!0):(e(i),!1)}i.data=i.data.replace(/\n|\r/gi," ")}return !0}),E(p,function(i){return i.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=i.tagName&&"IMG"!=i.tagName||function(P,M){if(!M){return}var O;if("IMG"==P.tagName){var L=P.getAttribute("src");if(!L||-1==L.indexOf("file://")){return}if(0===L.indexOf("file://")&&r.helpers.isURL(P.getAttribute("alt"))){return P.setAttribute("src",P.getAttribute("alt"))}(O=G[P.getAttribute("v:shapes")])||(O=P.getAttribute("v:shapes"))}else{O=P.parentNode.getAttribute("o:spid")}if(P.removeAttribute("height"),!O){return}Q=M,s={},n(Q,"i","\\shppict"),n(Q,"s","\\shp{");var Q;var K=s[O.substring(7)];if(K){var J=function(T){for(var R=T.match(/[0-9a-f]{2}/gi),S=[],l=0;l<R.length;l++){S.push(String.fromCharCode(parseInt(R[l],16)))}var U=S.join("");return btoa(U)}(K.image_hex),N="data:"+K.image_type+";base64,"+J;"IMG"===P.tagName?(P.src=N,P.setAttribute("data-fr-image-pasted",!0)):a(P.parentNode).before('<img data-fr-image-pasted="true" src="'+N+'" style="'+P.parentNode.getAttribute("style")+'">').remove()}}(i,C),!0});for(var u=p.querySelectorAll("ul > ul, ul > ol, ol > ul, ol > ol"),I=u.length-1;0<=I;I--){u[I].previousElementSibling&&"LI"===u[I].previousElementSibling.tagName&&u[I].previousElementSibling.appendChild(u[I])}E(p,function(L){if(L.nodeType==Node.TEXT_NODE){return L.data=L.data.replace(/<br>(\n|\r)/gi,"<br>"),!1}if(L.nodeType==Node.ELEMENT_NODE){if(q(L)){var M=L.parentNode,K=L.previousSibling,O=function N(ab,P){var U=/[0-9a-zA-Z]./gi;var S=!1;ab.firstElementChild&&ab.firstElementChild.firstElementChild&&ab.firstElementChild.firstElementChild.firstChild&&!(S=S||U.test(ab.firstElementChild.firstElementChild.firstChild.data||""))&&ab.firstElementChild.firstElementChild.firstElementChild&&ab.firstElementChild.firstElementChild.firstElementChild.firstChild&&(S=S||U.test(ab.firstElementChild.firstElementChild.firstElementChild.firstChild.data||""));var T=S?"ol":"ul";var Z=x(ab);var ac="<"+T+"><li>"+D(ab,P);var R=ab.nextElementSibling;var X=ab.parentNode;e(ab);ab=null;for(;R&&q(R);){var V=R.previousElementSibling,aa=x(R);if(Z<aa){ac+=N(R,P).outerHTML}else{if(aa<Z){break}ac+="</li><li>"+D(R,P)}if(Z=aa,R.previousElementSibling||R.nextElementSibling||R.parentNode){var W=R;R=R.nextElementSibling,e(W),W=null}else{R=V?V.nextElementSibling:X.firstElementChild}}ac+="</li></"+T+">";var Q=document.createElement("div");Q.innerHTML=ac;var Y=Q.firstElementChild;return Y}(L,A),J=null;return(J=K?K.nextSibling:M.firstChild)?M.insertBefore(O,J):M.appendChild(O),!1}return F(L,A)}return L.nodeType!=Node.COMMENT_NODE||(e(L),!1)}),E(p,function(J){if(J.nodeType==Node.ELEMENT_NODE){var i=J.tagName;if(!J.innerHTML&&-1==["BR","IMG"].indexOf(i)){for(var l=J.parentNode;l&&(e(J),!(J=l).innerHTML);){l=J.parentNode}return !1}!function(Q){var T=Q.getAttribute("style");if(!T){return}(T=j(T))&&";"!=T.slice(-1)&&(T+=";");var K=T.match(/(^|\S+?):.+?;{1,1}/gi);if(!K){return}for(var O={},M=0;M<K.length;M++){var N=K[M],S=N.split(":");2==S.length&&("text-align"==S[0]&&"SPAN"==Q.tagName||(O[S[0]]=S[1]))}var U="";for(var L in O){if(O.hasOwnProperty(L)){if("font-size"==L&&"pt;"==O[L].slice(-3)){var R=null;try{R=parseFloat(O[L].slice(0,-3),10)}catch(P){}R&&(R=Math.round(1.33*R),O[L]=R+"px;")}U+=L+":"+O[L]}}U&&Q.setAttribute("style",U)}(J)}return !0});var m=p.outerHTML,y=r.opts.htmlAllowedStyleProps;return r.opts.htmlAllowedStyleProps=r.opts.wordAllowedStyleProps,m=r.clean.html(m,r.opts.wordDeniedTags,r.opts.wordDeniedAttrs,!1),r.opts.htmlAllowedStyleProps=y,m}(B=B.replace(/<span[\n\r ]*style='mso-spacerun:yes'>([\r\n\u00a0 ]*)<\/span>/g,function(p,l){for(var m="",h=0;h++<l.length;){m+="&nbsp;"}return m}),r.paste.getRtfClipboard());var f=r.doc.createElement("DIV");f.innerHTML=B,r.html.cleanBlankSpaces(f),B=f.innerHTML,B=(B=r.paste.cleanEmptyTagsAndDivs(B)).replace(/\u200b/g,""),r.modals.hide(H),r.paste.clean(B,!0,!0),r.opts.wordAllowedStyleProps=c}function e(c){c.parentNode&&c.parentNode.removeChild(c)}function E(h,f){if(f(h)){for(var g=h.firstChild;g;){var c=g,l=g.previousSibling;g=g.nextSibling,E(c,f),c.previousSibling||c.nextSibling||c.parentNode||!g||l==g.previousSibling||!g.parentNode?c.previousSibling||c.nextSibling||c.parentNode||!g||g.previousSibling||g.nextSibling||g.parentNode||(l?g=l.nextSibling?l.nextSibling.nextSibling:null:h.firstChild&&(g=h.firstChild.nextSibling)):g=l?l.nextSibling:h.firstChild}}}function q(f){if(!f.getAttribute("style")||!/mso-list:[\s]*l/gi.test(f.getAttribute("style").replace(/\n/gi,""))){return !1}try{if(!f.querySelector('[style="mso-list:Ignore"]')){return !1}}catch(c){return !1}return !0}function x(c){return c.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function D(h,f){var g=h.cloneNode(!0);if(-1!=["H1","H2","H3","H4","H5","H6"].indexOf(h.tagName)){var c=document.createElement(h.tagName.toLowerCase());c.setAttribute("style",h.getAttribute("style")),c.innerHTML=g.innerHTML,g.innerHTML=c.outerHTML}E(g,function(i){return i.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==i.getAttribute("style")&&i.parentNode.removeChild(i),F(i,f)),!0});var l=g.innerHTML;return l=l.replace(/<!--[\s\S]*?-->/gi,"")}function k(h,f){for(var g=document.createElement(f),c=0;c<h.attributes.length;c++){var l=h.attributes[c].name;g.setAttribute(l,h.getAttribute(l))}return g.innerHTML=h.innerHTML,h.parentNode.replaceChild(g,h),g}function d(f){var c=f.getAttribute("align");c&&(f.style["text-align"]=c,f.removeAttribute("align"))}function j(c){return c.replace(/\n|\r|\n\r|&quot;/g,"")}function b(h,f,g){if(f){var c=h.getAttribute("style");c&&";"!=c.slice(-1)&&(c+=";"),f&&";"!=f.slice(-1)&&(f+=";"),f=f.replace(/\n/gi,"");var l=null;l=g?(c||"")+f:f+(c||""),h.setAttribute("style",l)}}var s=null;function n(A,K,c){for(var v=A.split(c),m=1;m<v.length;m++){var p=v[m];if(1<(p=p.split("shplid")).length){p=p[1];for(var I="",L=0;L<p.length&&"\\"!=p[L]&&"{"!=p[L]&&" "!=p[L]&&"\r"!=p[L]&&"\n"!=p[L];){I+=p[L],L++}var h=p.split("bliptag");if(h&&h.length<2){continue}var C=null;if(-1!=h[0].indexOf("pngblip")?C="image/png":-1!=h[0].indexOf("jpegblip")&&(C="image/jpeg"),!C){continue}var w,J=h[1].split("}");if(J&&J.length<2){continue}if(2<J.length&&-1!=J[0].indexOf("blipuid")){w=J[1].split(" ")}else{if((w=J[0].split(" "))&&w.length<2){continue}w.shift()}var y=w.join("");s[K+I]={image_hex:y,image_type:C}}}}function F(L,Q){var h=L.tagName,I=h.toLowerCase();L.firstElementChild&&("I"==L.firstElementChild.tagName?k(L.firstElementChild,"em"):"B"==L.firstElementChild.tagName&&k(L.firstElementChild,"strong"));if(-1!=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(h)){return e(L),!1}var y=-1,C=["META","LINK","XML","ST1:","O:","W:","FONT"];for(y=0;y<C.length;y++){if(-1!=h.indexOf(C[y])){return L.innerHTML&&(L.outerHTML=L.innerHTML),e(L),!1}}if("TD"!=h){var O=L.getAttribute("class");if(Q&&O){var R=(O=j(O)).split(" ");for(y=0;y<R.length;y++){var w=[],M="."+R[y];w.push(M),M=I+M,w.push(M);for(var J=0;J<w.length;J++){Q[w[J]]&&b(L,Q[w[J]])}}L.removeAttribute("class")}Q&&Q[I]&&b(L,Q[I])}if(-1!=["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(h)){var P=L.getAttribute("class");if(P&&(Q&&Q[h.toLowerCase()+"."+P]&&b(L,Q[h.toLowerCase()+"."+P]),-1!=P.toLowerCase().indexOf("mso"))){var K=j(P);(K=K.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""))?L.setAttribute("class",K):L.removeAttribute("class")}var v=L.getAttribute("style");if(v){var N=v.match(/text-align:.+?[; "]{1,1}/gi);N&&N[N.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}d(L)}if("TR"==h&&function(ah,V){r.node.clearAttributes(ah);for(var X=ah.firstElementChild,ad=0,aa=!1,ac=null;X;){X.firstElementChild&&-1!=X.firstElementChild.tagName.indexOf("W:")&&(X.innerHTML=X.firstElementChild.innerHTML),(ac=X.getAttribute("width"))||aa||(aa=!0),ad+=parseInt(ac,10),(!X.firstChild||X.firstChild&&X.firstChild.data==a.FE.UNICODE_NBSP)&&(X.firstChild&&e(X.firstChild),X.innerHTML="<br>");for(var al=X.firstElementChild,W=1==X.children.length;al;){"P"!=al.tagName||q(al)||W&&d(al),al=al.nextElementSibling}if(V){var Z=X.getAttribute("class");if(Z){var ai=(Z=j(Z)).match(/xl[0-9]+/gi);if(ai){var af="."+ai[0];V[af]&&b(X,V[af])}}V.td&&b(X,V.td)}var T=X.getAttribute("style");T&&(T=j(T))&&";"!=T.slice(-1)&&(T+=";");var ag=X.getAttribute("valign");if(!ag&&T){var Y=T.match(/vertical-align:.+?[; "]{1,1}/gi);Y&&(ag=Y[Y.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var aj=null;if(T){var ab=T.match(/text-align:.+?[; "]{1,1}/gi);ab&&(aj=ab[ab.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==aj&&(aj=null)}var ae=null;if(T){var S=T.match(/background:.+?[; "]{1,1}/gi);S&&(ae=S[S.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var ak=X.getAttribute("colspan"),U=X.getAttribute("rowspan");ak&&X.setAttribute("colspan",ak),U&&X.setAttribute("rowspan",U),ag&&(X.style["vertical-align"]=ag),aj&&(X.style["text-align"]=aj),ae&&(X.style["background-color"]=ae),ac&&X.setAttribute("width",ac),X=X.nextElementSibling}for(X=ah.firstElementChild;X;){ac=X.getAttribute("width"),aa?X.removeAttribute("width"):X.setAttribute("width",100*parseInt(ac,10)/ad+"%"),X=X.nextElementSibling}}(L,Q),"A"!=h||L.attributes.getNamedItem("href")||L.attributes.getNamedItem("name")||!L.innerHTML||(L.outerHTML=L.innerHTML),"TD"!=h&&"TH"!=h||L.innerHTML||(L.innerHTML="<br>"),"TABLE"==h&&(L.style.width="100%"),L.getAttribute("lang")&&L.removeAttribute("lang"),L.getAttribute("style")&&-1!=L.getAttribute("style").toLowerCase().indexOf("mso")){var A=j(L.getAttribute("style"));(A=A.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""))?L.setAttribute("style",A):L.removeAttribute("style")}return !0}var G={};return{_init:function(){r.events.on("paste.wordPaste",function(c){return B=c,r.opts.wordPasteModal?function(){if(!z){var l='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+r.language.translate("Word Paste Detected")+"</h4>",g=(m='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">',m+='<p style="text-align: left;">'+r.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",m+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+r.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+r.language.translate("Keep")+"</button></div>",m+="</div>"),h=r.modals.create(H,l,g),f=h.$body;z=h.$modal,h.$modal.addClass("fr-middle"),r.events.bindClick(f,"button.fr-remove-word",function(){var i=z.data("instance")||r;i.wordPaste.clean()}),r.events.bindClick(f,"button.fr-keep-word",function(){var i=z.data("instance")||r;i.wordPaste.clean(!0)}),r.events.$on(a(r.o_win),"resize",function(){r.modals.resize(H)})}var m;r.modals.show(H),r.modals.resize(H)}():o(!0),!1})},clean:o}}});