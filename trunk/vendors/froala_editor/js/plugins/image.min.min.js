/*!
 * froala_editor v2.8.4 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2018 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(c,a){return a===undefined&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(c)),b(a)}:b(window.jQuery)}(function(a){a.extend(a.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),a.extend(a.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageCaption","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUpload:!0,imageUploadURL:null,imageCORSProxy:"https://cors-anywhere.froala.com",imageUploadRemoteUrls:!0,imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered","fr-shadow":"Shadow"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5}),a.FE.PLUGINS.image=function(aq){var aC,aw,aD,aF,ar,aJ,ak="https://i.froala.com/upload",al=!1,az=1,aG=2,au=3,aA=4,aj=5,aI=6,ag=8,an={};function ai(){var b=aq.popups.get("image.insert").find(".fr-image-by-url-layer input");b.val(""),aC&&b.val(aC.attr("src")),b.trigger("change")}function at(){var f=aq.popups.get("image.edit");if(f||(f=bk()),f){var d=ad();aS()&&(d=d.find(".fr-img-wrap")),aq.popups.setContainer("image.edit",aq.$sc),aq.popups.refresh("image.edit");var b=d.offset().left+d.outerWidth()/2,c=d.offset().top+d.outerHeight();aq.popups.show("image.edit",b,c,d.outerHeight())}}function a9(){a8()}function aE(){for(var g,d,b="IMG"==aq.el.tagName?[aq.el]:aq.el.querySelectorAll("img"),c=0;c<b.length;c++){var f=a(b[c]);!aq.opts.htmlUntouched&&aq.opts.useClasses?((aq.opts.imageDefaultAlign||aq.opts.imageDefaultDisplay)&&(0<(d=f).parents(".fr-img-caption").length&&(d=d.parents(".fr-img-caption:first")),d.hasClass("fr-dii")||d.hasClass("fr-dib")||(d.addClass("fr-fi"+ab(d)[0]),d.addClass("fr-di"+aH(d)[0]),d.css("margin",""),d.css("float",""),d.css("display",""),d.css("z-index",""),d.css("position",""),d.css("overflow",""),d.css("vertical-align",""))),aq.opts.imageTextNear||(0<f.parents(".fr-img-caption").length?f.parents(".fr-img-caption:first").removeClass("fr-dii").addClass("fr-dib"):f.removeClass("fr-dii").addClass("fr-dib"))):aq.opts.htmlUntouched||aq.opts.useClasses||(aq.opts.imageDefaultAlign||aq.opts.imageDefaultDisplay)&&(0<(g=f).parents(".fr-img-caption").length&&(g=g.parents(".fr-img-caption:first")),bh(g,g.hasClass("fr-dib")?"block":g.hasClass("fr-dii")?"inline":null,g.hasClass("fr-fil")?"left":g.hasClass("fr-fir")?"right":ab(g)),g.removeClass("fr-dib fr-dii fr-fir fr-fil")),aq.opts.iframe&&f.on("load",aq.size.syncIframe)}}function bc(h){void 0===h&&(h=!0);var d,b=Array.prototype.slice.call(aq.el.querySelectorAll("img")),c=[];for(d=0;d<b.length;d++){if(c.push(b[d].getAttribute("src")),a(b[d]).toggleClass("fr-draggable",aq.opts.imageMove),""===b[d].getAttribute("class")&&b[d].removeAttribute("class"),""===b[d].getAttribute("style")&&b[d].removeAttribute("style"),b[d].parentNode&&b[d].parentNode.parentNode&&aq.node.hasClass(b[d].parentNode.parentNode,"fr-img-caption")){var g=b[d].parentNode.parentNode;aq.browser.mozilla||g.setAttribute("contenteditable",!1),g.setAttribute("draggable",!1),g.classList.add("fr-draggable");var j=b[d].nextSibling;j&&j.setAttribute("contenteditable",!0)}}if(ar){for(d=0;d<ar.length;d++){c.indexOf(ar[d].getAttribute("src"))<0&&aq.events.trigger("image.removed",[a(ar[d])])}}if(ar&&h){var f=[];for(d=0;d<ar.length;d++){f.push(ar[d].getAttribute("src"))}for(d=0;d<b.length;d++){f.indexOf(b[d].getAttribute("src"))<0&&aq.events.trigger("image.loaded",[a(b[d])])}}ar=b}function bf(){if(aw||function(){var j;aq.shared.$image_resizer?(aw=aq.shared.$image_resizer,aF=aq.shared.$img_overlay,aq.events.on("destroy",function(){aw.removeClass("fr-active").appendTo(a("body:first"))},!0)):(aq.shared.$image_resizer=a('<div class="fr-image-resizer"></div>'),aw=aq.shared.$image_resizer,aq.events.$on(aw,"mousedown",function(i){i.stopPropagation()},!0),aq.opts.imageResize&&(aw.append(am("nw")+am("ne")+am("sw")+am("se")),aq.shared.$img_overlay=a('<div class="fr-image-overlay"></div>'),aF=aq.shared.$img_overlay,j=aw.get(0).ownerDocument,a(j).find("body:first").append(aF)));aq.events.on("shared.destroy",function(){aw.html("").removeData().remove(),aw=null,aq.opts.imageResize&&(aF.remove(),aF=null)},!0),aq.helpers.isMobile()||aq.events.$on(a(aq.o_win),"resize",function(){aC&&!aC.hasClass("fr-uploading")?aB(!0):aC&&(bf(),ao(),a4(!1))});if(aq.opts.imageResize){j=aw.get(0).ownerDocument,aq.events.$on(aw,aq._mousedown,".fr-handler",aT),aq.events.$on(a(j),aq._mousemove,ba),aq.events.$on(a(j.defaultView||j.parentWindow),aq._mouseup,ah),aq.events.$on(aF,"mouseleave",ah);var g=1,h=null,k=0;aq.events.on("keydown",function(m){if(aC){var l=-1!=navigator.userAgent.indexOf("Mac OS X")?m.metaKey:m.ctrlKey,i=m.which;(i!==h||200<m.timeStamp-k)&&(g=1),(i==a.FE.KEYCODE.EQUALS||aq.browser.mozilla&&i==a.FE.KEYCODE.FF_EQUALS)&&l&&!m.altKey?g=aV.call(this,m,1,1,g):(i==a.FE.KEYCODE.HYPHEN||aq.browser.mozilla&&i==a.FE.KEYCODE.FF_HYPHEN)&&l&&!m.altKey?g=aV.call(this,m,2,-1,g):aq.keys.ctrlKey(m)||i!=a.FE.KEYCODE.ENTER||(aC.before("<br>"),bd(aC)),h=i,k=m.timeStamp}},!0),aq.events.on("keyup",function(){g=1})}}(),!aC){return !1}var f=aq.$wp||aq.$sc;f.append(aw),aw.data("instance",aq);var d=f.scrollTop()-("static"!=f.css("position")?f.offset().top:0),b=f.scrollLeft()-("static"!=f.css("position")?f.offset().left:0);b-=aq.helpers.getPX(f.css("border-left-width")),d-=aq.helpers.getPX(f.css("border-top-width")),aq.$el.is("img")&&aq.$sc.is("body")&&(b=d=0);var c=ad();aS()&&(c=c.find(".fr-img-wrap")),aw.css("top",(aq.opts.iframe?c.offset().top:c.offset().top+d)-1).css("left",(aq.opts.iframe?c.offset().left:c.offset().left+b)-1).css("width",c.get(0).getBoundingClientRect().width).css("height",c.get(0).getBoundingClientRect().height).addClass("fr-active")}function am(b){return'<div class="fr-handler fr-h'+b+'"></div>'}function aU(b){aS()?aC.parents(".fr-img-caption").css("width",b):aC.css("width",b)}function aT(h){if(!aq.core.sameInstance(aw)){return !0}if(h.preventDefault(),h.stopPropagation(),aq.$el.find("img.fr-error").left){return !1}aq.undo.canDo()||aq.undo.saveStep();var d=h.pageX||h.originalEvent.touches[0].pageX;if("mousedown"==h.type){var b=aq.$oel.get(0).ownerDocument,c=b.defaultView||b.parentWindow,g=!1;try{g=c.location!=c.parent.location&&!(c.$&&c.$.FE)}catch(j){}g&&c.frameElement&&(d+=aq.helpers.getPX(a(c.frameElement).offset().left)+c.frameElement.clientLeft)}(aD=a(this)).data("start-x",d),aD.data("start-width",aC.width()),aD.data("start-height",aC.height());var k=aC.width();if(aq.opts.imageResizeWithPercent){var f=aC.parentsUntil(aq.$el,aq.html.blockTagsQuery()).get(0)||aq.el;k=(k/a(f).outerWidth()*100).toFixed(2)+"%"}aU(k),aF.show(),aq.popups.hideAll(),ac()}function ba(g){if(!aq.core.sameInstance(aw)){return !0}var d;if(aD&&aC){if(g.preventDefault(),aq.$el.find("img.fr-error").left){return !1}var b=g.pageX||(g.originalEvent.touches?g.originalEvent.touches[0].pageX:null);if(!b){return !1}var c=b-aD.data("start-x"),f=aD.data("start-width");if((aD.hasClass("fr-hnw")||aD.hasClass("fr-hsw"))&&(c=0-c),aq.opts.imageResizeWithPercent){var h=aC.parentsUntil(aq.$el,aq.html.blockTagsQuery()).get(0)||aq.el;f=((f+c)/a(h).outerWidth()*100).toFixed(2),aq.opts.imageRoundPercent&&(f=Math.round(f)),aU(f+"%"),(d=aS()?(aq.helpers.getPX(aC.parents(".fr-img-caption").css("width"))/a(h).outerWidth()*100).toFixed(2):(aq.helpers.getPX(aC.css("width"))/a(h).outerWidth()*100).toFixed(2))===f||aq.opts.imageRoundPercent||aU(d+"%"),aC.css("height","").removeAttr("height")}else{f+c>=aq.opts.imageMinWidth&&(aU(f+c),d=aS()?aq.helpers.getPX(aC.parents(".fr-img-caption").css("width")):aq.helpers.getPX(aC.css("width"))),d!==f+c&&aU(d),((aC.attr("style")||"").match(/(^height:)|(; *height:)/)||aC.attr("height"))&&(aC.css("height",aD.data("start-height")*aC.width()/aD.data("start-width")),aC.removeAttr("height"))}bf(),aq.events.trigger("image.resize",[aY()])}}function ah(b){if(!aq.core.sameInstance(aw)){return !0}if(aD&&aC){if(b&&b.stopPropagation(),aq.$el.find("img.fr-error").left){return !1}aD=null,aF.hide(),bf(),at(),aq.undo.saveStep(),aq.events.trigger("image.resizeEnd",[aY()])}}function aQ(d,c,b){aq.edit.on(),aC&&aC.addClass("fr-error"),function(h){a4();var g=aq.popups.get("image.insert").find(".fr-image-progress-bar-layer");g.addClass("fr-error");var f=g.find("h3");f.text(h),aq.events.disableBlur(),f.focus()}(aq.language.translate("Something went wrong. Please try again.")),!aC&&b&&a3(b),aq.events.trigger("image.error",[{code:d,message:an[d]},c,b])}function bk(d){if(d){return aq.$wp&&aq.events.$on(aq.$wp,"scroll",function(){aC&&aq.popups.isVisible("image.edit")&&(aq.events.disableBlur(),bd(aC))}),!0}var c="";if(0<aq.opts.imageEditButtons.length){c+='<div class="fr-buttons">',c+=aq.button.buildList(aq.opts.imageEditButtons);var b={buttons:c+="</div>"};return aq.popups.create("image.edit",b)}return !1}function a4(g){var d=aq.popups.get("image.insert");if(d||(d=a6()),d.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),d.find(".fr-image-progress-bar-layer").addClass("fr-active"),d.find(".fr-buttons").hide(),aC){var b=ad();aq.popups.setContainer("image.insert",aq.$sc);var c=b.offset().left+b.width()/2,f=b.offset().top+b.height();aq.popups.show("image.insert",c,f,b.outerHeight())}void 0===g&&ax(aq.language.translate("Uploading"),0)}function a8(d){var c=aq.popups.get("image.insert");if(c&&(c.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),c.find(".fr-image-progress-bar-layer").removeClass("fr-active"),c.find(".fr-buttons").show(),d||aq.$el.find("img.fr-error").length)){if(aq.events.focus(),aq.$el.find("img.fr-error").length&&(aq.$el.find("img.fr-error").remove(),aq.undo.saveStep(),aq.undo.run(),aq.undo.dropRedo()),!aq.$wp&&aC){var b=aC;aB(!0),aq.selection.setAfter(b.get(0)),aq.selection.restore()}aq.popups.hide("image.insert")}}function ax(f,d){var b=aq.popups.get("image.insert");if(b){var c=b.find(".fr-image-progress-bar-layer");c.find("h3").text(f+(d?" "+d+"%":"")),c.removeClass("fr-error"),d?(c.find("div").removeClass("fr-indeterminate"),c.find("div > span").css("width",d+"%")):c.find("div").addClass("fr-indeterminate")}}function bd(b){bj.call(b.get(0))}function aX(){var b=a(this);aq.popups.hide("image.insert"),b.removeClass("fr-uploading"),b.next().is("br")&&b.next().remove(),bd(b),aq.events.trigger("image.loaded",[b])}function aW(d,h,i,b,g){aq.edit.off(),ax(aq.language.translate("Loading image")),h&&(d=aq.helpers.sanitizeURL(d));var c=new Image;c.onload=function(){var m,k;if(b){aq.undo.canDo()||b.hasClass("fr-uploading")||aq.undo.saveStep();var f=b.data("fr-old-src");b.data("fr-image-pasted")&&(f=null),aq.$wp?((m=b.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted")).off("load"),f&&b.attr("src",f),b.replaceWith(m)):m=b;for(var j=m.get(0).attributes,l=0;l<j.length;l++){var o=j[l];0===o.nodeName.indexOf("data-")&&m.removeAttr(o.nodeName)}if(void 0!==i){for(k in i){i.hasOwnProperty(k)&&"link"!=k&&m.attr("data-"+k,i[k])}}m.on("load",aX),m.attr("src",d),aq.edit.on(),bc(!1),aq.undo.saveStep(),aq.events.disableBlur(),aq.$el.blur(),aq.events.trigger(f?"image.replaced":"image.inserted",[m,g])}else{m=a0(d,i,aX),bc(!1),aq.undo.saveStep(),aq.events.disableBlur(),aq.$el.blur(),aq.events.trigger("image.inserted",[m,g])}},c.onerror=function(){aQ(az)},a4(aq.language.translate("Loading image")),c.src=d}function aZ(h){ax(aq.language.translate("Loading image"));var d=this.status,b=this.response,c=this.responseXML,g=this.responseText;try{if(aq.opts.imageUploadToS3){if(201==d){var k=function(o){try{var n=a(o).find("Location").text(),l=a(o).find("Key").text();return !1===aq.events.trigger("image.uploadedToS3",[n,l,o],!0)?(aq.edit.on(),!1):n}catch(m){return aQ(aA,o),!1}}(c);k&&aW(k,!1,[],h,b||c)}else{aQ(aA,b||c,h)}}else{if(200<=d&&d<300){var f=function(m){try{if(!1===aq.events.trigger("image.uploaded",[m],!0)){return aq.edit.on(),!1}var l=JSON.parse(m);return l.link?l:(aQ(aG,m),!1)}catch(i){return aQ(aA,m),!1}}(g);f&&aW(f.link,!1,f,h,b||g)}else{aQ(au,b||g,h)}}}catch(j){aQ(aA,b||g,h)}}function aR(){aQ(aA,this.response||this.responseText||this.responseXML)}function a1(c){if(c.lengthComputable){var b=c.loaded/c.total*100|0;ax(aq.language.translate("Uploading"),b)}}function a0(h,d,b){var c,g="";if(d&&void 0!==d){for(c in d){d.hasOwnProperty(c)&&"link"!=c&&(g+=" data-"+c+'="'+d[c]+'"')}}var k=aq.opts.imageDefaultWidth;k&&"auto"!=k&&(k+=aq.opts.imageResizeWithPercent?"%":"px");var f=a('<img src="'+h+'"'+g+(k?' style="width: '+k+';"':"")+">");bh(f,aq.opts.imageDefaultDisplay,aq.opts.imageDefaultAlign),f.on("load",b),f.on("error",function(){a(this).addClass("fr-error"),aQ(ag)}),aq.edit.on(),aq.events.focus(!0),aq.selection.restore(),aq.undo.saveStep(),aq.opts.imageSplitHTML?aq.markers.split():aq.markers.insert(),aq.html.wrap();var j=aq.$el.find(".fr-marker");return j.length?(j.parent().is("hr")&&j.parent().after(j),aq.node.isLastSibling(j)&&j.parent().hasClass("fr-deletable")&&j.insertAfter(j.parent()),j.replaceWith(f)):aq.$el.append(f),aq.selection.clear(),f}function af(){aq.edit.on(),a8(!0)}function aK(h,k){if(void 0!==h&&0<h.length){if(!1===aq.events.trigger("image.beforeUpload",[h,k])){return !1}var j,g=h[0];if(null===aq.opts.imageUploadURL||aq.opts.imageUploadURL==ak){return m=g,c=k||aC,(f=new FileReader).addEventListener("load",function(){var p=f.result;if(f.result.indexOf("svg+xml")<0){for(var o=atob(f.result.split(",")[1]),l=[],n=0;n<o.length;n++){l.push(o.charCodeAt(n))}p=window.URL.createObjectURL(new Blob([new Uint8Array(l)],{type:m.type})),aq.image.insert(p,!1,null,c)}},!1),a4(),f.readAsDataURL(m),!1}if(g.name||(g.name=(new Date).getTime()+"."+(g.type||"image/jpeg").replace(/image\//g,"")),g.size>aq.opts.imageMaxSize){return aQ(aj),!1}if(aq.opts.imageAllowedTypes.indexOf(g.type.replace(/image\//g,""))<0){return aQ(aI),!1}if(aq.drag_support.formdata&&(j=aq.drag_support.formdata?new FormData:null),j){var b;if(!1!==aq.opts.imageUploadToS3){for(b in j.append("key",aq.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(g.name||"untitled")),j.append("success_action_status","201"),j.append("X-Requested-With","xhr"),j.append("Content-Type",g.type),aq.opts.imageUploadToS3.params){aq.opts.imageUploadToS3.params.hasOwnProperty(b)&&j.append(b,aq.opts.imageUploadToS3.params[b])}}for(b in aq.opts.imageUploadParams){aq.opts.imageUploadParams.hasOwnProperty(b)&&j.append(b,aq.opts.imageUploadParams[b])}j.append(aq.opts.imageUploadParam,g,g.name);var d=aq.opts.imageUploadURL;aq.opts.imageUploadToS3&&(d=aq.opts.imageUploadToS3.uploadURL?aq.opts.imageUploadToS3.uploadURL:"https://"+aq.opts.imageUploadToS3.region+".amazonaws.com/"+aq.opts.imageUploadToS3.bucket),function(l,i,q,p){function u(){var n=a(this);n.off("load"),n.addClass("fr-uploading"),n.next().is("br")&&n.next().remove(),aq.placeholder.refresh(),bd(n),bf(),a4(),aq.edit.off(),l.onload=function(){aZ.call(l,n)},l.onerror=aR,l.upload.onprogress=a1,l.onabort=af,n.off("abortUpload").on("abortUpload",function(){4!=l.readyState&&l.abort()}),l.send(i)}var o=new FileReader;o.addEventListener("load",function(){var v=o.result;if(o.result.indexOf("svg+xml")<0){for(var s=atob(o.result.split(",")[1]),n=[],r=0;r<s.length;r++){n.push(s.charCodeAt(r))}v=window.URL.createObjectURL(new Blob([new Uint8Array(n)],{type:"image/jpeg"}))}p?(p.on("load",u),p.one("error",function(){p.off("load"),p.attr("src",p.data("fr-old-src")),aQ(ag)}),aq.edit.on(),aq.undo.saveStep(),p.data("fr-old-src",p.attr("src")),p.attr("src",v)):a0(v,null,u)},!1),o.readAsDataURL(q)}(aq.core.getXHR(d,aq.opts.imageUploadMethod),j,g,k||aC)}}var m,c,f}function aO(b){if(b.is("img")&&0<b.parents(".fr-img-caption").length){return b.parents(".fr-img-caption")}}function a2(g){var d=g.originalEvent.dataTransfer;if(d&&d.files&&d.files.length){var b=d.files[0];if(b&&b.type&&-1!==b.type.indexOf("image")&&0<=aq.opts.imageAllowedTypes.indexOf(b.type.replace(/image\//g,""))){if(!aq.opts.imageUpload){return g.preventDefault(),g.stopPropagation(),!1}aq.markers.remove(),aq.markers.insertAtPoint(g.originalEvent),aq.$el.find(".fr-marker").replaceWith(a.FE.MARKERS),0===aq.$el.find(".fr-marker").length&&aq.selection.setAtEnd(aq.el),aq.popups.hideAll();var c=aq.popups.get("image.insert");c||(c=a6()),aq.popups.setContainer("image.insert",aq.$sc);var f=g.originalEvent.pageX,h=g.originalEvent.pageY;return aq.opts.iframe&&(h+=aq.$iframe.offset().top,f+=aq.$iframe.offset().left),aq.popups.show("image.insert",f,h),a4(),0<=aq.opts.imageAllowedTypes.indexOf(b.type.replace(/image\//g,""))?(aB(!0),aK(d.files)):aQ(aI),g.preventDefault(),g.stopPropagation(),!1}}}function a6(k){if(k){return aq.popups.onRefresh("image.insert",ai),aq.popups.onHide("image.insert",a9),!0}var p,m="";aq.opts.imageUpload||aq.opts.imageInsertButtons.splice(aq.opts.imageInsertButtons.indexOf("imageUpload"),1),1<aq.opts.imageInsertButtons.length&&(m='<div class="fr-buttons">'+aq.button.buildList(aq.opts.imageInsertButtons)+"</div>");var h=aq.opts.imageInsertButtons.indexOf("imageUpload"),b=aq.opts.imageInsertButtons.indexOf("imageByURL"),d="";0<=h&&(p=" fr-active",0<=b&&b<h&&(p=""),d='<div class="fr-image-upload-layer'+p+' fr-layer" id="fr-image-upload-layer-'+aq.id+'"><strong>'+aq.language.translate("Drop image")+"</strong><br>("+aq.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+aq.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+aq.id+'" role="button"></div></div>');var q="";0<=b&&(p=" fr-active",0<=h&&h<b&&(p=""),q='<div class="fr-image-by-url-layer'+p+' fr-layer" id="fr-image-by-url-layer-'+aq.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+aq.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+aq.language.translate("Insert")+"</button></div></div>");var c,g={buttons:m,upload_layer:d,by_url_layer:q,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>'},j=aq.popups.create("image.insert",g);return aq.$wp&&aq.events.$on(aq.$wp,"scroll",function(){aC&&aq.popups.isVisible("image.insert")&&ao()}),c=j,aq.events.$on(c,"dragover dragenter",".fr-image-upload-layer",function(){return a(this).addClass("fr-drop"),!1},!0),aq.events.$on(c,"dragleave dragend",".fr-image-upload-layer",function(){return a(this).removeClass("fr-drop"),!1},!0),aq.events.$on(c,"drop",".fr-image-upload-layer",function(l){l.preventDefault(),l.stopPropagation(),a(this).removeClass("fr-drop");var i=l.originalEvent.dataTransfer;if(i&&i.files){var f=c.data("instance")||aq;f.events.disableBlur(),f.image.upload(i.files),f.events.enableBlur()}},!0),aq.helpers.isIOS()&&aq.events.$on(c,"touchstart",'.fr-image-upload-layer input[type="file"]',function(){a(this).trigger("click")},!0),aq.events.$on(c,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var f=c.data("instance")||aq;f.events.disableBlur(),c.find("input:focus").blur(),f.events.enableBlur(),f.image.upload(this.files,aC)}a(this).val("")},!0),j}function aM(){aC&&aq.popups.get("image.alt").find("input").val(aC.attr("alt")||"").trigger("change")}function aN(){var f=aq.popups.get("image.alt");f||(f=ay()),a8(),aq.popups.refresh("image.alt"),aq.popups.setContainer("image.alt",aq.$sc);var d=ad();aS()&&(d=d.find(".fr-img-wrap"));var b=d.offset().left+d.outerWidth()/2,c=d.offset().top+d.outerHeight();aq.popups.show("image.alt",b,c,d.outerHeight())}function ay(d){if(d){return aq.popups.onRefresh("image.alt",aM),!0}var c={buttons:'<div class="fr-buttons">'+aq.button.buildList(aq.opts.imageAltButtons)+"</div>",alt_layer:'<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+aq.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+aq.id+'" type="text" placeholder="'+aq.language.translate("Alternative Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+aq.language.translate("Update")+"</button></div></div>"},b=aq.popups.create("image.alt",c);return aq.$wp&&aq.events.$on(aq.$wp,"scroll.image-alt",function(){aC&&aq.popups.isVisible("image.alt")&&aN()}),b}function a7(){if(aC){var b=aq.popups.get("image.size");b.find('input[name="width"]').val(aC.get(0).style.width).trigger("change"),b.find('input[name="height"]').val(aC.get(0).style.height).trigger("change")}}function ap(){var f=aq.popups.get("image.size");f||(f=aP()),a8(),aq.popups.refresh("image.size"),aq.popups.setContainer("image.size",aq.$sc);var d=ad();aS()&&(d=d.find(".fr-img-wrap"));var b=d.offset().left+d.outerWidth()/2,c=d.offset().top+d.outerHeight();aq.popups.show("image.size",b,c,d.outerHeight())}function aP(d){if(d){return aq.popups.onRefresh("image.size",a7),!0}var c={buttons:'<div class="fr-buttons">'+aq.button.buildList(aq.opts.imageSizeButtons)+"</div>",size_layer:'<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+aq.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+aq.id+'" type="text" name="width" placeholder="'+aq.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+aq.id+'" type="text" name="height" placeholder="'+aq.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+aq.language.translate("Update")+"</button></div></div>"},b=aq.popups.create("image.size",c);return aq.$wp&&aq.events.$on(aq.$wp,"scroll.image-size",function(){aC&&aq.popups.isVisible("image.size")&&ap()}),b}function aV(f,d,b,c){return f.pageX=d,aT.call(this,f),f.pageX=f.pageX+b*Math.floor(Math.pow(1.1,c)),ba.call(this,f),ah.call(this,f),++c}function a3(b){(b=b||ad())&&!1!==aq.events.trigger("image.beforeRemove",[b])&&(aq.popups.hideAll(),bi(),aB(!0),aq.undo.canDo()||aq.undo.saveStep(),b.get(0)==aq.el?b.removeAttr("src"):(b.get(0).parentNode&&"A"==b.get(0).parentNode.tagName?(aq.selection.setBefore(b.get(0).parentNode)||aq.selection.setAfter(b.get(0).parentNode)||b.parent().after(a.FE.MARKERS),a(b.get(0).parentNode).remove()):(aq.selection.setBefore(b.get(0))||aq.selection.setAfter(b.get(0))||b.after(a.FE.MARKERS),b.remove()),aq.html.fillEmptyBlocks(),aq.selection.restore()),aq.undo.saveStep())}function aL(f){var d=f.which;if(aC&&(d==a.FE.KEYCODE.BACKSPACE||d==a.FE.KEYCODE.DELETE)){return f.preventDefault(),f.stopPropagation(),a3(),!1}if(aC&&d==a.FE.KEYCODE.ESC){var b=aC;return aB(!0),aq.selection.setAfter(b.get(0)),aq.selection.restore(),f.preventDefault(),!1}if(aC&&(d==a.FE.KEYCODE.ARROW_LEFT||d==a.FE.KEYCODE.ARROW_RIGHT)){var c=aC.get(0);return aB(!0),d==a.FE.KEYCODE.ARROW_LEFT?aq.selection.setBefore(c):aq.selection.setAfter(c),aq.selection.restore(),f.preventDefault(),!1}return aC&&d!=a.FE.KEYCODE.F10&&!aq.keys.isBrowserAction(f)?(f.preventDefault(),f.stopPropagation(),!1):void 0}function aa(g){if(g&&"IMG"==g.tagName){if(aq.node.hasClass(g,"fr-uploading")||aq.node.hasClass(g,"fr-error")?g.parentNode.removeChild(g):aq.node.hasClass(g,"fr-draggable")&&g.classList.remove("fr-draggable"),g.parentNode&&g.parentNode.parentNode&&aq.node.hasClass(g.parentNode.parentNode,"fr-img-caption")){var d=g.parentNode.parentNode;d.removeAttribute("contenteditable"),d.removeAttribute("draggable"),d.classList.remove("fr-draggable");var b=g.nextSibling;b&&b.removeAttribute("contenteditable")}}else{if(g&&g.nodeType==Node.ELEMENT_NODE){for(var c=g.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"),f=0;f<c.length;f++){aa(c[f])}}}}function bb(f){if(!1===aq.events.trigger("image.beforePasteUpload",[f])){return !1}aC=a(f),bf(),at(),ao(),a4(),aC.one("load",function(){bf(),a4()});for(var d=atob(a(f).attr("src").split(",")[1]),b=[],c=0;c<d.length;c++){b.push(d.charCodeAt(c))}aK([new Blob([new Uint8Array(b)],{type:a(f).attr("src").split(",")[0].replace(/data\:/g,"").replace(/;base64/g,"")})],aC)}function bg(){aq.opts.imagePaste?aq.$el.find("img[data-fr-image-pasted]").each(function(f,b){if(aq.opts.imagePasteProcess){var d=aq.opts.imageDefaultWidth;d&&"auto"!=d&&(d+=aq.opts.imageResizeWithPercent?"%":"px"),a(b).css("width",d).removeClass("fr-dii fr-dib fr-fir fr-fil"),bh(a(b),aq.opts.imageDefaultDisplay,aq.opts.imageDefaultAlign)}if(0===b.src.indexOf("data:")){bb(b)}else{if(0===b.src.indexOf("blob:")||0===b.src.indexOf("http")&&aq.opts.imageUploadRemoteUrls&&aq.opts.imageCORSProxy){var c=new Image;c.crossOrigin="Anonymous",c.onload=function(){var h=aq.o_doc.createElement("CANVAS"),g=h.getContext("2d");h.height=this.naturalHeight,h.width=this.naturalWidth,g.drawImage(this,0,0),b.src=h.toDataURL("image/png"),bb(b)},c.src=(0===b.src.indexOf("blob:")?"":aq.opts.imageCORSProxy+"/")+b.src}else{0!==b.src.indexOf("http")||0===b.src.indexOf("https://mail.google.com/mail")?(aq.selection.save(),a(b).remove(),aq.selection.restore()):a(b).removeAttr("data-fr-image-pasted")}}}):aq.$el.find("img[data-fr-image-pasted]").remove()}function av(f){var d=f.target.result,b=aq.opts.imageDefaultWidth;b&&"auto"!=b&&(b+=aq.opts.imageResizeWithPercent?"%":"px"),aq.undo.saveStep(),aq.html.insert('<img data-fr-image-pasted="true" src="'+d+'"'+(b?' style="width: '+b+';"':"")+">");var c=aq.$el.find('img[data-fr-image-pasted="true"]');c&&bh(c,aq.opts.imageDefaultDisplay,aq.opts.imageDefaultAlign),aq.events.trigger("paste.after")}function bn(g){if(g&&g.clipboardData&&g.clipboardData.items){var d=null;if(g.clipboardData.getData("text/rtf")){d=g.clipboardData.items[0].getAsFile()}else{for(var b=0;b<g.clipboardData.items.length&&!(d=g.clipboardData.items[b].getAsFile());b++){}}if(d){return c=d,(f=new FileReader).onload=av,f.readAsDataURL(c),!1}}var c,f}function a5(b){return b=b.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function bj(c){if("false"==a(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")){return !0}if(c&&"touchend"==c.type&&aJ){return !0}if(c&&aq.edit.isDisabled()){return c.stopPropagation(),c.preventDefault(),!1}for(var b=0;b<a.FE.INSTANCES.length;b++){a.FE.INSTANCES[b]!=aq&&a.FE.INSTANCES[b].events.trigger("image.hideResizer")}aq.toolbar.disable(),c&&(c.stopPropagation(),c.preventDefault()),aq.helpers.isMobile()&&(aq.events.disableBlur(),aq.$el.blur(),aq.events.enableBlur()),aq.opts.iframe&&aq.size.syncIframe(),aC=a(this),bi(),bf(),at(),aq.browser.msie||aq.selection.clear(),aq.helpers.isIOS()&&(aq.events.disableBlur(),aq.$el.blur()),aq.button.bulkRefresh(),aq.events.trigger("video.hideResizer")}function aB(b){aC&&(bm||!0===b)&&(aq.toolbar.enable(),aw.removeClass("fr-active"),aq.popups.hide("image.edit"),aC=null,ac(),aD=null,aF&&aF.hide())}an[az]="Image cannot be loaded from the passed link.",an[aG]="No link in upload response.",an[au]="Error during file upload.",an[aA]="Parsing response failed.",an[aj]="File is too large.",an[aI]="Image file type is invalid.",an[7]="Files can be uploaded only to same domain in IE 8 and IE 9.";var bm=!(an[ag]="Image file is corrupted.");function bl(){bm=!0}function ac(){bm=!1}function bh(d,c,b){!aq.opts.htmlUntouched&&aq.opts.useClasses?(d.removeClass("fr-fil fr-fir fr-dib fr-dii"),b&&d.addClass("fr-fi"+b[0]),c&&d.addClass("fr-di"+c[0])):"inline"==c?(d.css({display:"inline-block",verticalAlign:"bottom",margin:aq.opts.imageDefaultMargin}),"center"==b?d.css({"float":"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - "+2*aq.opts.imageDefaultMargin+"px)",textAlign:"center"}):"left"==b?d.css({"float":"left",marginLeft:0,maxWidth:"calc(100% - "+aq.opts.imageDefaultMargin+"px)",textAlign:"left"}):d.css({"float":"right",marginRight:0,maxWidth:"calc(100% - "+aq.opts.imageDefaultMargin+"px)",textAlign:"right"})):"block"==c&&(d.css({display:"block","float":"none",verticalAlign:"top",margin:aq.opts.imageDefaultMargin+"px auto",textAlign:"center"}),"left"==b?d.css({marginLeft:0,textAlign:"left"}):"right"==b&&d.css({marginRight:0,textAlign:"right"}))}function ab(c){if(void 0===c&&(c=ad()),c){if(c.hasClass("fr-fil")){return"left"}if(c.hasClass("fr-fir")){return"right"}if(c.hasClass("fr-dib")||c.hasClass("fr-dii")){return"center"}var b=c.css("float");if(c.css("float","none"),"block"==c.css("display")){if(c.css("float",""),c.css("float")!=b&&c.css("float",b),0===parseInt(c.css("margin-left"),10)){return"left"}if(0===parseInt(c.css("margin-right"),10)){return"right"}}else{if(c.css("float",""),c.css("float")!=b&&c.css("float",b),"left"==c.css("float")){return"left"}if("right"==c.css("float")){return"right"}}}return"center"}function aH(c){void 0===c&&(c=ad());var b=c.css("float");return c.css("float","none"),"block"==c.css("display")?(c.css("float",""),c.css("float")!=b&&c.css("float",b),"block"):(c.css("float",""),c.css("float")!=b&&c.css("float",b),"inline")}function ao(){var f=aq.popups.get("image.insert");f||(f=a6()),aq.popups.isVisible("image.insert")||(a8(),aq.popups.refresh("image.insert"),aq.popups.setContainer("image.insert",aq.$sc));var d=ad();aS()&&(d=d.find(".fr-img-wrap"));var b=d.offset().left+d.outerWidth()/2,c=d.offset().top+d.outerHeight();aq.popups.show("image.insert",b,c,d.outerHeight(!0))}function bi(){if(aC){aq.events.disableBlur(),aq.selection.clear();var b=aq.doc.createRange();b.selectNode(aC.get(0)),aq.browser.msie&&b.collapse(!0),aq.selection.get().addRange(b),aq.events.enableBlur()}}function aY(){return aC}function ad(){return aS()?aC.parents(".fr-img-caption:first"):aC}function aS(){return !!aC&&0<aC.parents(".fr-img-caption").length}return{_init:function(){var b;aq.events.$on(aq.$el,aq._mousedown,"IMG"==aq.el.tagName?null:'img:not([contenteditable="false"])',function(c){if("false"==a(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")){return !0}aq.helpers.isMobile()||aq.selection.clear(),al=!0,aq.popups.areVisible()&&aq.events.disableBlur(),aq.browser.msie&&(aq.events.disableBlur(),aq.$el.attr("contenteditable",!1)),aq.draggable||"touchstart"==c.type||c.preventDefault(),c.stopPropagation()}),aq.events.$on(aq.$el,aq._mouseup,"IMG"==aq.el.tagName?null:'img:not([contenteditable="false"])',function(c){if("false"==a(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")){return !0}al&&(al=!1,c.stopPropagation(),aq.browser.msie&&(aq.$el.attr("contenteditable",!0),aq.events.enableBlur()))}),aq.events.on("keyup",function(f){if(f.shiftKey&&""===aq.selection.text().replace(/\n/g,"")&&aq.keys.isArrow(f.which)){var d=aq.selection.element(),c=aq.selection.endElement();d&&"IMG"==d.tagName?bd(a(d)):c&&"IMG"==c.tagName&&bd(a(c))}},!0),aq.events.on("drop",a2),aq.events.on("element.beforeDrop",aO),aq.events.on("mousedown window.mousedown",bl),aq.events.on("window.touchmove",ac),aq.events.on("mouseup window.mouseup",function(){if(aC){return aB(),!1}ac()}),aq.events.on("commands.mousedown",function(c){0<c.parents(".fr-toolbar").length&&aB()}),aq.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){aB(!(al=!1))}),aq.events.on("modals.hide",function(){aC&&(bi(),aq.selection.clear())}),"IMG"==aq.el.tagName&&aq.$el.addClass("fr-view"),aq.events.$on(aq.$el,aq.helpers.isMobile()&&!aq.helpers.isWindowsPhone()?"touchend":"click","IMG"==aq.el.tagName?null:'img:not([contenteditable="false"])',bj),aq.helpers.isMobile()&&(aq.events.$on(aq.$el,"touchstart","IMG"==aq.el.tagName?null:'img:not([contenteditable="false"])',function(){aJ=!1}),aq.events.$on(aq.$el,"touchmove",function(){aJ=!0})),aq.$wp?(aq.events.on("window.keydown keydown",aL,!0),aq.events.on("keyup",function(c){if(aC&&c.which==a.FE.KEYCODE.ENTER){return !1}},!0)):aq.events.$on(aq.$win,"keydown",aL),aq.events.on("toolbar.esc",function(){if(aC){if(aq.$wp){aq.events.disableBlur(),aq.events.focus()}else{var c=aC;aB(!0),aq.selection.setAfter(c.get(0)),aq.selection.restore()}return !1}},!0),aq.events.on("toolbar.focusEditor",function(){if(aC){return !1}},!0),aq.events.on("window.cut window.copy",function(d){if(aC&&aq.popups.isVisible("image.edit")&&!aq.popups.get("image.edit").find(":focus").length){var c=ad();aS()?(c.before(a.FE.START_MARKER),c.after(a.FE.END_MARKER),aq.selection.restore(),aq.paste.saveCopiedText(c.get(0).outerHTML,c.text())):(bi(),aq.paste.saveCopiedText(aC.get(0).outerHTML,aC.attr("alt"))),"copy"==d.type?setTimeout(function(){bd(aC)}):(aB(!0),aq.undo.saveStep(),setTimeout(function(){aq.undo.saveStep()},0))}},!0),aq.browser.msie&&aq.events.on("keydown",function(d){if(!aq.selection.isCollapsed()||!aC){return !0}var c=d.which;c==a.FE.KEYCODE.C&&aq.keys.ctrlKey(d)?aq.events.trigger("window.copy"):c==a.FE.KEYCODE.X&&aq.keys.ctrlKey(d)&&aq.events.trigger("window.cut")}),aq.events.$on(a(aq.o_win),"keydown",function(d){var c=d.which;if(aC&&c==a.FE.KEYCODE.BACKSPACE){return d.preventDefault(),!1}}),aq.events.$on(aq.$win,"keydown",function(d){var c=d.which;aC&&aC.hasClass("fr-uploading")&&c==a.FE.KEYCODE.ESC&&aC.trigger("abortUpload")}),aq.events.on("destroy",function(){aC&&aC.hasClass("fr-uploading")&&aC.trigger("abortUpload")}),aq.events.on("paste.before",bn),aq.events.on("paste.beforeCleanup",a5),aq.events.on("paste.after",bg),aq.events.on("html.set",aE),aq.events.on("html.inserted",aE),aE(),aq.events.on("destroy",function(){ar=[]}),aq.events.on("html.processGet",aa),aq.opts.imageOutputSize&&aq.events.on("html.beforeGet",function(){b=aq.el.querySelectorAll("img");for(var f=0;f<b.length;f++){var d=b[f].style.width||a(b[f]).width(),c=b[f].style.height||a(b[f]).height();d&&b[f].setAttribute("width",(""+d).replace(/px/,"")),c&&b[f].setAttribute("height",(""+c).replace(/px/,""))}}),aq.opts.iframe&&aq.events.on("image.loaded",aq.size.syncIframe),aq.$wp&&(bc(),aq.events.on("contentChanged",bc)),aq.events.$on(a(aq.o_win),"orientationchange.image",function(){setTimeout(function(){aC&&bd(aC)},100)}),bk(!0),a6(!0),aP(!0),ay(!0),aq.events.on("node.remove",function(c){if("IMG"==c.get(0).tagName){return a3(c),!1}})},showInsertPopup:function(){var f=aq.$tb.find('.fr-command[data-cmd="insertImage"]'),d=aq.popups.get("image.insert");if(d||(d=a6()),a8(),!d.hasClass("fr-active")){if(aq.popups.refresh("image.insert"),aq.popups.setContainer("image.insert",aq.$tb),f.is(":visible")){var b=f.offset().left+f.outerWidth()/2,c=f.offset().top+(aq.opts.toolbarBottom?10:f.outerHeight()-10);aq.popups.show("image.insert",b,c,f.outerHeight())}else{aq.position.forSelection(d),aq.popups.show("image.insert")}}},showLayer:function(g){var d,b,c=aq.popups.get("image.insert");if(aC||aq.opts.toolbarInline){if(aC){var f=ad();aS()&&(f=f.find(".fr-img-wrap")),b=f.offset().top+f.outerHeight(),d=f.offset().left+f.outerWidth()/2}}else{var h=aq.$tb.find('.fr-command[data-cmd="insertImage"]');d=h.offset().left+h.outerWidth()/2,b=h.offset().top+(aq.opts.toolbarBottom?10:h.outerHeight()-10)}!aC&&aq.opts.toolbarInline&&(b=c.offset().top-aq.helpers.getPX(c.css("margin-top")),c.hasClass("fr-above")&&(b+=c.outerHeight())),c.find(".fr-layer").removeClass("fr-active"),c.find(".fr-"+g+"-layer").addClass("fr-active"),aq.popups.show("image.insert",d,b,aC?aC.outerHeight():0),aq.accessibility.focusPopup(c)},refreshUploadButton:function(b){aq.popups.get("image.insert").find(".fr-image-upload-layer").hasClass("fr-active")&&b.addClass("fr-active").attr("aria-pressed",!0)},refreshByURLButton:function(b){aq.popups.get("image.insert").find(".fr-image-by-url-layer").hasClass("fr-active")&&b.addClass("fr-active").attr("aria-pressed",!0)},upload:aK,insertByURL:function(){var d=aq.popups.get("image.insert").find(".fr-image-by-url-layer input");if(0<d.val().length){a4(),ax(aq.language.translate("Loading image"));var c=d.val();if(aq.opts.imageUploadRemoteUrls&&aq.opts.imageCORSProxy&&aq.opts.imageUpload){var b=new XMLHttpRequest;b.onload=function(){200==this.status?aK([new Blob([this.response],{type:this.response.type||"image/png"})],aC):aQ(az)},b.onerror=function(){aW(c,!0,[],aC)},b.open("GET",aq.opts.imageCORSProxy+"/"+c,!0),b.responseType="blob",b.send()}else{aW(c,!0,[],aC)}d.val(""),d.blur()}},align:function(c){var b=ad();b.removeClass("fr-fir fr-fil"),!aq.opts.htmlUntouched&&aq.opts.useClasses?"left"==c?b.addClass("fr-fil"):"right"==c&&b.addClass("fr-fir"):bh(b,aH(),c),bi(),bf(),at(),aq.selection.clear()},refreshAlign:function(b){aC&&b.find("> *:first").replaceWith(aq.icon.create("image-align-"+ab()))},refreshAlignOnShow:function(c,b){aC&&b.find('.fr-command[data-param1="'+ab()+'"]').addClass("fr-active").attr("aria-selected",!0)},display:function(c){var b=ad();b.removeClass("fr-dii fr-dib"),!aq.opts.htmlUntouched&&aq.opts.useClasses?"inline"==c?b.addClass("fr-dii"):"block"==c&&b.addClass("fr-dib"):bh(b,c,ab()),bi(),bf(),at(),aq.selection.clear()},refreshDisplayOnShow:function(c,b){aC&&b.find('.fr-command[data-param1="'+aH()+'"]').addClass("fr-active").attr("aria-selected",!0)},replace:ao,back:function(){aC?(aq.events.disableBlur(),a(".fr-popup input:focus").blur(),bd(aC)):(aq.events.disableBlur(),aq.selection.restore(),aq.events.enableBlur(),aq.popups.hide("image.insert"),aq.toolbar.showInline())},get:aY,getEl:ad,insert:aW,showProgressBar:a4,remove:a3,hideProgressBar:a8,applyStyle:function(g,d,b){if(void 0===d&&(d=aq.opts.imageStyles),void 0===b&&(b=aq.opts.imageMultipleStyles),!aC){return !1}var c=ad();if(!b){var f=Object.keys(d);f.splice(f.indexOf(g),1),c.removeClass(f.join(" "))}"object"==typeof d[g]?(c.removeAttr("style"),c.css(d[g].style)):c.toggleClass(g),bd(aC)},showAltPopup:aN,showSizePopup:ap,setAlt:function(c){if(aC){var b=aq.popups.get("image.alt");aC.attr("alt",c||b.find("input").val()||""),b.find("input:focus").blur(),bd(aC)}},setSize:function(f,d){if(aC){var b=aq.popups.get("image.size");f=f||b.find('input[name="width"]').val()||"",d=d||b.find('input[name="height"]').val()||"";var c=/^[\d]+((px)|%)*$/g;aC.removeAttr("width").removeAttr("height"),f.match(c)?aC.css("width",f):aC.css("width",""),d.match(c)?aC.css("height",d):aC.css("height",""),aS()&&(aC.parent().removeAttr("width").removeAttr("height"),f.match(c)?aC.parent().css("width",f):aC.parent().css("width",""),d.match(c)?aC.parent().css("height",d):aC.parent().css("height","")),b.find("input:focus").blur(),bd(aC)}},toggleCaption:function(){var b;aC&&!aS()?((b=aC).parent().is("a")&&(b=aC.parent()),b.wrap("<span "+(aq.browser.mozilla?"":'contenteditable="false"')+'class="fr-img-caption '+aC.attr("class")+'" style="'+(aC.attr("style")?aC.attr("style")+" ":"")+"width: "+aC.width()+'px;" draggable="false"></span>'),b.wrap('<span class="fr-img-wrap"></span>'),b.after('<span class="fr-inner" contenteditable="true">'+a.FE.START_MARKER+"Image caption"+a.FE.END_MARKER+"</span>"),aC.removeAttr("class").removeAttr("style").removeAttr("width"),aB(!0),aq.selection.restore()):(b=ad(),aC.insertAfter(b),aC.attr("class",b.attr("class").replace("fr-img-caption","")).attr("style",b.attr("style")),b.remove(),bd(aC))},hasCaption:aS,exitEdit:aB,edit:bd}},a.FE.DefineIcon("insertImage",{NAME:"image"}),a.FE.RegisterShortcut(a.FE.KEYCODE.P,"insertImage",null,"P"),a.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),a.FE.DefineIcon("imageUpload",{NAME:"upload"}),a.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(b){this.image.refreshUploadButton(b)}}),a.FE.DefineIcon("imageByURL",{NAME:"link"}),a.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(b){this.image.refreshByURLButton(b)}}),a.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(b){this.image.get()?b.text(this.language.translate("Replace")):b.text(this.language.translate("Insert"))}}),a.FE.DefineIcon("imageDisplay",{NAME:"star"}),a.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(c,b){this.image.display(b)},refresh:function(b){this.opts.imageTextNear||b.addClass("fr-hidden")},refreshOnShow:function(c,b){this.image.refreshDisplayOnShow(c,b)}}),a.FE.DefineIcon("image-align",{NAME:"align-left"}),a.FE.DefineIcon("image-align-left",{NAME:"align-left"}),a.FE.DefineIcon("image-align-right",{NAME:"align-right"}),a.FE.DefineIcon("image-align-center",{NAME:"align-justify"}),a.FE.DefineIcon("imageAlign",{NAME:"align-justify"}),a.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var d='<ul class="fr-dropdown-list" role="presentation">',c=a.FE.COMMANDS.imageAlign.options;for(var b in c){c.hasOwnProperty(b)&&(d+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+b+'" title="'+this.language.translate(c[b])+'">'+this.icon.create("image-align-"+b)+'<span class="fr-sr-only">'+this.language.translate(c[b])+"</span></a></li>")}return d+="</ul>"},callback:function(c,b){this.image.align(b)},refresh:function(b){this.image.refreshAlign(b)},refreshOnShow:function(c,b){this.image.refreshAlignOnShow(c,b)}}),a.FE.DefineIcon("imageReplace",{NAME:"exchange",FA5NAME:"exchange-alt"}),a.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),a.FE.DefineIcon("imageRemove",{NAME:"trash"}),a.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),a.FE.DefineIcon("imageBack",{NAME:"arrow-left"}),a.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(b){this.image.get()||this.opts.toolbarInline?(b.removeClass("fr-hidden"),b.next(".fr-separator").removeClass("fr-hidden")):(b.addClass("fr-hidden"),b.next(".fr-separator").addClass("fr-hidden"))}}),a.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),a.FE.DefineIcon("imageStyle",{NAME:"magic"}),a.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var f='<ul class="fr-dropdown-list" role="presentation">',d=this.opts.imageStyles;for(var b in d){if(d.hasOwnProperty(b)){var c=d[b];"object"==typeof c&&(c=c.title),f+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+b+'">'+this.language.translate(c)+"</a></li>"}}return f+="</ul>"},callback:function(c,b){this.image.applyStyle(b)},refreshOnShow:function(d,c){var b=this.image.getEl();b&&c.find(".fr-command").each(function(){var g=a(this).data("param1"),f=b.hasClass(g);a(this).toggleClass("fr-active",f).attr("aria-selected",f)})}}),a.FE.DefineIcon("imageAlt",{NAME:"info"}),a.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternative Text",callback:function(){this.image.showAltPopup()}}),a.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),a.FE.DefineIcon("imageSize",{NAME:"arrows-alt"}),a.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}}),a.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}}),a.FE.DefineIcon("imageCaption",{NAME:"commenting",FA5NAME:"comment-alt"}),a.FE.RegisterCommand("imageCaption",{undo:!0,focus:!1,title:"Image Caption",refreshAfterCallback:!0,callback:function(){this.image.toggleCaption()},refresh:function(b){this.image.get()&&b.toggleClass("fr-active",this.image.hasCaption())}})});